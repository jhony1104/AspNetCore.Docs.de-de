---
title: Erstellen progressiver Webanwendungen mit der Blazor WebAssembly für ASP.NET Core
author: guardrex
description: Erfahren Sie, wie Sie eine Blazor-basierte progressive Web-App (PWA) erstellen, die moderne Browserfeatures verwendet, um das Verhalten von Desktop-Apps anzunehmen.
monikerRange: '>= aspnetcore-3.1'
ms.author: riande
ms.custom: mvc
ms.date: 03/23/2020
no-loc:
- Blazor
- SignalR
uid: blazor/progressive-web-app
ms.openlocfilehash: fe69e51aefae9c80e5bb4b78151d384ce25d41a7
ms.sourcegitcommit: 91dc1dd3d055b4c7d7298420927b3fd161067c64
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 03/24/2020
ms.locfileid: "80218946"
---
# <a name="build-progressive-web-applications-with-aspnet-core-blazor-webassembly"></a><span data-ttu-id="80601-103">Erstellen progressiver Webanwendungen mit Blazor WebAssembly für ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="80601-103">Build Progressive Web Applications with ASP.NET Core Blazor WebAssembly</span></span>

<span data-ttu-id="80601-104">Von [Steve Sanderson](https://github.com/SteveSandersonMS)</span><span class="sxs-lookup"><span data-stu-id="80601-104">By [Steve Sanderson](https://github.com/SteveSandersonMS)</span></span>

[!INCLUDE[](~/includes/blazorwasm-preview-notice.md)]

[!INCLUDE[](~/includes/blazorwasm-3.2-template-article-notice.md)]

<span data-ttu-id="80601-105">Eine progressive Web-App(PWA) ist eine Single-Page-Webanwendung (SPA), die mithilfe moderner Browser-APIs und -Funktionen das gleiche Verhalten wie eine Desktop-App aufweist.</span><span class="sxs-lookup"><span data-stu-id="80601-105">A Progressive Web Application (PWA) is a Single Page Application (SPA) that uses modern browser APIs and capabilities to behave like a desktop app.</span></span> <span data-ttu-id="80601-106">Blazor WebAssembly ist eine auf Standards basierende clientseitige Web-App-Plattform, die beliebige Browser-APIs verwenden kann, einschließlich der PWA-APIs, die für die folgenden Funktionen erforderlich sind:</span><span class="sxs-lookup"><span data-stu-id="80601-106">Blazor WebAssembly is a standards-based client-side web app platform, so it can use any browser API, including PWA APIs required for the following capabilities:</span></span>

* <span data-ttu-id="80601-107">Die Fähigkeit, unabhängig von der Netzwerkgeschwindigkeit, mit sofortigem Laden offline zu arbeiten</span><span class="sxs-lookup"><span data-stu-id="80601-107">Working offline and loading instantly, independent of network speed.</span></span>
* <span data-ttu-id="80601-108">Ausführung in einem eigenen App-Fenster, nicht nur in einem Browserfenster</span><span class="sxs-lookup"><span data-stu-id="80601-108">Running in its own app window, not just a browser window.</span></span>
* <span data-ttu-id="80601-109">Starten über das Startmenü, das Dock oder den Startbildschirm des Hostbetriebssystems</span><span class="sxs-lookup"><span data-stu-id="80601-109">Being launched from the host's operating system start menu, dock, or home screen.</span></span>
* <span data-ttu-id="80601-110">Empfangen von Pushbenachrichtigungen von einem Back-End-Server, auch wenn der Benutzer die App nicht verwendet</span><span class="sxs-lookup"><span data-stu-id="80601-110">Receiving push notifications from a backend server, even while the user isn't using the app.</span></span>
* <span data-ttu-id="80601-111">Automatische Updates im Hintergrund</span><span class="sxs-lookup"><span data-stu-id="80601-111">Automatically updating in the background.</span></span>

<span data-ttu-id="80601-112">Solche Apps werden aus folgenden Gründen mit dem Wort *progressiv* beschrieben:</span><span class="sxs-lookup"><span data-stu-id="80601-112">The word *progressive* is used to describe such apps because:</span></span>

* <span data-ttu-id="80601-113">Möglicherweise entdeckt ein Benutzer die App wie jede andere SPA zunächst im Webbrowser.</span><span class="sxs-lookup"><span data-stu-id="80601-113">A user might first discover and use the app within their web browser like any other SPA.</span></span>
* <span data-ttu-id="80601-114">Später installiert der Benutzer sie auf seinem Betriebssystem und aktiviert die Pushbenachrichtigungen.</span><span class="sxs-lookup"><span data-stu-id="80601-114">Later, the user progresses to installing it in their OS and enabling push notifications.</span></span>

## <a name="create-a-project-from-the-pwa-template"></a><span data-ttu-id="80601-115">Erstellen eines neuen Projekts aus der PWA-Vorlage</span><span class="sxs-lookup"><span data-stu-id="80601-115">Create a project from the PWA template</span></span>

# <a name="visual-studio"></a>[<span data-ttu-id="80601-116">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="80601-116">Visual Studio</span></span>](#tab/visual-studio)

<span data-ttu-id="80601-117">Aktivieren Sie das Kontrollkästchen **Progressive Web Application** (Progressive Web-App) beim Erstellen einer neuen **Blazor WebAssembly-App** im Dialogfeld **Neues Projekt erstellen**:</span><span class="sxs-lookup"><span data-stu-id="80601-117">When creating a new **Blazor WebAssembly App** in the **Create a New Project** dialog, select the **Progress Web Application** check box:</span></span>

![Ausgewähltes Kontrollkästchen „Progressive Web Application“ im Dialogfeld „Neues Projekt erstellen“ von Visual Studio](progressive-web-app/_static/image1.png)

<!--

# [Visual Studio for Mac](#tab/visual-studio-mac)

-->

# <a name="visual-studio-code--net-core-cli"></a>[<span data-ttu-id="80601-119">Visual Studio Code / .NET Core-CLI</span><span class="sxs-lookup"><span data-stu-id="80601-119">Visual Studio Code / .NET Core CLI</span></span>](#tab/visual-studio-code+netcore-cli)

<span data-ttu-id="80601-120">Erstellen Sie mit der `--pwa`-Option ein PWA-Projekt über eine Befehlsshell:</span><span class="sxs-lookup"><span data-stu-id="80601-120">Create a PWA project in a command shell with the `--pwa` switch:</span></span>

```dotnetcli
dotnet new blazorwasm -o MyNewProject --pwa
```

---

<span data-ttu-id="80601-121">Die PWA kann optional für eine App konfiguriert werden, die über die gehostete ASP.NET Core-Vorlage erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="80601-121">Optionally, PWA can be configured for an app created from the ASP.NET Core Hosted template.</span></span> <span data-ttu-id="80601-122">Das PWA-Szenario ist unabhängig vom Hostmodell.</span><span class="sxs-lookup"><span data-stu-id="80601-122">The PWA scenario is independent of the hosting model.</span></span>

## <a name="installation-and-app-manifest"></a><span data-ttu-id="80601-123">Installation und App-Manifest</span><span class="sxs-lookup"><span data-stu-id="80601-123">Installation and app manifest</span></span>

<span data-ttu-id="80601-124">Wenn Benutzer eine App aufrufen, die mithilfe der PWA-Vorlage erstellt wurde, können sie die App im Startmenü, Dock oder Startbildschirm des Betriebssystems installieren.</span><span class="sxs-lookup"><span data-stu-id="80601-124">When visiting an app created using the PWA template, users have the option of installing the app into their OS's start menu, dock, or home screen.</span></span> <span data-ttu-id="80601-125">Die Darstellung dieser Option hängt vom Browser des Benutzers ab.</span><span class="sxs-lookup"><span data-stu-id="80601-125">The way this option is presented depends on the user's browser.</span></span> <span data-ttu-id="80601-126">Bei Verwendung eines Chromium-basierten Desktopbrowsers wie Edge oder Chrome wird die Schaltfläche **Hinzufügen** in der URL-Leiste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="80601-126">When using desktop Chromium-based browsers, such as Edge or Chrome, an **Add** button appears within the URL bar.</span></span> <span data-ttu-id="80601-127">Wenn der Benutzer auf **Hinzufügen** klickt, wird ein Dialogfeld zum Bestätigen angezeigt:</span><span class="sxs-lookup"><span data-stu-id="80601-127">After the user selects the **Add** button, they receive a confirmation dialog:</span></span>

![Dialogfeld zum Bestätigen in Google Chrome zeigt eine Schaltfläche zum Installieren für den Benutzer der MyBlazorPwa-App an](progressive-web-app/_static/image2.png)

<span data-ttu-id="80601-129">Unter iOS können Besucher die PWA mithilfe der Schaltfläche **Teilen** von Safari und der zugehörigen Option **Zum Home-Bildschirm** installieren.</span><span class="sxs-lookup"><span data-stu-id="80601-129">On iOS, visitors can install the PWA using Safari's **Share** button and its **Add to Homescreen** option.</span></span> <span data-ttu-id="80601-130">In Chrome für Android sollten Benutzer auf die Schaltfläche **Menü** in der oberen rechten Ecke tippen und dann **Zum Startbildschirm hinzufügen** auswählen.</span><span class="sxs-lookup"><span data-stu-id="80601-130">On Chrome for Android, users should select the **Menu** button in the upper-right corner, followed by **Add to Home screen**.</span></span>

<span data-ttu-id="80601-131">Nach der Installation wird die App in einem eigenen Fenster ohne Adressleiste angezeigt:</span><span class="sxs-lookup"><span data-stu-id="80601-131">Once installed, the app appears in its own window without an address bar:</span></span>

![Ausführung der MyBlazorPwa-App in Google Chrome ohne eine Adressleiste](progressive-web-app/_static/image3.png)

<span data-ttu-id="80601-133">Informationen zum Anpassen des Titels, des Farbschemas, des Symbols oder anderer Details des Fensters finden Sie in der Datei *manifest.json* im Verzeichnis *wwwroot* des Projekts.</span><span class="sxs-lookup"><span data-stu-id="80601-133">To customize the window's title, color scheme, icon, or other details, see the *manifest.json* file in the project's *wwwroot* directory.</span></span> <span data-ttu-id="80601-134">Das Schema dieser Datei wird durch Webstandards definiert.</span><span class="sxs-lookup"><span data-stu-id="80601-134">The schema of this file is defined by web standards.</span></span> <span data-ttu-id="80601-135">Weitere Informationen finden Sie unter [MDN Web Docs: Web-App-Manifest](https://developer.mozilla.org/docs/Web/Manifest).</span><span class="sxs-lookup"><span data-stu-id="80601-135">For more information, see [MDN web docs: Web App Manifest](https://developer.mozilla.org/docs/Web/Manifest).</span></span>

## <a name="offline-support"></a><span data-ttu-id="80601-136">Offlineunterstützung</span><span class="sxs-lookup"><span data-stu-id="80601-136">Offline support</span></span>

<span data-ttu-id="80601-137">Die Offlineausführung von Apps, die mit der PWA-Vorlagenoption erstellt wurden, wird standardmäßig unterstützt.</span><span class="sxs-lookup"><span data-stu-id="80601-137">By default, apps created using the PWA template option have support for running offline.</span></span> <span data-ttu-id="80601-138">Ein Benutzer muss die App zuerst online aufrufen.</span><span class="sxs-lookup"><span data-stu-id="80601-138">A user must first visit the app while they're online.</span></span> <span data-ttu-id="80601-139">Der Browser lädt die erforderlichen Ressourcen für die Offlineausführung automatisch herunter und zwischenspeichert diese.</span><span class="sxs-lookup"><span data-stu-id="80601-139">The browser automatically downloads and caches all of the resources required to operate offline.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="80601-140">Die Entwicklungsunterstützung würde den üblichen Entwicklungszyklus beeinträchtigen, der das Vornehmen von Änderungen und Testen dieser umfasst.</span><span class="sxs-lookup"><span data-stu-id="80601-140">Development support would interfere with the usual development cycle of making changes and testing them.</span></span> <span data-ttu-id="80601-141">Daher ist die Offlineunterstützung nur für *veröffentlichte* Apps aktiviert.</span><span class="sxs-lookup"><span data-stu-id="80601-141">Therefore, offline support is only enabled for *published* apps.</span></span> 

> [!WARNING]
> <span data-ttu-id="80601-142">Wenn Sie eine offlinefähige PWA verteilen möchten, müssen Sie [einige wichtige Warnungen und Einschränkungen berücksichtigen](#caveats-for-offline-pwas).</span><span class="sxs-lookup"><span data-stu-id="80601-142">If you intend to distribute an offline-enabled PWA, there are [several important warnings and caveats](#caveats-for-offline-pwas).</span></span> <span data-ttu-id="80601-143">Diese Szenarios gelten allgemein für Offline-PWAs und sind nicht auf Blazor beschränkt.</span><span class="sxs-lookup"><span data-stu-id="80601-143">These scenarios are inherent to offline PWAs and not specific to Blazor.</span></span> <span data-ttu-id="80601-144">Sie müssen diese Einschränkungen lesen und verstehen, bevor Sie Vermutungen über die Funktionsweise der offlinefähigen App anstellen.</span><span class="sxs-lookup"><span data-stu-id="80601-144">Be sure to read and understand these caveats before making assumptions about how your offline-enabled app will work.</span></span>

<span data-ttu-id="80601-145">So erfahren Sie, wie die Offlineunterstützung funktioniert:</span><span class="sxs-lookup"><span data-stu-id="80601-145">To see how offline support works:</span></span>

1. <span data-ttu-id="80601-146">Veröffentlichen Sie die App.</span><span class="sxs-lookup"><span data-stu-id="80601-146">Publish the app.</span></span> <span data-ttu-id="80601-147">Weitere Informationen finden Sie unter <xref:host-and-deploy/blazor/index#publish-the-app>.</span><span class="sxs-lookup"><span data-stu-id="80601-147">For more information, see <xref:host-and-deploy/blazor/index#publish-the-app>.</span></span>
1. <span data-ttu-id="80601-148">Stellen Sie die App auf einem Server bereit, der HTTPS unterstützt, und greifen Sie auf die App über ihre sichere HTTPS-Adresse in einem Browser zu.</span><span class="sxs-lookup"><span data-stu-id="80601-148">Deploy the app to a server that supports HTTPS, and access the app in a browser at its secure HTTPS address.</span></span>
1. <span data-ttu-id="80601-149">Öffnen Sie die Entwicklertools des Browsers, und überprüfen Sie, ob ein *Service Worker* für den Host auf der Registerkarte **Anwendung** registriert ist:</span><span class="sxs-lookup"><span data-stu-id="80601-149">Open the browser's dev tools and verify that a *Service Worker* is registered for the host on the **Application** tab:</span></span>

   ![Auf der Registerkarte „Anwendung“ der Entwicklertools in Google Chrome wird ein aktivierter und ausgeführter Service Worker angezeigt.](progressive-web-app/_static/image4.png)

1. <span data-ttu-id="80601-151">Laden Sie die Seite neu, und überprüfen Sie die Registerkarte **Netzwerk**. **Service Worker** oder **Arbeitsspeichercache** wird als Quelle für alle Ressourcen der Seite aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="80601-151">Reload the page and examine the **Network** tab. **Service Worker** or **memory cache** are listed as the sources for all of the page's assets:</span></span>

   ![Auf der Registerkarte „Netzwerk“ der Entwicklertools werden die Quellen für alle Ressourcen der Seite angezeigt.](progressive-web-app/_static/image5.png)

1. <span data-ttu-id="80601-153">Führen Sie einen der folgenden Schritte aus, um zu überprüfen, ob der Browser Netzwerkzugriff zum Laden der App benötigt:</span><span class="sxs-lookup"><span data-stu-id="80601-153">To verify that the browser isn't dependent on network access to load the app, either:</span></span>

   * <span data-ttu-id="80601-154">Fahren Sie den Webserver herunter, und überprüfen Sie, wie die App normalerweise funktioniert, dazu gehört auch das Neuladen der Seite.</span><span class="sxs-lookup"><span data-stu-id="80601-154">Shut down the web server and see how the app continues to function normally, which includes page reloads.</span></span> <span data-ttu-id="80601-155">Ebenso funktioniert die App weiterhin normal, wenn eine langsame Netzwerkverbindung vorliegt.</span><span class="sxs-lookup"><span data-stu-id="80601-155">Likewise, the app continues to function normally when there's a slow network connection.</span></span>
   * <span data-ttu-id="80601-156">Weisen Sie den Browser auf der Registerkarte **Netzwerk** dazu an, den Offlinemodus zu simulieren:</span><span class="sxs-lookup"><span data-stu-id="80601-156">Instruct the browser to simulate offline mode in the **Network** tab:</span></span>

   ![Registerkarte „Netzwerk“ in den Entwicklertools von Google Chrome mit der Änderung des Dropdownfelds für den Browsermodus von „Online“ in „Offline“](progressive-web-app/_static/image6.png)

<span data-ttu-id="80601-158">Die Offlineunterstützung mit einem Service Worker ist ein Webstandard, der nicht spezifisch für Blazor gilt.</span><span class="sxs-lookup"><span data-stu-id="80601-158">Offline support using a service worker is a web standard, not specific to Blazor.</span></span> <span data-ttu-id="80601-159">Weitere Informationen über Service Worker finden Sie unter [MDN Web Docs: Service Worker API](https://developer.mozilla.org/docs/Web/API/Service_Worker_API).</span><span class="sxs-lookup"><span data-stu-id="80601-159">For more information on service workers, see [MDN web docs: Service Worker API](https://developer.mozilla.org/docs/Web/API/Service_Worker_API).</span></span> <span data-ttu-id="80601-160">Weitere Informationen über gängige Nutzungsmuster für Service Worker finden Sie unter [Google Web: The Service Worker Lifecycle (Google Web: Service Worker-Lebenszyklus)](https://developers.google.com/web/fundamentals/primers/service-workers/lifecycle).</span><span class="sxs-lookup"><span data-stu-id="80601-160">To learn more about common usage patterns for service workers, see [Google Web: The Service Worker Lifecycle](https://developers.google.com/web/fundamentals/primers/service-workers/lifecycle).</span></span>

<span data-ttu-id="80601-161">Die PWA-Vorlage von Blazor erzeugt zwei Service-Worker-Dateien:</span><span class="sxs-lookup"><span data-stu-id="80601-161">Blazor's PWA template produces two service worker files:</span></span>

* <span data-ttu-id="80601-162">*wwwroot/service-worker.js*, diese Datei wird während der Entwicklung verwendet.</span><span class="sxs-lookup"><span data-stu-id="80601-162">*wwwroot/service-worker.js*, which is used during development.</span></span>
* <span data-ttu-id="80601-163">*wwwroot/service-worker.published.js*, diese Datei wird nach dem Veröffentlichen der App verwendet.</span><span class="sxs-lookup"><span data-stu-id="80601-163">*wwwroot/service-worker.published.js*, which is used after the app is published.</span></span>

<span data-ttu-id="80601-164">Sie können den folgenden Ansatz verwenden, um die Logik zwischen den zwei Service Worker-Dateien freizugeben:</span><span class="sxs-lookup"><span data-stu-id="80601-164">To share logic between the two service worker files, consider the following approach:</span></span>

* <span data-ttu-id="80601-165">Fügen Sie eine dritte JavaScript-Datei hinzu, die die gemeinsame Logik enthält.</span><span class="sxs-lookup"><span data-stu-id="80601-165">Add a third JavaScript file to hold the common logic.</span></span>
* <span data-ttu-id="80601-166">Verwenden Sie [self.importScripts](https://developer.mozilla.org/docs/Web/API/WorkerGlobalScope/importScripts), um die Logik in beide Service Worker-Dateien zu laden.</span><span class="sxs-lookup"><span data-stu-id="80601-166">Use [self.importScripts](https://developer.mozilla.org/docs/Web/API/WorkerGlobalScope/importScripts) to load the common logic into both service worker files.</span></span>

### <a name="cache-first-fetch-strategy"></a><span data-ttu-id="80601-167">Cache-First-Abrufstrategie</span><span class="sxs-lookup"><span data-stu-id="80601-167">Cache-first fetch strategy</span></span>

<span data-ttu-id="80601-168">Der integrierte Service Worker *service-worker.published.js* löst Anforderungen mit einer *Cache-First*-Strategie auf.</span><span class="sxs-lookup"><span data-stu-id="80601-168">The built-in *service-worker.published.js* service worker resolves requests using a *cache-first* strategy.</span></span> <span data-ttu-id="80601-169">Das bedeutet, dass der Service Worker bevorzugt, zwischengespeicherte Inhalte zurückzugeben, unabhängig davon, ob der Benutzer über Netzwerkzugriff verfügt oder ob neuere Inhalte auf dem Server verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="80601-169">This means that the service worker prefers to return cached content, regardless of whether the user has network access or newer content is available on the server.</span></span>

<span data-ttu-id="80601-170">Die Cache-First-Strategie hat folgende Vorteile:</span><span class="sxs-lookup"><span data-stu-id="80601-170">The cache-first strategy is valuable because:</span></span>

* <span data-ttu-id="80601-171">**Die Zuverlässigkeit wird sichergestellt.**</span><span class="sxs-lookup"><span data-stu-id="80601-171">**It ensures reliability.**</span></span> <span data-ttu-id="80601-172">&ndash; Der Netzwerkzugriff ist kein boolescher Zustand.</span><span class="sxs-lookup"><span data-stu-id="80601-172">&ndash; Network access isn't a boolean state.</span></span> <span data-ttu-id="80601-173">Ein Benutzer ist nicht einfach online oder offline:</span><span class="sxs-lookup"><span data-stu-id="80601-173">A user isn't simply online or offline:</span></span>

  * <span data-ttu-id="80601-174">Das Gerät des Benutzers geht möglicherweise davon aus, dass es online ist, jedoch kann das Netzwerk so langsam sein, dass es unpraktisch ist, auf es zu warten.</span><span class="sxs-lookup"><span data-stu-id="80601-174">The user's device may assume it's online, but the network might be so slow as to be impractical to wait for.</span></span>
  * <span data-ttu-id="80601-175">Das Netzwerk könnte ungültige Ergebnisse für bestimmte URLs zurückgeben, z. B. wenn ein Captive-WLAN-Portal vorliegt, das bestimmte Anforderungen derzeit blockiert oder umleitet.</span><span class="sxs-lookup"><span data-stu-id="80601-175">The network might return invalid results for certain URLs, such as when there's a captive WIFI portal that's currently blocking or redirecting certain requests.</span></span>
  
  <span data-ttu-id="80601-176">Aus diesem Grund ist die `navigator.onLine`-API des Browsers nicht zuverlässig, und Sie sollten nicht auf sie vertrauen.</span><span class="sxs-lookup"><span data-stu-id="80601-176">This is why the browser's `navigator.onLine` API isn't reliable and shouldn't be depended upon.</span></span>

* <span data-ttu-id="80601-177">**Die Richtigkeit wird sichergestellt.**</span><span class="sxs-lookup"><span data-stu-id="80601-177">**It ensures correctness.**</span></span> <span data-ttu-id="80601-178">&ndash; Beim Erstellen eines Caches für Offlineressourcen stellt der Service Worker mithilfe von Inhaltshashs sicher, dass er zu einem bestimmten Zeitpunkt eine vollständige und in sich konsistente Momentaufnahme der Ressourcen abgerufen hat.</span><span class="sxs-lookup"><span data-stu-id="80601-178">&ndash; When building a cache of offline resources, the service worker uses content hashing to guarantee it has fetched a complete and self-consistent snapshot of resources at a single instant in time.</span></span> <span data-ttu-id="80601-179">Dieser Cache wird dann als atomische Einheit verwendet.</span><span class="sxs-lookup"><span data-stu-id="80601-179">This cache is then used as an atomic unit.</span></span> <span data-ttu-id="80601-180">Es macht keinen Sinn, neue Ressourcen vom Netzwerk anzufordern, da nur die bereits zwischengespeicherten Versionen erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="80601-180">There's no point asking the network for newer resources, since the only versions required are the ones already cached.</span></span> <span data-ttu-id="80601-181">Alle anderen Strategien sind mit dem Risiko von Inkonsistenz und Inkompatibilität behaftet (wenn z. B. versucht wird, Versionen von .NET-Assemblys zu verwenden, die nicht gemeinsam kompiliert wurden).</span><span class="sxs-lookup"><span data-stu-id="80601-181">Anything else risks inconsistency and incompatibility (for example, trying to use versions of .NET assemblies that weren't compiled together).</span></span>

### <a name="background-updates"></a><span data-ttu-id="80601-182">Hintergrundupdates</span><span class="sxs-lookup"><span data-stu-id="80601-182">Background updates</span></span>

<span data-ttu-id="80601-183">Sie können sich das Verhalten einer Offline-First-PWA wie das einer mobilen App vorstellen, die installiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="80601-183">As a mental model, you can think of an offline-first PWA as behaving like a mobile app that can be installed.</span></span> <span data-ttu-id="80601-184">Die App wird unabhängig von der Netzwerkkonnektivität immer sofort gestartet, die installierte App-Logik stammt jedoch aus einer Zeitpunkt-Momentaufnahme, die möglicherweise nicht die neueste Version ist.</span><span class="sxs-lookup"><span data-stu-id="80601-184">The app starts up immediately regardless of network connectivity, but the installed app logic comes from a point-in-time snapshot that might not be the latest version.</span></span>

<span data-ttu-id="80601-185">Mit der Blazor-PWA-Vorlage werden Apps erstellt, die immer automatisch versuchen, sich im Hintergrund zu aktualisieren, wenn sie vom Benutzer besucht werden und eine funktionsfähige Netzwerkverbindung besteht.</span><span class="sxs-lookup"><span data-stu-id="80601-185">The Blazor PWA template produces apps that automatically try to update themselves in the background whenever the user visits and has a working network connection.</span></span> <span data-ttu-id="80601-186">Dies geschieht auf folgende Weise:</span><span class="sxs-lookup"><span data-stu-id="80601-186">The way this works is as follows:</span></span>

* <span data-ttu-id="80601-187">Das Projekt generiert während der Kompilierung ein *Service Worker-Assetmanifest*.</span><span class="sxs-lookup"><span data-stu-id="80601-187">During compilation, the project generates a *service worker assets manifest*.</span></span> <span data-ttu-id="80601-188">Sein Standardname lautet *service-worker-assets.js*.</span><span class="sxs-lookup"><span data-stu-id="80601-188">By default, this is called *service-worker-assets.js*.</span></span> <span data-ttu-id="80601-189">Das Manifest führt alle statischen Ressourcen auf, die die App benötigt, um offline zu funktionieren, z. B. .NET-Assemblys, JavaScript-Dateien und CSS, einschließlich ihrer Inhaltshashs.</span><span class="sxs-lookup"><span data-stu-id="80601-189">The manifest lists all the static resources that the app requires to function offline, such as .NET assemblies, JavaScript files, and CSS, including their content hashes.</span></span> <span data-ttu-id="80601-190">Diese Ressourcenliste wird vom Service Worker geladen, damit er weiß, welche Ressourcen zwischengespeichert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="80601-190">The resource list is loaded by the service worker so that it knows which resources to cache.</span></span>
* <span data-ttu-id="80601-191">Jedes Mal, wenn der Benutzer die App aufruft, fordert der Browser die Dateien *service-worker.js* und *service-worker-assets.js* im Hintergrund wieder an.</span><span class="sxs-lookup"><span data-stu-id="80601-191">Each time the user visits the app, the browser re-requests *service-worker.js* and *service-worker-assets.js* in the background.</span></span> <span data-ttu-id="80601-192">Die Dateien werden Byte für Byte mit dem vorhandenen installierten Service Worker verglichen.</span><span class="sxs-lookup"><span data-stu-id="80601-192">The files are compared byte-for-byte with the existing installed service worker.</span></span> <span data-ttu-id="80601-193">Wenn der Server geänderte Inhalte für eine dieser Dateien zurückgibt, versucht der Service Worker, eine neue Version zu installieren.</span><span class="sxs-lookup"><span data-stu-id="80601-193">If the server returns changed content for either of these files, the service worker attempts to install a new version of itself.</span></span>
* <span data-ttu-id="80601-194">Bei der Installation der neuen Version erstellt der Service Worker einen neuen separaten Cache für Offlineressourcen und füllt diesem mit den Ressourcen auf, die in der Datei *service-worker-assets.js* aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="80601-194">When installing a new version of itself, the service worker creates a new, separate cache for offline resources and starts populating the cache with resources listed in *service-worker-assets.js*.</span></span> <span data-ttu-id="80601-195">Diese Logik ist in der Funktion `onInstall` in *service-worker.published.js* implementiert.</span><span class="sxs-lookup"><span data-stu-id="80601-195">This logic is implemented in the `onInstall` function inside *service-worker.published.js*.</span></span>
* <span data-ttu-id="80601-196">Der Prozess wird erfolgreich abgeschlossen, wenn alle Ressourcen ohne Fehler geladen werden und alle Inhaltshashs übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="80601-196">The process completes successfully when all of the resources are loaded without error and all content hashes match.</span></span> <span data-ttu-id="80601-197">Nach erfolgreicher Installation geht der neue Service Worker in den Zustand *waiting for activation* (Auf Aktivierung warten) über.</span><span class="sxs-lookup"><span data-stu-id="80601-197">If successful, the new service worker enters a *waiting for activation* state.</span></span> <span data-ttu-id="80601-198">Sobald der Benutzer die App schließt (keine Registerkarten oder Fenster der App verbleiben), wird der neue Service Worker *aktiv* und für nachfolgende Aufrufe der App verwendet.</span><span class="sxs-lookup"><span data-stu-id="80601-198">As soon as the user closes the app (no remaining app tabs or windows), the new service worker becomes *active* and is used for subsequent app visits.</span></span> <span data-ttu-id="80601-199">Der alte Service Worker und der zugehörige Cache werden gelöscht.</span><span class="sxs-lookup"><span data-stu-id="80601-199">The old service worker and its cache are deleted.</span></span>
* <span data-ttu-id="80601-200">Wenn der Prozess nicht erfolgreich abgeschlossen wird, wird die neue Service Worker-Instanz verworfen.</span><span class="sxs-lookup"><span data-stu-id="80601-200">If the process doesn't complete successfully, the new service worker instance is discarded.</span></span> <span data-ttu-id="80601-201">Der Updateprozess wird dann beim nächsten Aufruf durch den Benutzer wieder versucht. Dann sollte der Client im Idealfall über eine bessere Netzwerkverbindung verfügen, um die Anforderungen zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="80601-201">The update process is attempted again on the user's next visit, when hopefully the client has a better network connection that can complete the requests.</span></span>

<span data-ttu-id="80601-202">Sie können diesen Prozess anpassen, indem Sie die Service Worker-Logik bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="80601-202">Customize this process by editing the service worker logic.</span></span> <span data-ttu-id="80601-203">Keines der zuvor beschriebenen Verhalten gilt spezifisch für Blazor, es handelt sich dabei lediglich um die Standardfunktionsweise der PWA-Vorlagenoption.</span><span class="sxs-lookup"><span data-stu-id="80601-203">None of the preceding behavior is specific to Blazor but is merely the default experience provided by the PWA template option.</span></span> <span data-ttu-id="80601-204">Weitere Informationen finden Sie unter [MDN Web Docs: Service Worker API](https://developer.mozilla.org/docs/Web/API/Service_Worker_API).</span><span class="sxs-lookup"><span data-stu-id="80601-204">For more information, see [MDN web docs: Service Worker API](https://developer.mozilla.org/docs/Web/API/Service_Worker_API).</span></span>

### <a name="how-requests-are-resolved"></a><span data-ttu-id="80601-205">Auflösen von Anforderungen</span><span class="sxs-lookup"><span data-stu-id="80601-205">How requests are resolved</span></span>

<span data-ttu-id="80601-206">Wie im Abschnitt [Cache-First-Abrufstrategie](#cache-first-fetch-strategy) beschrieben verwendet der Standard-Service Worker eine *Cache-First-Strategie*, d. h., er versucht zwischengespeicherte Inhalte bereitzustellen, wenn diese verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="80601-206">As described in the [Cache-first fetch strategy](#cache-first-fetch-strategy) section, the default service worker uses a *cache-first* strategy, meaning that it tries to serve cached content when available.</span></span> <span data-ttu-id="80601-207">Wenn für eine bestimmte URL kein Inhalt zwischengespeichert ist, z. B., wenn Daten von einer Back-End-API angefordert werden, greif der Service Worker auf eine herkömmliche Netzwerkanforderung zurück.</span><span class="sxs-lookup"><span data-stu-id="80601-207">If there is no content cached for a certain URL, for example when requesting data from a backend API, the service worker falls back on a regular network request.</span></span> <span data-ttu-id="80601-208">Die Netzwerkanforderung wird erfolgreich durchgeführt, wenn der Server erreichbar ist.</span><span class="sxs-lookup"><span data-stu-id="80601-208">The network request succeeds if the server is reachable.</span></span> <span data-ttu-id="80601-209">Diese Logik ist in der `onFetch`-Funktion in der Datei *service-worker.published.js* implementiert.</span><span class="sxs-lookup"><span data-stu-id="80601-209">This logic is implemented inside `onFetch` function within *service-worker.published.js*.</span></span>

<span data-ttu-id="80601-210">Wenn die Razor-Komponenten der App Daten von Back-End-APIs anfordern müssen und Sie ein benutzerfreundliches Verfahren für fehlgeschlagene Anforderungen bei nicht verfügbarer Netzwerkverbindung anbieten möchten, können Sie die Logik innerhalb der App-Komponenten implementieren.</span><span class="sxs-lookup"><span data-stu-id="80601-210">If the app's Razor components rely on requesting data from backend APIs and you want to provide a friendly user experience for failed requests due to network unavailability, implement logic within the app's components.</span></span> <span data-ttu-id="80601-211">Schließen Sie z. B. `HttpClient`-Anforderungen in `try/catch` ein.</span><span class="sxs-lookup"><span data-stu-id="80601-211">For example, use `try/catch` around `HttpClient` requests.</span></span>

### <a name="support-server-rendered-pages"></a><span data-ttu-id="80601-212">Unterstützung von auf dem Server gerenderten Seiten</span><span class="sxs-lookup"><span data-stu-id="80601-212">Support server-rendered pages</span></span>

<span data-ttu-id="80601-213">Beachten Sie, was geschieht, wenn der Benutzer zuerst eine URL (z. B. `/counter`) oder einen anderen Deep-Link in der App aufruft.</span><span class="sxs-lookup"><span data-stu-id="80601-213">Consider what happens when the user first navigates to a URL such as `/counter` or any other deep link in the app.</span></span> <span data-ttu-id="80601-214">In diesen Fällen sollen keine Inhalte zurückgegeben werden, die als `/counter` zwischengespeichert sind. Stattdessen muss der Browser als `/index.html` zwischengespeicherte Inhalte laden, um die Blazor WebAssembly-App zu starten.</span><span class="sxs-lookup"><span data-stu-id="80601-214">In these cases, you don't want to return content cached as `/counter`, but instead need the browser to load the content cached as `/index.html` to start up your Blazor WebAssembly app.</span></span> <span data-ttu-id="80601-215">Diese anfänglichen Anforderungen werden als *Navigationsanforderungen* bezeichnet. Außerdem gibt es:</span><span class="sxs-lookup"><span data-stu-id="80601-215">These initial requests are known as *navigation* requests, as opposed to:</span></span>

* <span data-ttu-id="80601-216">*subresource*-Anforderungen (untergeordnete Ressourcen) für Bilder, Stylesheets oder andere Dateien</span><span class="sxs-lookup"><span data-stu-id="80601-216">*subresource* requests for images, stylesheets, or other files.</span></span>
* <span data-ttu-id="80601-217">*fetch/XHR*-Anforderungen für API-Daten</span><span class="sxs-lookup"><span data-stu-id="80601-217">*fetch/XHR* requests for API data.</span></span>

<span data-ttu-id="80601-218">Der Standard-Service-Worker enthält eine spezielle Logik für Navigationsanforderungen.</span><span class="sxs-lookup"><span data-stu-id="80601-218">The default service worker contains special-case logic for navigation requests.</span></span> <span data-ttu-id="80601-219">Der Service Worker löst die Anforderungen auf, indem er den zwischengespeicherten Inhalt unabhängig von der angeforderten URL für `/index.html` zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="80601-219">The service worker resolves the requests by returning the cached content for `/index.html`, regardless of the requested URL.</span></span> <span data-ttu-id="80601-220">Diese Logik ist in der Funktion `onFetch` in *service-worker.published.js* implementiert.</span><span class="sxs-lookup"><span data-stu-id="80601-220">This logic is implemented in the `onFetch` function inside *service-worker.published.js*.</span></span>

<span data-ttu-id="80601-221">Wenn die App über bestimmte URLs verfügt, die auf dem Server gerendertes HTML zurückgeben müssen, ohne `/index.html` aus dem Cache bereitzustellen, müssen Sie die Logik im Service Worker bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="80601-221">If your app has certain URLs that must return server-rendered HTML, and not serve `/index.html` from the cache, then you need to edit the logic in your service worker.</span></span> <span data-ttu-id="80601-222">Wenn alle URLs, die `/Identity/` enthalten, als reguläre Onlineanforderungen an den Server behandelt werden müssen, bearbeiten Sie die `onFetch`-Logik von *service-worker.published.js*.</span><span class="sxs-lookup"><span data-stu-id="80601-222">If all URLs containing `/Identity/` need to be handled as regular online-only requests to the server, then modify *service-worker.published.js* `onFetch` logic.</span></span> <span data-ttu-id="80601-223">Suchen Sie den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="80601-223">Locate the following code:</span></span>

```javascript
const shouldServeIndexHtml = event.request.mode === 'navigate';
```

<span data-ttu-id="80601-224">Ändern Sie den Code wie folgt:</span><span class="sxs-lookup"><span data-stu-id="80601-224">Change the code to the following:</span></span>

```javascript
const shouldServeIndexHtml = event.request.mode === 'navigate'
    && !event.request.url.includes('/Identity/');
```

<span data-ttu-id="80601-225">Wenn Sie dies nicht tun, fängt der Service Worker unabhängig von der Netzwerkkonnektivität Anforderungen für diese URLs ab und löst sie mithilfe von `/index.html` auf.</span><span class="sxs-lookup"><span data-stu-id="80601-225">If you don't do this, then regardless of network connectivity, the service worker intercepts requests for such URLs and resolves them using `/index.html`.</span></span>

### <a name="control-asset-caching"></a><span data-ttu-id="80601-226">Steuern der Zwischenspeicherung von Ressourcen</span><span class="sxs-lookup"><span data-stu-id="80601-226">Control asset caching</span></span>

<span data-ttu-id="80601-227">Wenn Ihr Projekt die MSBuild-Eigenschaft `ServiceWorkerAssetsManifest` definiert, erstellen die Buildtools von Blazor ein Service Worker-Assetmanifest mit dem angegebenen Namen.</span><span class="sxs-lookup"><span data-stu-id="80601-227">If your project defines the `ServiceWorkerAssetsManifest` MSBuild property, Blazor's build tooling generates a service worker assets manifest with the specified name.</span></span> <span data-ttu-id="80601-228">Die PWA-Standardvorlage erzeugt eine Projektdatei, die die folgende Eigenschaft enthält:</span><span class="sxs-lookup"><span data-stu-id="80601-228">The default PWA template produces a project file containing the following property:</span></span>

```xml
<ServiceWorkerAssetsManifest>service-worker-assets.js</ServiceWorkerAssetsManifest>
```

<span data-ttu-id="80601-229">Die Datei wird in das Ausgabeverzeichnis *wwwroot* eingefügt, sodass sie vom Browser durch Anfordern von `/service-worker-assets.js` abgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="80601-229">The file is placed in the *wwwroot* output directory, so the browser can retrieve this file by requesting `/service-worker-assets.js`.</span></span> <span data-ttu-id="80601-230">Öffnen Sie */bin/Debug/{ZIELFRAMEWORK}/wwwroot/service-worker-assets.js* in einem Text-Editor, um die Inhalt dieser Datei einzusehen.</span><span class="sxs-lookup"><span data-stu-id="80601-230">To see the contents of this file, open */bin/Debug/{TARGET FRAMEWORK}/wwwroot/service-worker-assets.js* in a text editor.</span></span> <span data-ttu-id="80601-231">Bearbeiten Sie die Datei jedoch nicht, da sie mit jedem Build neu generiert wird.</span><span class="sxs-lookup"><span data-stu-id="80601-231">However, don't edit the file, as it's regenerated on each build.</span></span>

<span data-ttu-id="80601-232">Standardmäßig wird in diesem Manifest Folgendes aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="80601-232">By default, this manifest lists:</span></span>

* <span data-ttu-id="80601-233">Alle von Blazor verwalteten Ressourcen, z. B. .NET-Assemblys und die .NET-WebAssembly-Runtimedateien, die für die Offlineausführung erforderlich sind</span><span class="sxs-lookup"><span data-stu-id="80601-233">Any Blazor-managed resources, such as .NET assemblies and the .NET WebAssembly runtime files required to function offline.</span></span>
* <span data-ttu-id="80601-234">Alle Ressourcen für die Veröffentlichung im *wwwroot*-Verzeichnis, z. B. Bilder, Stylesheets und JavaScript-Dateien, einschließlich der statischen Webressourcen, die von externen Projekten und NuGet-Paketen bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="80601-234">All resources for publishing to the app's *wwwroot* directory, such as images, stylesheets, and JavaScript files, including static web assets supplied by external projects and NuGet packages.</span></span>

<span data-ttu-id="80601-235">Sie können steuern, welche dieser Ressourcen vom Service Worker abgerufen und zwischengespeichert werden, indem Sie die Logik in `onInstall` in *service-worker.published.js* bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="80601-235">You can control which of these resources are fetched and cached by the service worker by editing the logic in `onInstall` in *service-worker.published.js*.</span></span> <span data-ttu-id="80601-236">Der Service Worker ruft Dateien standardmäßig entsprechend der üblichen Erweiterungen für Webdateinamen ab und zwischenspeichert diese, z. B. mit *.html*, *.css*, *.js* und *.wasm* sowie mit Dateitypen für Blazor WebAssembly ( *.dll*, *.pdb*).</span><span class="sxs-lookup"><span data-stu-id="80601-236">By default, the service worker fetches and caches files matching typical web filename extensions such as *.html*, *.css*, *.js*, and *.wasm*, plus file types specific to Blazor WebAssembly (*.dll*, *.pdb*).</span></span>

<span data-ttu-id="80601-237">Definieren Sie zusätzliche *-MSBuild-Einträge wie im folgenden Beispiel gezeigt, um zusätzliche Ressourcen einzufügen, die nicht im* wwwroot`ItemGroup`-Verzeichnis der App vorhanden sind:</span><span class="sxs-lookup"><span data-stu-id="80601-237">To include additional resources that aren't present in the app's *wwwroot* directory, define extra MSBuild `ItemGroup` entries, as shown in the following example:</span></span>

```xml
<ItemGroup>
  <ServiceWorkerAssetsManifestItem Include="MyDirectory\AnotherFile.json"
    RelativePath="MyDirectory\AnotherFile.json" AssetUrl="files/AnotherFile.json" />
</ItemGroup>
```

<span data-ttu-id="80601-238">Die `AssetUrl`-Metadaten geben die zur Basis relative URL an, die der Browser beim Abrufen der zwischenzuspeichernden Ressource verwenden soll.</span><span class="sxs-lookup"><span data-stu-id="80601-238">The `AssetUrl` metadata specifies the base-relative URL that the browser should use when fetching the resource to cache.</span></span> <span data-ttu-id="80601-239">Dieser Wert kann unabhängig vom ursprünglichen Quelldateinamen auf dem Datenträger sein.</span><span class="sxs-lookup"><span data-stu-id="80601-239">This can be independent of its original source file name on disk.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="80601-240">Durch das Hinzufügen von `ServiceWorkerAssetsManifestItem` wird die Datei nicht im *wwwroot*-Verzeichnis der App veröffentlicht.</span><span class="sxs-lookup"><span data-stu-id="80601-240">Adding a `ServiceWorkerAssetsManifestItem` doesn't cause the file to be published in the app's *wwwroot* directory.</span></span> <span data-ttu-id="80601-241">Die Veröffentlichungsausgabe muss separat gesteuert werden.</span><span class="sxs-lookup"><span data-stu-id="80601-241">The publish output must be controlled separately.</span></span> <span data-ttu-id="80601-242">Das `ServiceWorkerAssetsManifestItem` bewirkt lediglich, dass im Service-Worker-Assetmanifest ein zusätzlicher Eintrag angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="80601-242">The `ServiceWorkerAssetsManifestItem` only causes an additional entry to appear in the service worker assets manifest.</span></span>

## <a name="push-notifications"></a><span data-ttu-id="80601-243">Pushbenachrichtigungen</span><span class="sxs-lookup"><span data-stu-id="80601-243">Push notifications</span></span>

<span data-ttu-id="80601-244">Eine Blazor WebAssembly-PWA kann wie jede andere PWA Pushbenachrichtigungen von einem Back-End-Server empfangen.</span><span class="sxs-lookup"><span data-stu-id="80601-244">Like any other PWA, a Blazor WebAssembly PWA can receive push notifications from a backend server.</span></span> <span data-ttu-id="80601-245">Der Server kann jederzeit Pushbenachrichtigungen senden, auch wenn der Benutzer die App nicht aktiv verwendet.</span><span class="sxs-lookup"><span data-stu-id="80601-245">The server can send push notifications at any time, even when the user isn't actively using the app.</span></span> <span data-ttu-id="80601-246">Beispielsweise können Pushbenachrichtigungen gesendet werden, wenn ein anderer Benutzer eine relevante Aktion ausführt.</span><span class="sxs-lookup"><span data-stu-id="80601-246">For example, push notifications can be sent when a different user performs a relevant action.</span></span>

<span data-ttu-id="80601-247">Der Mechanismus zum Senden einer Pushbenachrichtigung ist vollständig unabhängig von der Blazor WebAssembly, da er vom Back-End-Server implementiert wird, und dieser kann eine beliebige Technologie verwenden.</span><span class="sxs-lookup"><span data-stu-id="80601-247">The mechanism for sending a push notification is entirely independent of Blazor WebAssembly, since it's implemented by the backend server which can use any technology.</span></span> <span data-ttu-id="80601-248">Wenn Sie Pushbenachrichtigungen von einem ASP.NET Core-Server senden möchten, sollten Sie [ein ähnliches Verfahren wie beim Blazing Pizza-Workshop](https://github.com/dotnet-presentations/blazor-workshop/blob/master/docs/09-progressive-web-app.md#sending-push-notifications) verwenden.</span><span class="sxs-lookup"><span data-stu-id="80601-248">If you want to send push notifications from an ASP.NET Core server, consider [using a technique similar to the approach taken in the Blazing Pizza workshop](https://github.com/dotnet-presentations/blazor-workshop/blob/master/docs/09-progressive-web-app.md#sending-push-notifications).</span></span>

<span data-ttu-id="80601-249">Der Mechanismus zum Empfangen und Anzeigen einer Pushbenachrichtigung auf dem Client hängt nicht von der Blazor WebAssembly ab, da er in der JavaScript-Datei vom Service Worker implementiert ist.</span><span class="sxs-lookup"><span data-stu-id="80601-249">The mechanism for receiving and displaying a push notification on the client is also independent of Blazor WebAssembly, since it's implemented in the service worker JavaScript file.</span></span> <span data-ttu-id="80601-250">Ein Beispiel finden Sie im [Verfahren des Blazing Pizza-Workshops](https://github.com/dotnet-presentations/blazor-workshop/blob/master/docs/09-progressive-web-app.md#displaying-notifications).</span><span class="sxs-lookup"><span data-stu-id="80601-250">For an example, see [the approach used in the Blazing Pizza workshop](https://github.com/dotnet-presentations/blazor-workshop/blob/master/docs/09-progressive-web-app.md#displaying-notifications).</span></span>

## <a name="caveats-for-offline-pwas"></a><span data-ttu-id="80601-251">Einschränkungen für Offline-PWAs</span><span class="sxs-lookup"><span data-stu-id="80601-251">Caveats for offline PWAs</span></span>

<span data-ttu-id="80601-252">Nicht alle Apps sollten die Offlineverwendung unterstützen.</span><span class="sxs-lookup"><span data-stu-id="80601-252">Not all apps should attempt to support offline use.</span></span> <span data-ttu-id="80601-253">Mit der Offlineunterstützung wird die Komplexität deutlich erhöht und sie ist nicht immer für die erforderlichen Anwendungsfälle relevant.</span><span class="sxs-lookup"><span data-stu-id="80601-253">Offline support adds significant complexity, while not always being relevant for the use cases required.</span></span>

<span data-ttu-id="80601-254">Die Offlineunterstützung ist in der Regel nur in folgenden Situationen relevant:</span><span class="sxs-lookup"><span data-stu-id="80601-254">Offline support is usually relevant only:</span></span>

* <span data-ttu-id="80601-255">Wenn der primäre Datenspeicher für den Browser lokal ist.</span><span class="sxs-lookup"><span data-stu-id="80601-255">If the primary data store is local to the browser.</span></span> <span data-ttu-id="80601-256">Der Ansatz eignet sich beispielsweise für Apps mit einer Benutzeroberfläche für ein [IoT-Gerät](https://en.wikipedia.org/wiki/Internet_of_things), das Daten in `localStorage` oder [IndexedDB](https://developer.mozilla.org/docs/Web/API/IndexedDB_API) speichert.</span><span class="sxs-lookup"><span data-stu-id="80601-256">For example, the approach is relevant in an app with a UI for an [IoT](https://en.wikipedia.org/wiki/Internet_of_things) device that stores data in `localStorage` or [IndexedDB](https://developer.mozilla.org/docs/Web/API/IndexedDB_API).</span></span>
* <span data-ttu-id="80601-257">Wenn die App einen beträchtlichen Aufwand tätigen muss, um die Daten der Back-End-API für die einzelnen Benutzer abzurufen und zwischenzuspeichern, damit sie die Daten offline durchsuchen können.</span><span class="sxs-lookup"><span data-stu-id="80601-257">If the app performs a significant amount of work to fetch and cache the backend API data relevant to each user so that they can navigate through the data offline.</span></span> <span data-ttu-id="80601-258">Wenn die App die Bearbeitung unterstützen muss, muss ein System für die Nachverfolgung von Änderungen und die Synchronisierung von Daten mit dem Back-End erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="80601-258">If the app must support editing, a system for tracking changes and synchronizing data with the backend must be built.</span></span>
* <span data-ttu-id="80601-259">Wenn Sie sicherstellen möchten, dass die App unabhängig von den Netzwerkbedingungen sofort geladen wird.</span><span class="sxs-lookup"><span data-stu-id="80601-259">If the goal is to guarantee that the app loads immediately regardless of network conditions.</span></span> <span data-ttu-id="80601-260">Implementieren Sie eine geeignete Benutzeroberfläche für Back-End-API-Anforderungen, um den Fortschritt von Anforderungen zu veranschaulichen und ein ordnungsgemäßes Verhalten zu implementieren, wenn Anforderungen aufgrund von Nichtverfügbarkeit des Netzwerks fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="80601-260">Implement a suitable user experience around backend API requests to show the progress of requests and behave gracefully when requests fail due to network unavailability.</span></span>

<span data-ttu-id="80601-261">Offlinefähige PWAs müssen zudem eine Reihe zusätzlicher Komplikationen bewältigen.</span><span class="sxs-lookup"><span data-stu-id="80601-261">Additionally, offline-capable PWAs must deal with a range of additional complications.</span></span> <span data-ttu-id="80601-262">Entwickler sollten sich in den folgenden Abschnitten mit den Nachteilen vertraut machen.</span><span class="sxs-lookup"><span data-stu-id="80601-262">Developers should carefully familiarize themselves with the caveats in the following sections.</span></span>

### <a name="offline-support-only-when-published"></a><span data-ttu-id="80601-263">Offlineunterstützung nur bei Veröffentlichung</span><span class="sxs-lookup"><span data-stu-id="80601-263">Offline support only when published</span></span>

<span data-ttu-id="80601-264">Während der Entwicklung möchten Sie Änderungen in der Regel sofort im Browser sehen, ohne einen Updateprozess im Hintergrund zu durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="80601-264">During development you typically want to see each change reflected immediately in the browser without going through a background update process.</span></span> <span data-ttu-id="80601-265">Daher aktiviert die PWA-Vorlage von Blazor die Offlineunterstützung nur, wenn die App veröffentlicht wird.</span><span class="sxs-lookup"><span data-stu-id="80601-265">Therefore, Blazor's PWA template enables offline support only when published.</span></span>

<span data-ttu-id="80601-266">Beim Erstellen eine offlinefähigen App reicht es nicht aus, die App in der Entwicklungsumgebung zu testen.</span><span class="sxs-lookup"><span data-stu-id="80601-266">When building an offline-capable app, it's not enough to test the app in the Development environment.</span></span> <span data-ttu-id="80601-267">Sie müssen die App im veröffentlichten Zustand testen, um zu verstehen, wie sie auf verschiedene Netzwerkbedingungen reagiert.</span><span class="sxs-lookup"><span data-stu-id="80601-267">You must test the app in its published state to understand how it responds to different network conditions.</span></span>

### <a name="update-completion-after-user-navigation-away-from-app"></a><span data-ttu-id="80601-268">Abschluss des Updates, nachdem der Benutzer die App verlassen hat</span><span class="sxs-lookup"><span data-stu-id="80601-268">Update completion after user navigation away from app</span></span>

<span data-ttu-id="80601-269">Updates werden erst abgeschlossen, wenn der Benutzer die App auf allen Registerkarten verlassen hat.</span><span class="sxs-lookup"><span data-stu-id="80601-269">Updates don't complete until the user has navigated away from the app in all tabs.</span></span> <span data-ttu-id="80601-270">Nach der Bereitstellung eines Updates für die App, ruft der Browser die aktualisierten Service Worker-Dateien wie im Abschnitt [Hintergrundupdates](#background-updates) beschrieben ab, um den Updateprozess einzuleiten.</span><span class="sxs-lookup"><span data-stu-id="80601-270">As explained in the [Background updates](#background-updates) section, after you deploy an update to the app, the browser fetches the updated service worker files to begin the update process.</span></span>

<span data-ttu-id="80601-271">Viele Entwickler wissen nicht, dass das Update nach seinem Abschluss **erst dann** wirksam wird, wenn die Anwendung auf allen Registerkarten vom Benutzer verlassen wurde.</span><span class="sxs-lookup"><span data-stu-id="80601-271">What surprises many developers is that, even when this update completes, it does **not** take effect until the user has navigated away in all tabs.</span></span> <span data-ttu-id="80601-272">Es reicht **nicht** aus, die Registerkarte zu aktualisieren, auf der die App angezeigt wird, selbst wenn dies die einzige Registerkarte ist, auf der sie angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="80601-272">It is **not** sufficient to refresh the tab displaying the app, even if it's the only tab displaying the app.</span></span> <span data-ttu-id="80601-273">Bis Ihre App vollständig geschlossen wurde, weist der neue Service Worker den Zustand *waiting to activate* (Auf Aktivierung warten) auf.</span><span class="sxs-lookup"><span data-stu-id="80601-273">Until your app is completely closed, the new service worker remains in the *waiting to activate* status.</span></span> <span data-ttu-id="80601-274">**Dies ist nicht auf Blazor beschränkt, sondern ein Standardverhalten von Webplattformen.**</span><span class="sxs-lookup"><span data-stu-id="80601-274">**This is not specific to Blazor, but rather is a standard web platform behavior.**</span></span>

<span data-ttu-id="80601-275">Dies bereitet häufig Entwicklern Probleme, die versuchen, Updates des Service Worker oder von offline zwischengespeicherten Ressourcen zu testen.</span><span class="sxs-lookup"><span data-stu-id="80601-275">This commonly troubles developers who are trying to test updates to their service worker or offline cached resources.</span></span> <span data-ttu-id="80601-276">Wenn Sie die Entwicklertools Ihres Browsers überprüfen, wird möglicherweise Folgendes angezeigt:</span><span class="sxs-lookup"><span data-stu-id="80601-276">If you check in the browser's developer tools, you may see something like the following:</span></span>

![Registerkarte „Anwendung“ von Google Chrome zeigt den Zustand „waiting to activate“ (Auf Aktivierung warten) für den Service Worker der App an.](progressive-web-app/_static/image7.png)

<span data-ttu-id="80601-278">Solange die Liste der „Clients“, bei denen es sich um Registerkarten oder Fenster handelt, die Ihre App anzeigen, nicht leer ist, wartet der Worker weiter.</span><span class="sxs-lookup"><span data-stu-id="80601-278">For as long as the list of "clients," which are tabs or windows displaying your app, is nonempty, the worker continues waiting.</span></span> <span data-ttu-id="80601-279">Service Worker verfügen über diese Funktionsweise, um Konsistenz zu garantieren.</span><span class="sxs-lookup"><span data-stu-id="80601-279">The reason service workers do this is to guarantee consistency.</span></span> <span data-ttu-id="80601-280">Konsistenz bedeutet, dass alle Ressourcen aus demselben atomischen Cache abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="80601-280">Consistency means that all resources are fetched from the same atomic cache.</span></span>

<span data-ttu-id="80601-281">Wenn Sie Änderungen testen, können Sie einfach auf den im obigen Screenshot gezeigten Link „skipWaiting“ klicken und dann die Seite neu laden.</span><span class="sxs-lookup"><span data-stu-id="80601-281">When testing changes, you may find it convenient to click the "skipWaiting" link as shown in the preceding screenshot, then reload the page.</span></span> <span data-ttu-id="80601-282">Sie können dies für alle Benutzer automatisieren, indem Sie den Service Worker so programmieren, dass [bei einem Update die Wartephase übersprungen und der Service Worker sofort aktiviert wird](https://developers.google.com/web/fundamentals/primers/service-workers/lifecycle#skip_the_waiting_phase).</span><span class="sxs-lookup"><span data-stu-id="80601-282">You can automate this for all users by coding your service worker to [skip the "waiting" phase and immediately activate on update](https://developers.google.com/web/fundamentals/primers/service-workers/lifecycle#skip_the_waiting_phase).</span></span> <span data-ttu-id="80601-283">Wenn Sie die Wartephase überspringen, kann nicht garantiert werden, dass Ressourcen immer konsistent aus derselben Cache-Instanz abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="80601-283">If you skip the waiting phase, you're giving up the guarantee that resources are always fetched consistently from the same cache instance.</span></span>

### <a name="users-may-run-any-historical-version-of-the-app"></a><span data-ttu-id="80601-284">Benutzer können jede frühere Version der App ausführen.</span><span class="sxs-lookup"><span data-stu-id="80601-284">Users may run any historical version of the app</span></span>

<span data-ttu-id="80601-285">Webentwickler erwarten gewohnheitsmäßig, dass Benutzer nur die zuletzt bereitgestellte Version ihrer Web-App ausführen, da dies im herkömmlichen Webverteilungsmodell üblich ist.</span><span class="sxs-lookup"><span data-stu-id="80601-285">Web developers habitually expect that users only run the latest deployed version of their web app, since that's normal within the traditional web distribution model.</span></span> <span data-ttu-id="80601-286">Eine Offline-First-PWA ähnelt jedoch eher einer nativen mobilen App, bei der die Benutzer nicht unbedingt die neueste Version ausführen.</span><span class="sxs-lookup"><span data-stu-id="80601-286">However, an offline-first PWA is more akin to a native mobile app, where users aren't necessarily running the latest version.</span></span>

<span data-ttu-id="80601-287">Wie im Abschnitt [Hintergrundupdates](#background-updates) beschrieben, **verwendet jeder vorhandene Benutzer weiterhin eine vorherige Version, bis sie die App wieder aufrufen**, nachdem Sie ein Update für Ihre App bereitgestellt haben, da das Update im Hintergrund durchgeführt und erst aktiviert wird, wenn der Benutzer die App geschlossen hat.</span><span class="sxs-lookup"><span data-stu-id="80601-287">As explained in the [Background updates](#background-updates) section, after you deploy an update to your app, **each existing user continues to use a previous version for at least one further visit** because the update occurs in the background and isn't activated until the user thereafter navigates away.</span></span> <span data-ttu-id="80601-288">Außerdem ist die vorherige verwendete Version nicht unbedingt die Version, die Sie zuletzt bereitgestellt haben.</span><span class="sxs-lookup"><span data-stu-id="80601-288">Plus, the previous version being used isn't necessarily the previous one you deployed.</span></span> <span data-ttu-id="80601-289">Je nachdem, wann der Benutzer zuletzt ein Update durchgeführt hat, kann es sich bei der vorherigen Version um eine *beliebige* historische Version handeln.</span><span class="sxs-lookup"><span data-stu-id="80601-289">The previous version can be *any* historical version, depending on when the user last completed an update.</span></span>

<span data-ttu-id="80601-290">Dies kann ein Problem darstellen, wenn die Front-End- und Back-End-Teile der App eine Vereinbarung über das Schema für API-Anforderungen erfordern.</span><span class="sxs-lookup"><span data-stu-id="80601-290">This can be an issue if the frontend and backend parts of your app require agreement about the schema for API requests.</span></span> <span data-ttu-id="80601-291">Sie dürfen keine API-Schemaänderungen bereitstellen, die nicht abwärtskompatibel sind, solange Sie sich nicht vergewissert haben, dass alle Benutzer ein Upgrade durchgeführt haben.</span><span class="sxs-lookup"><span data-stu-id="80601-291">You must not deploy backward-incompatible API schema changes until you can be sure that all users have upgraded.</span></span> <span data-ttu-id="80601-292">Alternativ müssen Sie die Verwendung nicht kompatibler, alter Versionen der App für Benutzer verhindern.</span><span class="sxs-lookup"><span data-stu-id="80601-292">Alternatively, block users from using incompatible older versions of the app.</span></span> <span data-ttu-id="80601-293">Diese Anforderung gilt auch für native mobile Apps.</span><span class="sxs-lookup"><span data-stu-id="80601-293">This scenario requirement is the same as for native mobile apps.</span></span> <span data-ttu-id="80601-294">Wenn Sie einen Breaking Change in Server-APIs bereitstellen, wird die Client-App für Benutzer beschädigt, die noch kein Update durchgeführt haben.</span><span class="sxs-lookup"><span data-stu-id="80601-294">If you deploy a breaking change in server APIs, the client app is broken for users who haven't yet updated.</span></span>

<span data-ttu-id="80601-295">Stellen Sie nach Möglichkeit keine Breaking Changes für die Back-End-APIs bereit.</span><span class="sxs-lookup"><span data-stu-id="80601-295">If possible, don't deploy breaking changes to your backend APIs.</span></span> <span data-ttu-id="80601-296">Wenn sich dies nicht vermeiden lässt, sollten Sie mit [Service Worker-Standard-APIs wie ServiceWorkerRegistration](https://developer.mozilla.org/docs/Web/API/ServiceWorkerRegistration) bestimmen, ob die App auf dem neuesten Stand ist. Wenn das nicht der Fall ist, sollten Sie die Verwendung verhindern.</span><span class="sxs-lookup"><span data-stu-id="80601-296">If you must do so, consider using [standard Service Worker APIs such as ServiceWorkerRegistration](https://developer.mozilla.org/docs/Web/API/ServiceWorkerRegistration) to determine whether the app is up-to-date, and if not, to prevent usage.</span></span>

### <a name="interference-with-server-rendered-pages"></a><span data-ttu-id="80601-297">Störungen bei auf dem Server gerenderten Seiten</span><span class="sxs-lookup"><span data-stu-id="80601-297">Interference with server-rendered pages</span></span>

<span data-ttu-id="80601-298">Bearbeiten Sie die Logik in Ihrem Service Worker wie im Abschnitt [Unterstützung von auf dem Server gerenderten Seiten](#support-server-rendered-pages) beschrieben, wenn Sie das Verhalten vom Service Worker, `/index.html`-Inhalte für alle Navigationsanforderungen zurückzugeben, umgehen möchten.</span><span class="sxs-lookup"><span data-stu-id="80601-298">As described in the [Support server-rendered pages](#support-server-rendered-pages) section, if you want to bypass the service worker's behavior of returning `/index.html` contents for all navigation requests, edit the logic in your service worker.</span></span>

### <a name="all-service-worker-asset-manifest-contents-are-cached-by-default"></a><span data-ttu-id="80601-299">Alle Inhalte des Service-Worker-Assetmanifests werden standardmäßig zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="80601-299">All service worker asset manifest contents are cached by default</span></span>

<span data-ttu-id="80601-300">Die Datei *service-worker-assets.js* wird wie im Abschnitt [Steuern der Zwischenspeicherung von Ressourcen](#control-asset-caching) beschrieben während des Buildvorgangs generiert und führt alle Ressourcen auf, die der Service Worker abrufen und zwischenspeichern soll.</span><span class="sxs-lookup"><span data-stu-id="80601-300">As described in the [Control asset caching](#control-asset-caching) section, the file *service-worker-assets.js* is generated during build and lists all assets the service worker should fetch and cache.</span></span>

<span data-ttu-id="80601-301">Da in dieser Liste standardmäßig alles enthalten ist, was an *wwwroot* ausgegeben wurde (einschließlich Inhalte, die durch externe Pakete und Projekte bereitgestellt wurden), müssen Sie darauf achten, dass Sie nicht zu viele Inhalte einfügen.</span><span class="sxs-lookup"><span data-stu-id="80601-301">Since this list by default includes everything emitted to *wwwroot*, including content supplied by external packages and projects, you must be careful not to put too much content there.</span></span> <span data-ttu-id="80601-302">Wenn das Verzeichnis *wwwroot* Millionen Bilder enthält, versucht der Service Worker, sie alle abzurufen und zwischenzuspeichern. Dabei wird eine übermäßige Bandbreite beansprucht, und der Vorgang wird wahrscheinlich nicht erfolgreich abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="80601-302">If the *wwwroot* directory contains millions of images, the service worker tries to fetch and cache them all, consuming excessive bandwidth and most likely not completing successfully.</span></span>

<span data-ttu-id="80601-303">Sie können beliebige Logik implementieren, um zu steuern, welche Teilmenge der Inhalte des Manifests abgerufen und zwischengespeichert werden, indem Sie die Funktion `onInstall` in *service-worker.published.js* bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="80601-303">Implement arbitrary logic to control which subset of the manifest's contents should be fetched and cached by editing the `onInstall` function in *service-worker.published.js*.</span></span>

### <a name="interaction-with-authentication"></a><span data-ttu-id="80601-304">Interaktion mit Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="80601-304">Interaction with authentication</span></span>

<span data-ttu-id="80601-305">Sie können die PWA-Vorlagenoption zusammen mit den Authentifizierungsoptionen verwenden.</span><span class="sxs-lookup"><span data-stu-id="80601-305">It's possible to use the PWA template option in conjunction with the authentication options.</span></span> <span data-ttu-id="80601-306">Eine offlinefähige PWA kann auch die Authentifizierung unterstützen, wenn der Benutzer über Netzwerkkonnektivität verfügt.</span><span class="sxs-lookup"><span data-stu-id="80601-306">An offline-capable PWA can also support authentication when the user has network connectivity.</span></span>

<span data-ttu-id="80601-307">Wenn ein Benutzer über keine Netzwerkkonnektivität verfügt, kann er sich nicht authentifizieren und keine Zugriffstoken abrufen.</span><span class="sxs-lookup"><span data-stu-id="80601-307">When a user doesn't have network connectivity, they can't authenticate or obtain access tokens.</span></span> <span data-ttu-id="80601-308">Versuche, die Anmeldeseite ohne Netzwerkzugriff zu besuchen, führen standardmäßig zu Netzwerkfehlermeldungen.</span><span class="sxs-lookup"><span data-stu-id="80601-308">By default, attempting to visit the login page without network access results in a "network error" message.</span></span>

<span data-ttu-id="80601-309">Sie müssen einen Benutzeroberflächenflow entwerfen, den Benutzer für nützliche Aktionen offline ausführen können, ohne dass sie versuchen müssen, sich zu authentifizieren oder Zugriffstoken abzurufen.</span><span class="sxs-lookup"><span data-stu-id="80601-309">You must design a UI flow that lets the user do useful things while offline without attempting to authenticate or obtain access tokens.</span></span> <span data-ttu-id="80601-310">Alternativ können Sie die App so entwerfen, dass sie ordnungsgemäß fehlschlägt, wenn das Netzwerk nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="80601-310">Alternatively, you can design the app to fail in a graceful way when the network isn't available.</span></span> <span data-ttu-id="80601-311">Wenn dies bei Ihrer App nicht möglich ist, sollten Sie die Offlineunterstützung womöglich nicht aktivieren.</span><span class="sxs-lookup"><span data-stu-id="80601-311">If this isn't possible in your app, you might not want to enable offline support.</span></span>
