---
title: Routing in ASP.NET Core
author: rick-anderson
description: Erfahren Sie, wie das ASP.NET Core-Routing für das Abgleichen von HTTP-Anforderungen und das Verteilen an ausführbare Endpunkte eingesetzt wird.
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 3/25/2020
uid: fundamentals/routing
ms.openlocfilehash: 2ebba716de90f142a66cf7619b5a4b0c77684bd4
ms.sourcegitcommit: 0c62042d7d030ec5296c73bccd9f9b961d84496a
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 03/25/2020
ms.locfileid: "80270445"
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="76246-103">Routing in ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="76246-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="76246-104">Von [Ryan Nowak](https://github.com/rynowak), [Kirk Larkin](https://twitter.com/serpent5) und [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="76246-104">By [Ryan Nowak](https://github.com/rynowak), [Kirk Larkin](https://twitter.com/serpent5), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="76246-105">Das Routing wird für das Abgleichen von HTTP-Anforderungen und das Verteilen an ausführbare Endpunkte der App eingesetzt.</span><span class="sxs-lookup"><span data-stu-id="76246-105">Routing is responsible for matching incoming HTTP requests and dispatching those requests to the app's executable endpoints.</span></span> <span data-ttu-id="76246-106">[Endpunkte](#endpoint) sind die Einheiten des ausführbaren Codes für die Anforderungsverarbeitung in der App.</span><span class="sxs-lookup"><span data-stu-id="76246-106">[Endpoints](#endpoint) are the app's units of executable request-handling code.</span></span> <span data-ttu-id="76246-107">Endpunkte werden in der App definiert und beim Start der App konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="76246-107">Endpoints are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="76246-108">Beim Endpunktabgleich können Werte aus der Anforderungs-URL extrahiert und für die Verarbeitung der Anforderung bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-108">The endpoint matching process can extract values from the request's URL and provide those values for request processing.</span></span> <span data-ttu-id="76246-109">Mithilfe von Endpunktinformationen aus der App lassen sich durch das Routing URLs generieren, die Endpunkten zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-109">Using endpoint information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="76246-110">Apps können das Routing mit folgenden Funktionen konfigurieren:</span><span class="sxs-lookup"><span data-stu-id="76246-110">Apps can configure routing using:</span></span>

- <span data-ttu-id="76246-111">Controller</span><span class="sxs-lookup"><span data-stu-id="76246-111">Controllers</span></span>
- <span data-ttu-id="76246-112">Razor Pages</span><span class="sxs-lookup"><span data-stu-id="76246-112">Razor Pages</span></span>
- <span data-ttu-id="76246-113">SignalR</span><span class="sxs-lookup"><span data-stu-id="76246-113">SignalR</span></span>
- <span data-ttu-id="76246-114">gRPC-Dienste</span><span class="sxs-lookup"><span data-stu-id="76246-114">gRPC Services</span></span>
- <span data-ttu-id="76246-115">Endpunktfähige [Middleware](xref:fundamentals/middleware/index) wie [Integritätsprüfungen](xref:host-and-deploy/health-checks)</span><span class="sxs-lookup"><span data-stu-id="76246-115">Endpoint-enabled [middleware](xref:fundamentals/middleware/index) such as [Health Checks](xref:host-and-deploy/health-checks).</span></span>
- <span data-ttu-id="76246-116">Für das Routing registrierte Delegate und Lambdas</span><span class="sxs-lookup"><span data-stu-id="76246-116">Delegates and lambdas registered with routing.</span></span>

<span data-ttu-id="76246-117">In diesem Artikel werden die grundlegenden Details zum ASP.NET Core-Routing beschrieben.</span><span class="sxs-lookup"><span data-stu-id="76246-117">This document covers low-level details of ASP.NET Core routing.</span></span> <span data-ttu-id="76246-118">Informationen zur Routingkonfiguration finden Sie wie folgt:</span><span class="sxs-lookup"><span data-stu-id="76246-118">For information on configuring routing:</span></span>

* <span data-ttu-id="76246-119">Für Controller unter <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="76246-119">For controllers, see <xref:mvc/controllers/routing>.</span></span>
* <span data-ttu-id="76246-120">Für Razor Pages-Konventionen unter <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="76246-120">For Razor Pages conventions, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="76246-121">Das in diesem Dokument beschriebene Endpunktroutingsystem gilt für ASP.NET Core 3.0 und höher.</span><span class="sxs-lookup"><span data-stu-id="76246-121">The endpoint routing system described in this document applies to ASP.NET Core 3.0 and later.</span></span> <span data-ttu-id="76246-122">Weitere Informationen zum vorherigen Routingsystem, das auf <xref:Microsoft.AspNetCore.Routing.IRouter> basiert, erhalten Sie, wenn Sie die ASP.NET Core 2.1-Version wie folgt auswählen:</span><span class="sxs-lookup"><span data-stu-id="76246-122">For information on the previous routing system based on <xref:Microsoft.AspNetCore.Routing.IRouter>, select the ASP.NET Core 2.1 version using one of the following approaches:</span></span>

* <span data-ttu-id="76246-123">Mit der Versionsauswahl für eine vorherige Version.</span><span class="sxs-lookup"><span data-stu-id="76246-123">The version selector for a previous version.</span></span>
* <span data-ttu-id="76246-124">Mit Auswahl von [ASP.NET Core 2.1](https://docs.microsoft.com/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="76246-124">Select [ASP.NET Core 2.1 routing](https://docs.microsoft.com/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

<span data-ttu-id="76246-125">[Anzeigen oder Herunterladen von Beispielcode](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) ([Vorgehensweise zum Herunterladen](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="76246-125">[View or download sample code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) ([how to download](xref:index#how-to-download-a-sample))</span></span>

<span data-ttu-id="76246-126">Die Downloadbeispiele für dieses Dokument werden durch eine bestimmte `Startup`-Klasse aktiviert.</span><span class="sxs-lookup"><span data-stu-id="76246-126">The download samples for this document are enabled by a specific `Startup` class.</span></span> <span data-ttu-id="76246-127">Um ein bestimmtes Beispiel auszuführen, ändern Sie *Program.cs*, um die gewünschte `Startup`-Klasse aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="76246-127">To run a specific sample, modify *Program.cs* to call the desired `Startup` class.</span></span>

## <a name="routing-basics"></a><span data-ttu-id="76246-128">Routinggrundlagen</span><span class="sxs-lookup"><span data-stu-id="76246-128">Routing basics</span></span>

<span data-ttu-id="76246-129">Alle ASP.NET Core-Vorlagen enthalten die Routingfunktionen im generierten Code.</span><span class="sxs-lookup"><span data-stu-id="76246-129">All ASP.NET Core templates include routing in the generated code.</span></span> <span data-ttu-id="76246-130">Das Routing wird in `Startup.Configure` in der [Middlewarepipeline](xref:fundamentals/middleware/index) registriert.</span><span class="sxs-lookup"><span data-stu-id="76246-130">Routing is registered in the [middleware](xref:fundamentals/middleware/index) pipeline in `Startup.Configure`.</span></span>

<span data-ttu-id="76246-131">Der folgende Code veranschaulicht ein einfaches Beispiel für das Routing:</span><span class="sxs-lookup"><span data-stu-id="76246-131">The following code shows a basic example of routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet&highlight=8,10)]

<span data-ttu-id="76246-132">Beim Routing wird ein Middlewarepaar verwendet, das durch <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> und <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> registriert wird:</span><span class="sxs-lookup"><span data-stu-id="76246-132">Routing uses a pair of middleware, registered by <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>:</span></span>

* <span data-ttu-id="76246-133">`UseRouting` fügt der Middlewarepipeline einen Routenabgleich hinzu.</span><span class="sxs-lookup"><span data-stu-id="76246-133">`UseRouting` adds route matching to the middleware pipeline.</span></span> <span data-ttu-id="76246-134">Diese Middleware prüft die in der App definierten Endpunkte und wählt anhand der Anforderung die [beste Übereinstimmung](#urlm) aus.</span><span class="sxs-lookup"><span data-stu-id="76246-134">This middleware looks at the set of endpoints defined in the app, and selects the [best match](#urlm) based on the request.</span></span>
* <span data-ttu-id="76246-135">`UseEndpoints` fügt der Middlewarepipeline die Endpunktausführung hinzu.</span><span class="sxs-lookup"><span data-stu-id="76246-135">`UseEndpoints` adds endpoint execution to the middleware pipeline.</span></span> <span data-ttu-id="76246-136">Dabei wird der mit dem ausgewählten Endpunkt verknüpfte Delegat ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="76246-136">It runs the delegate associated with the selected endpoint.</span></span>

<span data-ttu-id="76246-137">Das vorherige Beispiel enthält eine einzelnen *Route-zu- Code*-Endpunkt unter Verwendung der [MapGet](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*)-Methode:</span><span class="sxs-lookup"><span data-stu-id="76246-137">The preceding example includes a single *route to code* endpoint using the [MapGet](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*) method:</span></span>

* <span data-ttu-id="76246-138">Wenn eine `GET`-HTTP-Anforderung an die Stamm-URL `/`gesendet wird:</span><span class="sxs-lookup"><span data-stu-id="76246-138">When an HTTP `GET` request is sent to the root URL `/`:</span></span>
  * <span data-ttu-id="76246-139">Der angezeigte Anforderungsdelegat wird ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="76246-139">The request delegate shown executes.</span></span>
  * <span data-ttu-id="76246-140">`Hello World!` wird in die HTTP-Antwort geschrieben.</span><span class="sxs-lookup"><span data-stu-id="76246-140">`Hello World!` is written to the HTTP response.</span></span> <span data-ttu-id="76246-141">Die Stamm-URL `/` lautet standardmäßig `https://localhost:5001/`.</span><span class="sxs-lookup"><span data-stu-id="76246-141">By default, the root URL `/` is `https://localhost:5001/`.</span></span>
* <span data-ttu-id="76246-142">Wenn die Anforderungsmethode nicht `GET` bzw. die Stamm-URL nicht `/` ist, gibt es keinen Routenabgleich und es wird ein HTTP-404-Fehler zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="76246-142">If the request method is not `GET` or the root URL is not `/`, no route matches and an HTTP 404 is returned.</span></span>

### <a name="endpoint"></a><span data-ttu-id="76246-143">Endpunkt</span><span class="sxs-lookup"><span data-stu-id="76246-143">Endpoint</span></span>

<a name="endpoint"></a>

<span data-ttu-id="76246-144">Die `MapGet`-Methode wird verwendet, um einen **Endpunkt** zu definieren.</span><span class="sxs-lookup"><span data-stu-id="76246-144">The `MapGet` method is used to define an **endpoint**.</span></span> <span data-ttu-id="76246-145">Ein Endpunkt kann Folgendes sein:</span><span class="sxs-lookup"><span data-stu-id="76246-145">An endpoint is something that can be:</span></span>

* <span data-ttu-id="76246-146">Ausgewählt, indem die URL und die HTTP-Methode abgeglichen werden.</span><span class="sxs-lookup"><span data-stu-id="76246-146">Selected, by matching the URL and HTTP method.</span></span>
* <span data-ttu-id="76246-147">Ausgeführt, indem ein Delegat ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-147">Executed, by running the delegate.</span></span>

<span data-ttu-id="76246-148">Endpunkte, die von der App zugeordnet und ausgeführt werden können, sind in `UseEndpoints` konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="76246-148">Endpoints that can be matched and executed by the app are configured in `UseEndpoints`.</span></span> <span data-ttu-id="76246-149">Mit <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*> und [ähnlichen Methoden](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) werden beispielsweise Anforderungsdelegate mit dem Routingsystem verbunden.</span><span class="sxs-lookup"><span data-stu-id="76246-149">For example, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>, and [similar methods](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) connect request delegates to the routing system.</span></span>
<span data-ttu-id="76246-150">Zudem können weitere Methoden zur Verbindung von ASP.NET Core-Frameworkfunktionen mit dem Routingsystem verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="76246-150">Additional methods can be used to connect ASP.NET Core framework features to the routing system:</span></span>
- [<span data-ttu-id="76246-151">MapRazorPages für Razor Pages</span><span class="sxs-lookup"><span data-stu-id="76246-151">MapRazorPages for Razor Pages</span></span>](xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*)
- [<span data-ttu-id="76246-152">MapControllers für Controller</span><span class="sxs-lookup"><span data-stu-id="76246-152">MapControllers for controllers</span></span>](xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllers*)
- [<span data-ttu-id="76246-153">MapHub\<THub> für SignalR</span><span class="sxs-lookup"><span data-stu-id="76246-153">MapHub\<THub> for SignalR</span></span>](xref:Microsoft.AspNetCore.SignalR.HubRouteBuilder.MapHub*) 
- [<span data-ttu-id="76246-154">MapGrpcService\<TService> für gRPC</span><span class="sxs-lookup"><span data-stu-id="76246-154">MapGrpcService\<TService> for gRPC</span></span>](xref:grpc/aspnetcore)

<span data-ttu-id="76246-155">Das folgende Beispiel zeigt das Routing mit einer anspruchsvolleren Routenvorlage:</span><span class="sxs-lookup"><span data-stu-id="76246-155">The following example shows routing with a more sophisticated route template:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/RouteTemplateStartup.cs?name=snippet)]

<span data-ttu-id="76246-156">Die Zeichenfolge `/hello/{name:alpha}` ist eine **Routenvorlage**.</span><span class="sxs-lookup"><span data-stu-id="76246-156">The string `/hello/{name:alpha}` is a **route template**.</span></span> <span data-ttu-id="76246-157">Sie wird verwendet, um zu konfigurieren, wie der Endpunkt abgeglichen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-157">It is used to configure how the endpoint is matched.</span></span> <span data-ttu-id="76246-158">In diesem Fall gleicht die Vorlage Folgendes ab:</span><span class="sxs-lookup"><span data-stu-id="76246-158">In this case, the template matches:</span></span>

* <span data-ttu-id="76246-159">Eine URL wie `/hello/Ryan`</span><span class="sxs-lookup"><span data-stu-id="76246-159">A URL like `/hello/Ryan`</span></span>
* <span data-ttu-id="76246-160">Alle URL-Pfade, die mit `/hello/` beginnen, gefolgt von einer Sequenz alphabetischer Zeichen.</span><span class="sxs-lookup"><span data-stu-id="76246-160">Any URL path that begins with `/hello/` followed by a sequence of alphabetic characters.</span></span>  <span data-ttu-id="76246-161">`:alpha` wendet eine Routeneinschränkung an, die nur alphabetische Zeichen abgleicht.</span><span class="sxs-lookup"><span data-stu-id="76246-161">`:alpha` applies a route constraint that matches only alphabetic characters.</span></span> <span data-ttu-id="76246-162">[Routeneinschränkungen](#route-constraint-reference) werden weiter unten in diesem Dokument erläutert.</span><span class="sxs-lookup"><span data-stu-id="76246-162">[Route constraints](#route-constraint-reference) are explained later in this document.</span></span>

<span data-ttu-id="76246-163">Das zweite Segment des URL-Pfads, `{name:alpha}`:</span><span class="sxs-lookup"><span data-stu-id="76246-163">The second segment of the URL path, `{name:alpha}`:</span></span>

* <span data-ttu-id="76246-164">Ist an den Parameter `name` gebunden.</span><span class="sxs-lookup"><span data-stu-id="76246-164">Is bound to the `name` parameter.</span></span>
* <span data-ttu-id="76246-165">Ist in [HttpRequest.RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*) erfasst und gespeichert.</span><span class="sxs-lookup"><span data-stu-id="76246-165">Is captured and stored in [HttpRequest.RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*).</span></span>

<span data-ttu-id="76246-166">Das in diesem Dokument beschriebene Endpunktroutingsystem gilt ab ASP.NET Core 3.0.</span><span class="sxs-lookup"><span data-stu-id="76246-166">The endpoint routing system described in this document is new as of ASP.NET Core 3.0.</span></span> <span data-ttu-id="76246-167">Alle Versionen von ASP.NET Core unterstützen jedoch dieselben Routenvorlagenfunktionen und Routeneinschränkungen.</span><span class="sxs-lookup"><span data-stu-id="76246-167">However, all versions of ASP.NET Core support the same set of route template features and route constraints.</span></span>

<span data-ttu-id="76246-168">Das folgende Beispiel zeigt das Routing mit [Integritätsprüfungen](xref:host-and-deploy/health-checks) und Autorisierung:</span><span class="sxs-lookup"><span data-stu-id="76246-168">The following example shows routing with [health checks](xref:host-and-deploy/health-checks) and authorization:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

[!INCLUDE[request localized comments](~/includes/code-comments-loc.md)]

<span data-ttu-id="76246-169">Im vorherigen Beispiel wird veranschaulicht, wie Sie:</span><span class="sxs-lookup"><span data-stu-id="76246-169">The preceding example demonstrates how:</span></span>

* <span data-ttu-id="76246-170">Die Autorisierungsmiddleware für das Routing verwenden.</span><span class="sxs-lookup"><span data-stu-id="76246-170">The authorization middleware can be used with routing.</span></span>
* <span data-ttu-id="76246-171">Endpunkte zum Konfigurieren des Autorisierungsverhaltens verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="76246-171">Endpoints can be used to configure authorization behavior.</span></span>

<span data-ttu-id="76246-172">Der <xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*>-Aufruf fügt einen Endpunkt für eine Integritätsprüfung hinzu.</span><span class="sxs-lookup"><span data-stu-id="76246-172">The <xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*> call adds a health check endpoint.</span></span> <span data-ttu-id="76246-173">Durch die Verkettung von <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> mit diesem Aufruf wird eine Autorisierungsrichtlinie an den Endpunkt angefügt.</span><span class="sxs-lookup"><span data-stu-id="76246-173">Chaining <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> on to this call attaches an authorization policy to the endpoint.</span></span>

<span data-ttu-id="76246-174">Der Aufruf von <xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> und <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> wird die Authentifizierungs- und Autorisierungsmiddleware hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="76246-174">Calling <xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> and <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> adds the authentication and authorization middleware.</span></span> <span data-ttu-id="76246-175">Diese Middleware wird zum Ausführen folgender Aktionen zwischen <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> und `UseEndpoints` platziert:</span><span class="sxs-lookup"><span data-stu-id="76246-175">These middleware are placed between <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and `UseEndpoints` so that they can:</span></span>

* <span data-ttu-id="76246-176">Anzeigen des von `UseRouting` ausgewählten Endpunkts.</span><span class="sxs-lookup"><span data-stu-id="76246-176">See which endpoint was selected by `UseRouting`.</span></span>
* <span data-ttu-id="76246-177">Anwenden einer Autorisierungsrichtlinie vor dem Senden von <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> an den Endpunkt.</span><span class="sxs-lookup"><span data-stu-id="76246-177">Apply an authorization policy before <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> dispatches to the endpoint.</span></span>

<a name="metadata"></a>

### <a name="endpoint-metadata"></a><span data-ttu-id="76246-178">Endpunktmetadaten</span><span class="sxs-lookup"><span data-stu-id="76246-178">Endpoint metadata</span></span>

<span data-ttu-id="76246-179">Im vorangehenden Beispiel gibt es zwei Endpunkte, aber nur dem für die Integritätsprüfung ist eine Autorisierungsrichtlinie angefügt.</span><span class="sxs-lookup"><span data-stu-id="76246-179">In the preceding example, there are two endpoints, but only the health check endpoint has an authorization policy attached.</span></span> <span data-ttu-id="76246-180">Wenn die Anforderung mit dem Endpunkt der Integritätsprüfung, `/healthz`, übereinstimmt, wird eine Autorisierungsprüfung durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="76246-180">If the request matches the health check endpoint, `/healthz`, an authorization check is performed.</span></span> <span data-ttu-id="76246-181">Dadurch wird veranschaulicht, dass Endpunkten zusätzliche Daten zugeordnet werden können.</span><span class="sxs-lookup"><span data-stu-id="76246-181">This demonstrates that endpoints can have extra data attached to them.</span></span> <span data-ttu-id="76246-182">Diese zusätzlichen Daten werden als **Metadaten** des Endpunkts bezeichnet:</span><span class="sxs-lookup"><span data-stu-id="76246-182">This extra data is called endpoint **metadata**:</span></span>

* <span data-ttu-id="76246-183">Die Metadaten lassen sich von routingfähiger Middleware verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="76246-183">The metadata can be processed by routing-aware middleware.</span></span>
* <span data-ttu-id="76246-184">Die Metadaten können einen beliebigen .NET-Typ aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-184">The metadata can be of any .NET type.</span></span>

## <a name="routing-concepts"></a><span data-ttu-id="76246-185">Routingkonzepte</span><span class="sxs-lookup"><span data-stu-id="76246-185">Routing concepts</span></span>

<span data-ttu-id="76246-186">Durch Hinzufügen des effizienten **Endpunkt**-Konzepts stellt das Routingsystem eine Ergänzung der Middlewarepipeline dar.</span><span class="sxs-lookup"><span data-stu-id="76246-186">The routing system builds on top of the middleware pipeline by adding the powerful **endpoint** concept.</span></span> <span data-ttu-id="76246-187">Endpunkte stehen für Funktionseinheiten der App, die sich in Bezug auf Routing, Autorisierung und die Anzahl der ASP.NET Core-Systeme voneinander unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="76246-187">Endpoints represent units of the app's functionality that are distinct from each other in terms of routing, authorization, and any number of ASP.NET Core's systems.</span></span>

<a name="endpoint"></a>

### <a name="aspnet-core-endpoint-definition"></a><span data-ttu-id="76246-188">ASP.NET Core-Endpunktdefinition</span><span class="sxs-lookup"><span data-stu-id="76246-188">ASP.NET Core endpoint definition</span></span>

<span data-ttu-id="76246-189">Ein ASP.NET Core-Endpunkt ist:</span><span class="sxs-lookup"><span data-stu-id="76246-189">An ASP.NET Core endpoint is:</span></span>

* <span data-ttu-id="76246-190">Ausführbar: Verfügt über eine <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="76246-190">Executable: Has a <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>.</span></span>
* <span data-ttu-id="76246-191">Erweiterbar: Verfügt über eine [Metadata](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*)-Sammlung.</span><span class="sxs-lookup"><span data-stu-id="76246-191">Extensible: Has a [Metadata](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*) collection.</span></span>
* <span data-ttu-id="76246-192">Auswählbar: Verfügt optional über [Routinginformationen](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span><span class="sxs-lookup"><span data-stu-id="76246-192">Selectable: Optionally, has [routing information](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span></span>
* <span data-ttu-id="76246-193">Aufzählbar: Die Sammlung von Endpunkten kann durch Abrufen der <xref:Microsoft.AspNetCore.Routing.EndpointDataSource>-Klasse aus [DI](xref:fundamentals/dependency-injection) aufgelistet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-193">Enumerable: The collection of endpoints can be listed by retrieving the <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> from [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="76246-194">Der folgende Code zeigt, wie der Endpunkt, der mit der aktuellen Anforderung übereinstimmt, abgerufen und geprüft werden kann:</span><span class="sxs-lookup"><span data-stu-id="76246-194">The following code shows how to retrieve and inspect the endpoint matching the current request:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/EndpointInspectorStartup.cs?name=snippet)]

<span data-ttu-id="76246-195">Der Endpunkt, falls ausgewählt, kann aus dem `HttpContext`-Element abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="76246-195">The endpoint, if selected, can be retrieved from the `HttpContext`.</span></span> <span data-ttu-id="76246-196">Seine Eigenschaften können geprüft werden.</span><span class="sxs-lookup"><span data-stu-id="76246-196">Its properties can be inspected.</span></span> <span data-ttu-id="76246-197">Endpunktobjekte sind unveränderlich und können nach der Erstellung nicht mehr geändert werden.</span><span class="sxs-lookup"><span data-stu-id="76246-197">Endpoint objects are immutable and cannot be modified after creation.</span></span> <span data-ttu-id="76246-198">Der häufigste Typ des Endpunkts ist eine <xref:Microsoft.AspNetCore.Routing.RouteEndpoint>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="76246-198">The most common type of endpoint is a <xref:Microsoft.AspNetCore.Routing.RouteEndpoint>.</span></span> <span data-ttu-id="76246-199">Die `RouteEndpoint`-Klasse enthält Informationen, durch die diese vom Routingsystem ausgewählt werden kann.</span><span class="sxs-lookup"><span data-stu-id="76246-199">`RouteEndpoint` includes information that allows it to be to selected by the routing system.</span></span>

<span data-ttu-id="76246-200">Im vorangehenden Code wird mit [app.Use](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) eine [Middleware](xref:fundamentals/middleware/index) inline konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="76246-200">In the preceding code, [app.Use](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) configures an in-line [middleware](xref:fundamentals/middleware/index).</span></span>

<a name="mt"></a>

<span data-ttu-id="76246-201">Der folgende Code zeigt, dass es, je nachdem, wo `app.Use` in der Pipeline aufgerufen wird, möglicherweise keinen Endpunkt gibt:</span><span class="sxs-lookup"><span data-stu-id="76246-201">The following code shows that, depending on where `app.Use` is called in the pipeline, there may not be an endpoint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/MiddlewareFlowStartup.cs?name=snippet)]

<span data-ttu-id="76246-202">In diesem vorangehenden Beispiel werden `Console.WriteLine`-Anweisungen hinzugefügt, die anzeigen, ob ein Endpunkt ausgewählt wurde oder nicht.</span><span class="sxs-lookup"><span data-stu-id="76246-202">This preceding sample adds `Console.WriteLine` statements that display whether or not an endpoint has been selected.</span></span> <span data-ttu-id="76246-203">Aus Gründen der Übersichtlichkeit wird in dem Beispiel dem bereitgestellten `/`-Endpunkt ein Anzeigename zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="76246-203">For clarity, the sample assigns a display name to the provided `/` endpoint.</span></span>

<span data-ttu-id="76246-204">Wenn Sie diesen Code mit einer URL `/` ausführen, wird Folgendes angezeigt:</span><span class="sxs-lookup"><span data-stu-id="76246-204">Running this code with a URL of `/` displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: Hello
3. Endpoint: Hello
```

<span data-ttu-id="76246-205">Wenn Sie diesen Code mit einer anderen URL ausführen, wird Folgendes angezeigt:</span><span class="sxs-lookup"><span data-stu-id="76246-205">Running this code with any other URL displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: (null)
4. Endpoint: (null)
```

<span data-ttu-id="76246-206">Diese Ausgabe zeigt Folgendes:</span><span class="sxs-lookup"><span data-stu-id="76246-206">This output demonstrates that:</span></span>

* <span data-ttu-id="76246-207">Der Endpunkt ist immer NULL, bevor `UseRouting` aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-207">The endpoint is always null before `UseRouting` is called.</span></span>
* <span data-ttu-id="76246-208">Wenn eine Übereinstimmung gefunden wird, ist der Endpunkt zwischen `UseRouting` und <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> ungleich NULL.</span><span class="sxs-lookup"><span data-stu-id="76246-208">If a match is found, the endpoint is non-null between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="76246-209">Die `UseEndpoints`-Middleware ist eine **Terminalmiddleware**, wenn eine Übereinstimmung gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="76246-209">The `UseEndpoints` middleware is **terminal** when a match is found.</span></span> <span data-ttu-id="76246-210">[Terminalmiddleware](#tm) wird weiter unten in diesem Dokument definiert.</span><span class="sxs-lookup"><span data-stu-id="76246-210">[Terminal middleware](#tm) is defined later in this document.</span></span>
* <span data-ttu-id="76246-211">Die Middleware nach `UseEndpoints` wird nur ausgeführt, wenn keine Übereinstimmung gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="76246-211">The middleware after `UseEndpoints` execute only when no match is found.</span></span>

<span data-ttu-id="76246-212">Die `UseRouting`-Middleware verwendet die [SetEndpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*)-Methode, um den Endpunkt an den aktuellen Kontext anzufügen.</span><span class="sxs-lookup"><span data-stu-id="76246-212">The `UseRouting` middleware uses the [SetEndpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*) method to attach the endpoint to the current context.</span></span> <span data-ttu-id="76246-213">Es ist möglich, die `UseRouting`-Middleware durch benutzerdefinierte Logik zu ersetzen und dennoch die Vorteile durch die Verwendung von Endpunkten zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="76246-213">It's possible to replace the `UseRouting` middleware with custom logic and still get the benefits of using endpoints.</span></span> <span data-ttu-id="76246-214">Endpunkte befinden sich auf niedriger Ebene, wie Middleware, und sind nicht an die Routingimplementierung gekoppelt.</span><span class="sxs-lookup"><span data-stu-id="76246-214">Endpoints are a low-level primitive like middleware, and aren't coupled to the routing implementation.</span></span> <span data-ttu-id="76246-215">Die meisten Apps müssen `UseRouting` nicht durch eigene Logik ersetzen.</span><span class="sxs-lookup"><span data-stu-id="76246-215">Most apps don't need to replace `UseRouting` with custom logic.</span></span>

<span data-ttu-id="76246-216">Die `UseEndpoints`-Middleware ist so konzipiert, dass Sie zusammen mit der `UseRouting`-Middleware verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="76246-216">The `UseEndpoints` middleware is designed to be used in tandem with the `UseRouting` middleware.</span></span> <span data-ttu-id="76246-217">Die Hauptlogik zum Ausführen eines Endpunkts ist nicht kompliziert.</span><span class="sxs-lookup"><span data-stu-id="76246-217">The core logic to execute an endpoint isn't complicated.</span></span> <span data-ttu-id="76246-218">Mit <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> können Sie einen Endpunkt abrufen und dann dessen <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>-Eigenschaft aufrufen.</span><span class="sxs-lookup"><span data-stu-id="76246-218">Use <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> to retrieve the endpoint, and then invoke its <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate> property.</span></span>

<span data-ttu-id="76246-219">Der folgende Code veranschaulicht, wie Middleware das Routing beeinflussen oder darauf reagieren kann:</span><span class="sxs-lookup"><span data-stu-id="76246-219">The following code demonstrates how middleware can influence or react to routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/IntegratedMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="76246-220">Im vorherigen Beispiel werden zwei wichtige Konzepte dargestellt:</span><span class="sxs-lookup"><span data-stu-id="76246-220">The preceding example demonstrates two important concepts:</span></span>

* <span data-ttu-id="76246-221">Die Middleware kann vor `UseRouting` ausgeführt werden, um die Daten zu ändern, auf denen das Routing basiert.</span><span class="sxs-lookup"><span data-stu-id="76246-221">Middleware can run before `UseRouting` to modify the data that routing operates upon.</span></span>
    * <span data-ttu-id="76246-222">Normalerweise verändert Middleware, die vor dem Routing eingesetzt wird, eine Eigenschaft der Anforderung, wie z.B. <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*>, <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*> oder <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*>.</span><span class="sxs-lookup"><span data-stu-id="76246-222">Usually middleware that appears before routing modifies some property of the request, such as <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*>, <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*>, or <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*>.</span></span>
* <span data-ttu-id="76246-223">Die Middleware kann zwischen `UseRouting` und <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> ausgeführt werden, um die Ergebnisse des Routings vor der Ausführung des Endpunkts zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="76246-223">Middleware can run between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> to process the results of routing before the endpoint is executed.</span></span>
    * <span data-ttu-id="76246-224">Middleware, die zwischen `UseRouting` und `UseEndpoints` ausgeführt wird:</span><span class="sxs-lookup"><span data-stu-id="76246-224">Middleware that runs between `UseRouting` and `UseEndpoints`:</span></span>
      * <span data-ttu-id="76246-225">Überprüft in der Regel die Metadaten, um die Endpunkte zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="76246-225">Usually inspects metadata to understand the endpoints.</span></span>
      * <span data-ttu-id="76246-226">Trifft häufig Sicherheitsentscheidungen, wie `UseAuthorization` und `UseCors`.</span><span class="sxs-lookup"><span data-stu-id="76246-226">Often makes security decisions, as done by `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="76246-227">Durch die Kombination aus Middleware und Metadaten ist es möglich, für jeden einzelnen Endpunkt Richtlinien zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="76246-227">The combination of middleware and metadata allows configuring policies per-endpoint.</span></span>

<span data-ttu-id="76246-228">Der vorangehende Code zeigt ein Beispiel für eine benutzerdefinierte Middleware, die entpunktbezogene Richtlinien unterstützt.</span><span class="sxs-lookup"><span data-stu-id="76246-228">The preceding code shows an example of a custom middleware that supports per-endpoint policies.</span></span> <span data-ttu-id="76246-229">Die Middleware schreibt ein *Überwachungsprotokoll* für den Zugriff auf vertrauliche Daten in der Konsole.</span><span class="sxs-lookup"><span data-stu-id="76246-229">The middleware writes an *audit log* of access to sensitive data to the console.</span></span> <span data-ttu-id="76246-230">Die Middleware kann so konfiguriert werden, dass ein Endpunkt mit den `AuditPolicyAttribute`-Metadaten *überwacht* wird.</span><span class="sxs-lookup"><span data-stu-id="76246-230">The middleware can be configured to *audit* an endpoint with the `AuditPolicyAttribute` metadata.</span></span> <span data-ttu-id="76246-231">In diesem Beispiel wird ein *Opt-In*-Muster veranschaulicht, bei dem nur Endpunkte überwacht werden, die als vertraulich markiert sind.</span><span class="sxs-lookup"><span data-stu-id="76246-231">This sample demonstrates an *opt-in* pattern where only endpoints that are marked as sensitive are audited.</span></span> <span data-ttu-id="76246-232">Es ist möglich, diese Logik umgekehrt zu definieren, indem beispielsweise alles geprüft wird, was nicht als sicher markiert ist.</span><span class="sxs-lookup"><span data-stu-id="76246-232">It's possible to define this logic in reverse, auditing everything that isn't marked as safe, for example.</span></span> <span data-ttu-id="76246-233">Das Endpunktmetadaten-System ist flexibel.</span><span class="sxs-lookup"><span data-stu-id="76246-233">The endpoint metadata system is flexible.</span></span> <span data-ttu-id="76246-234">Diese Logik lässt sich für jeden Anwendungsfall passend schreiben.</span><span class="sxs-lookup"><span data-stu-id="76246-234">This logic could be designed in whatever way suits the use case.</span></span>

<span data-ttu-id="76246-235">Der vorherige Beispielcode soll die grundlegenden Konzepte von Endpunkten veranschaulichen.</span><span class="sxs-lookup"><span data-stu-id="76246-235">The preceding sample code is intended to demonstrate the basic concepts of endpoints.</span></span> <span data-ttu-id="76246-236">**Das Beispiel ist nicht für Produktionsumgebungen vorgesehen.**</span><span class="sxs-lookup"><span data-stu-id="76246-236">**The sample is not intended for production use**.</span></span> <span data-ttu-id="76246-237">Eine vollständigere Version einer Middleware für *Überwachungsprotokolle* würde Folgendes bieten:</span><span class="sxs-lookup"><span data-stu-id="76246-237">A more complete version of an *audit log* middleware would:</span></span>

* <span data-ttu-id="76246-238">Protokollieren in einer Datei oder einer Datenbank.</span><span class="sxs-lookup"><span data-stu-id="76246-238">Log to a file or database.</span></span>
* <span data-ttu-id="76246-239">Einschließen von Details wie Benutzer, IP-Adresse, Name des vertraulichen Endpunkts usw.</span><span class="sxs-lookup"><span data-stu-id="76246-239">Include details such as the user, IP address, name of the sensitive endpoint, and more.</span></span>

<span data-ttu-id="76246-240">Die Metadaten der Überwachungsrichtlinie `AuditPolicyAttribute` sind als `Attribute` definiert, um die Verwendung mit klassenbasierten Frameworks wie Controllern und SignalR zu erleichtern.</span><span class="sxs-lookup"><span data-stu-id="76246-240">The audit policy metadata `AuditPolicyAttribute` is defined as an `Attribute` for easier use with class-based frameworks such as controllers and SignalR.</span></span> <span data-ttu-id="76246-241">Bei Verwendung von *Route-zu-Code*:</span><span class="sxs-lookup"><span data-stu-id="76246-241">When using *route to code*:</span></span>

* <span data-ttu-id="76246-242">Metadaten werden an eine Generator-API angefügt.</span><span class="sxs-lookup"><span data-stu-id="76246-242">Metadata is attached with a builder API.</span></span>
* <span data-ttu-id="76246-243">Klassenbasierte Frameworks enthalten beim Erstellen von Endpunkten alle Attribute der entsprechenden Methode und Klasse.</span><span class="sxs-lookup"><span data-stu-id="76246-243">Class-based frameworks include all attributes on the corresponding method and class when creating endpoints.</span></span>

<span data-ttu-id="76246-244">Die bewährten Methoden für Metadatentypen sind, sie entweder als Schnittstellen oder als Attribute zu definieren.</span><span class="sxs-lookup"><span data-stu-id="76246-244">The best practices for metadata types are to define them either as interfaces or attributes.</span></span> <span data-ttu-id="76246-245">Schnittstellen und Attribute ermöglichen die Wiederverwendung von Code.</span><span class="sxs-lookup"><span data-stu-id="76246-245">Interfaces and attributes allow code reuse.</span></span> <span data-ttu-id="76246-246">Das Metadatensystem ist flexibel und weist keine Einschränkungen auf.</span><span class="sxs-lookup"><span data-stu-id="76246-246">The metadata system is flexible and doesn't impose any limitations.</span></span>

<a name="tm"></a>

### <a name="comparing-a-terminal-middleware-and-routing"></a><span data-ttu-id="76246-247">Vergleichen von Terminalmiddleware und Routing</span><span class="sxs-lookup"><span data-stu-id="76246-247">Comparing a terminal middleware and routing</span></span>

<span data-ttu-id="76246-248">Das folgende Codebeispiel zeigt den Unterschied zwischen Middleware und Routing:</span><span class="sxs-lookup"><span data-stu-id="76246-248">The following code sample contrasts using middleware with using routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/TerminalMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="76246-249">Beim in `Approach 1:` gezeigten Stil von Middleware handelt es sich um **Terminalmiddleware**.</span><span class="sxs-lookup"><span data-stu-id="76246-249">The style of middleware shown with `Approach 1:` is **terminal middleware**.</span></span> <span data-ttu-id="76246-250">Sie wird als Terminalmiddleware bezeichnet, da sie einen Abgleich durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="76246-250">It's called terminal middleware because it does a matching operation:</span></span>

* <span data-ttu-id="76246-251">Der Abgleich im vorangehenden Beispiel ist `Path == "/"` für die Middleware und `Path == "/Movie"` für das Routing.</span><span class="sxs-lookup"><span data-stu-id="76246-251">The matching operation in the preceding sample is `Path == "/"` for the middleware and `Path == "/Movie"` for routing.</span></span>
* <span data-ttu-id="76246-252">Bei einem erfolgreichen Abgleich führt sie bestimmte Funktionen aus und kehrt zurück, anstatt die `next`-Middleware aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="76246-252">When a match is successful, it executes some functionality and returns, rather than invoking the `next` middleware.</span></span>

<span data-ttu-id="76246-253">Sie wird Terminalmiddleware genannt, da Sie die Suche beendet, einige Funktionen ausführt und dann zurückkehrt.</span><span class="sxs-lookup"><span data-stu-id="76246-253">It's called terminal middleware middleware because it terminates the search, executes some functionality, and then returns.</span></span>

<span data-ttu-id="76246-254">Vergleichen von Terminalmiddleware und Routing:</span><span class="sxs-lookup"><span data-stu-id="76246-254">Comparing a terminal middleware and routing:</span></span>
* <span data-ttu-id="76246-255">Beide Ansätze ermöglichen das Beenden der Verarbeitungspipeline:</span><span class="sxs-lookup"><span data-stu-id="76246-255">Both approaches allow terminating the processing pipeline:</span></span>
    * <span data-ttu-id="76246-256">Die Middleware beendet die Pipeline, indem Sie zurückkehrt, anstatt `next` aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="76246-256">Middleware terminates the pipeline by returning rather than invoking `next`.</span></span>
    * <span data-ttu-id="76246-257">Endpunkte beenden immer die Verarbeitung.</span><span class="sxs-lookup"><span data-stu-id="76246-257">Endpoints are always terminal.</span></span>
* <span data-ttu-id="76246-258">Terminalmiddleware ermöglicht die Positionierung der Middleware an einer beliebigen Stelle in der Pipeline:</span><span class="sxs-lookup"><span data-stu-id="76246-258">Terminal middleware allows positioning the middleware at an arbitrary place in the pipeline:</span></span>
    * <span data-ttu-id="76246-259">Endpunkte werden an der Position von <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="76246-259">Endpoints execute at the position of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="76246-260">Mit Terminalmiddleware kann beliebiger Code beendet werden, wenn die Middleware übereinstimmt:</span><span class="sxs-lookup"><span data-stu-id="76246-260">Terminal middleware allows arbitrary code to determine when the middleware matches:</span></span>
    * <span data-ttu-id="76246-261">Ein benutzerdefinierter Routenabgleichscode kann sehr umständlich und schwierig zu schreiben sein.</span><span class="sxs-lookup"><span data-stu-id="76246-261">Custom route matching code can be verbose and difficult to write correctly.</span></span>
    * <span data-ttu-id="76246-262">Das Routing bietet unkomplizierte Lösungen für typische Apps.</span><span class="sxs-lookup"><span data-stu-id="76246-262">Routing provides straightforward solutions for typical apps.</span></span> <span data-ttu-id="76246-263">Die meisten Apps erfordern keinen benutzerdefinierten Routenabgleichscode.</span><span class="sxs-lookup"><span data-stu-id="76246-263">Most apps don't require custom route matching code.</span></span>
* <span data-ttu-id="76246-264">Endpunkte haben eine Schnittstelle mit Middleware wie `UseAuthorization` und `UseCors`.</span><span class="sxs-lookup"><span data-stu-id="76246-264">Endpoints interface with middleware such as `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="76246-265">Die Verwendung einer Terminalmiddleware mit `UseAuthorization` oder `UseCors` erfordert eine manuelle Verknüpfung mit dem Autorisierungssystem.</span><span class="sxs-lookup"><span data-stu-id="76246-265">Using a terminal middleware with `UseAuthorization` or `UseCors` requires manual interfacing with the authorization system.</span></span>

<span data-ttu-id="76246-266">Ein [Endpunkt](#endpoint) definiert beides:</span><span class="sxs-lookup"><span data-stu-id="76246-266">An [endpoint](#endpoint) defines both:</span></span>

* <span data-ttu-id="76246-267">Einen Delegaten zum Verarbeiten von Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="76246-267">A delegate to process requests.</span></span>
* <span data-ttu-id="76246-268">Eine Sammlung beliebiger Metadaten.</span><span class="sxs-lookup"><span data-stu-id="76246-268">A collection of arbitrary metadata.</span></span> <span data-ttu-id="76246-269">Die Metadaten werden zur Implementierung von übergreifenden Belangen verwendet, die auf Richtlinien und der Konfiguration basieren, die den einzelnen Endpunkten angefügt sind.</span><span class="sxs-lookup"><span data-stu-id="76246-269">The metadata is used to implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="76246-270">Terminalmiddleware kann sehr nützlich sein, erfordert aber möglicherweise auch:</span><span class="sxs-lookup"><span data-stu-id="76246-270">Terminal middleware can be an effective tool, but can require:</span></span>

* <span data-ttu-id="76246-271">Einen großen Codierungs- und Testaufwand.</span><span class="sxs-lookup"><span data-stu-id="76246-271">A significant amount of coding and testing.</span></span>
* <span data-ttu-id="76246-272">Eine manuelle Integration in andere Systeme für die gewünschte Flexibilität.</span><span class="sxs-lookup"><span data-stu-id="76246-272">Manual integration with other systems to achieve the desired level of flexibility.</span></span>

<span data-ttu-id="76246-273">Ziehen Sie daher zunächst die Integration von Routingfunktionen in Betracht, bevor Sie damit beginnen, Terminalmiddleware zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="76246-273">Consider integrating with routing before writing a terminal middleware.</span></span>

<span data-ttu-id="76246-274">Vorhandene Terminalmiddleware, die in [Map](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) oder <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> integriert ist, kann in der Regel in einen routingfähigen Endpunkt umgewandelt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-274">Existing terminal middleware that integrates with [Map](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) or <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> can usually be turned into a routing aware endpoint.</span></span> <span data-ttu-id="76246-275">[MapHealthChecks](https://github.com/aspnet/AspNetCore/blob/master/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) zeigt das Muster für eine Routinglösung:</span><span class="sxs-lookup"><span data-stu-id="76246-275">[MapHealthChecks](https://github.com/aspnet/AspNetCore/blob/master/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) demonstrates the pattern for router-ware:</span></span>
* <span data-ttu-id="76246-276">Schreiben Sie eine Erweiterungsmethode in der <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="76246-276">Write an extension method on <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span>
* <span data-ttu-id="76246-277">Erstellen Sie eine geschachtelte Middlewarepipeline mit <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*>.</span><span class="sxs-lookup"><span data-stu-id="76246-277">Create a nested middleware pipeline using <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*>.</span></span>
* <span data-ttu-id="76246-278">Fügen Sie die Middleware an die neue Pipeline an.</span><span class="sxs-lookup"><span data-stu-id="76246-278">Attach the middleware to the new pipeline.</span></span> <span data-ttu-id="76246-279">In diesem Fall <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*>.</span><span class="sxs-lookup"><span data-stu-id="76246-279">In this case, <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*>.</span></span>
* <span data-ttu-id="76246-280">Verwenden Sie <xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*>, um die Middlewarepipeline in einem <xref:Microsoft.AspNetCore.Http.RequestDelegate>-Delegaten zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="76246-280"><xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*> the middleware pipeline into a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span>
* <span data-ttu-id="76246-281">Rufen Sie `Map` auf, und stellen Sie die neue Middlewarepipeline bereit.</span><span class="sxs-lookup"><span data-stu-id="76246-281">Call `Map` and provide the new middleware pipeline.</span></span>
* <span data-ttu-id="76246-282">Geben Sie das Generatorobjekt zurück, das von `Map` aus der Erweiterungsmethode bereitgestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="76246-282">Return the builder object provided by `Map` from the extension method.</span></span>

<span data-ttu-id="76246-283">Im folgenden Code ist die Verwendung von [MapHealthChecks](xref:host-and-deploy/health-checks) gezeigt:</span><span class="sxs-lookup"><span data-stu-id="76246-283">The following code shows use of [MapHealthChecks](xref:host-and-deploy/health-checks):</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

<span data-ttu-id="76246-284">Das vorangehende Beispiel zeigt, warum das Zurückgeben des Generatorobjekts wichtig ist.</span><span class="sxs-lookup"><span data-stu-id="76246-284">The preceding sample shows why returning the builder object is important.</span></span> <span data-ttu-id="76246-285">Wenn das Generatorobjekt zurückgegeben wird, kann der App-Entwickler Richtlinien konfigurieren, z. B. die Autorisierung für den Endpunkt.</span><span class="sxs-lookup"><span data-stu-id="76246-285">Returning the builder object allows the app developer to configure policies such as authorization for the endpoint.</span></span> <span data-ttu-id="76246-286">In diesem Beispiel ist die Middleware für Integritätsprüfungen nicht direkt in das Autorisierungssystem integriert.</span><span class="sxs-lookup"><span data-stu-id="76246-286">In this example, the health checks middleware has no direct integration with the authorization system.</span></span>

<span data-ttu-id="76246-287">Das Metadatensystem wurde als Antwort auf die Probleme erstellt, die von Erweiterbarkeitsautoren mithilfe von Terminalmiddleware aufgetreten sind.</span><span class="sxs-lookup"><span data-stu-id="76246-287">The metadata system was created in response to the problems encountered by extensibility authors using terminal middleware.</span></span> <span data-ttu-id="76246-288">Für jede Middleware ist es problematisch, deren eigene Integration in das Autorisierungssystem umzusetzen.</span><span class="sxs-lookup"><span data-stu-id="76246-288">It's problematic for each middleware to implement its own integration with the authorization system.</span></span>

<a name="urlm"></a>

### <a name="url-matching"></a><span data-ttu-id="76246-289">URL-Zuordnung</span><span class="sxs-lookup"><span data-stu-id="76246-289">URL matching</span></span>

* <span data-ttu-id="76246-290">Bei diesem Prozess werden eingehende Anforderungen durch Routing mit einem [Endpunkt](#endpoint) abgeglichen.</span><span class="sxs-lookup"><span data-stu-id="76246-290">Is the process by which routing matches an incoming request to an [endpoint](#endpoint).</span></span>
* <span data-ttu-id="76246-291">Basiert auf Daten im URL-Pfad und den URL-Headern.</span><span class="sxs-lookup"><span data-stu-id="76246-291">Is based on data in the URL path and headers.</span></span>
* <span data-ttu-id="76246-292">Kann erweitert werden, um beliebige Daten in der Anforderung zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="76246-292">Can be extended to consider any data in the request.</span></span>

<span data-ttu-id="76246-293">Wenn eine Routingmiddleware ausgeführt wird, legt sie ein `Endpoint`-Element fest und leitet Werte an eine [Anforderungsfunktion](xref:fundamentals/request-features) in der <xref:Microsoft.AspNetCore.Http.HttpContext>-Klasse der aktuellen Anforderung weiter:</span><span class="sxs-lookup"><span data-stu-id="76246-293">When a routing middleware executes, it sets an `Endpoint` and route values to a [request feature](xref:fundamentals/request-features) on the <xref:Microsoft.AspNetCore.Http.HttpContext> from the current request:</span></span>

* <span data-ttu-id="76246-294">Durch Aufrufen von [HttpContext.GetEndPoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) wird der Endpunkt abgerufen.</span><span class="sxs-lookup"><span data-stu-id="76246-294">Calling [HttpContext.GetEndpoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) gets the endpoint.</span></span>
* <span data-ttu-id="76246-295">`HttpRequest.RouteValues` ruft die Sammlung der Routenwerte ab.</span><span class="sxs-lookup"><span data-stu-id="76246-295">`HttpRequest.RouteValues` gets the collection of route values.</span></span>

<span data-ttu-id="76246-296">[Middleware](xref:fundamentals/middleware/index), die nach der Routingmiddleware ausgeführt wird, kann den Endpunkt erkennen und Maßnahmen ergreifen.</span><span class="sxs-lookup"><span data-stu-id="76246-296">[Middleware](xref:fundamentals/middleware/index) running after the routing middleware can inspect the endpoint and take action.</span></span> <span data-ttu-id="76246-297">So kann beispielsweise eine Autorisierungsmiddleware die Erfassung der Metadaten des Endpunkts für eine Autorisierungsrichtlinie abfragen.</span><span class="sxs-lookup"><span data-stu-id="76246-297">For example, an authorization middleware can interrogate the endpoint's metadata collection for an authorization policy.</span></span> <span data-ttu-id="76246-298">Nachdem die gesamte Middleware in der Anforderungsverarbeitungspipeline ausgeführt wurde, wird der Delegat des ausgewählten Endpunkts aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="76246-298">After all of the middleware in the request processing pipeline is executed, the selected endpoint's delegate is invoked.</span></span>

<span data-ttu-id="76246-299">Das Routingsystem ist beim Endpunktrouting für alle Weiterleitungsentscheidungen zuständig.</span><span class="sxs-lookup"><span data-stu-id="76246-299">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="76246-300">Da die Middleware Richtlinien auf der Grundlage des ausgewählten Endpunkts anwendet, ist Folgendes wichtig:</span><span class="sxs-lookup"><span data-stu-id="76246-300">Because the middleware applies policies based on the selected endpoint, it's important that:</span></span>

* <span data-ttu-id="76246-301">Alle Entscheidungen, die sich auf die Verteilung oder die Anwendung von Sicherheitsrichtlinien auswirken können, werden im Routingsystem getroffen.</span><span class="sxs-lookup"><span data-stu-id="76246-301">Any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

> [!WARNING]
> <span data-ttu-id="76246-302">Wenn für Abwärtskompatibilität ein Controller- oder Razor Pages-Endpunktdelegat ausgeführt wird, werden die Eigenschaften von [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) auf Grundlage der bisher verarbeiteten Anforderungen auf entsprechende Werte festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-302">For backwards-compatibility, when a Controller or Razor Pages endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>
>
> <span data-ttu-id="76246-303">Der Typ `RouteContext` wird in einer zukünftigen Version als veraltet markiert:</span><span class="sxs-lookup"><span data-stu-id="76246-303">The `RouteContext` type will be marked obsolete in a future release:</span></span>
>
> * <span data-ttu-id="76246-304">Migrieren Sie `RouteData.Values` zu `HttpRequest.RouteValues`.</span><span class="sxs-lookup"><span data-stu-id="76246-304">Migrate `RouteData.Values` to `HttpRequest.RouteValues`.</span></span>
> * <span data-ttu-id="76246-305">Migrieren Sie `RouteData.DataTokens`, um [IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) aus den Endpunktmetadaten abzurufen.</span><span class="sxs-lookup"><span data-stu-id="76246-305">Migrate `RouteData.DataTokens` to retrieve [IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) from the endpoint metadata.</span></span>

<span data-ttu-id="76246-306">Der URL-Abgleich erfolgt in mehreren Phasen und kann konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="76246-306">URL matching operates in a configurable set of phases.</span></span> <span data-ttu-id="76246-307">In jeder Phase werden mehrere Übereinstimmungen ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="76246-307">In each phase, the output is a set of matches.</span></span> <span data-ttu-id="76246-308">Diese Übereinstimmungen lassen sich in der nächsten Phase weiter eingrenzen.</span><span class="sxs-lookup"><span data-stu-id="76246-308">The set of matches can be narrowed down further by the next phase.</span></span> <span data-ttu-id="76246-309">Die Routingimplementierung garantiert keine Verarbeitungsreihenfolge für übereinstimmende Endpunkte.</span><span class="sxs-lookup"><span data-stu-id="76246-309">The routing implementation does not guarantee a processing order for matching endpoints.</span></span> <span data-ttu-id="76246-310">**Alle** möglichen Übereinstimmungen werden gleichzeitig verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="76246-310">**All** possible matches are processed at once.</span></span> <span data-ttu-id="76246-311">Für die URL-Abgleichsphasen gilt folgende Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="76246-311">The URL matching phases occur in the following order.</span></span> <span data-ttu-id="76246-312">ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="76246-312">ASP.NET Core:</span></span>

1. <span data-ttu-id="76246-313">Verarbeitet den URL-Pfad mit mehreren Endpunkten und ihren Routenvorlagen und sammelt **alle** Übereinstimmungen.</span><span class="sxs-lookup"><span data-stu-id="76246-313">Processes the URL path against the set of endpoints and their route templates, collecting **all** of the matches.</span></span>
1. <span data-ttu-id="76246-314">Nimmt die vorangehende Liste und entfernt die Übereinstimmungen, die nicht zu den angewendeten Routeneinschränkungen passen.</span><span class="sxs-lookup"><span data-stu-id="76246-314">Takes the preceding list and removes matches that fail with route constraints applied.</span></span>
1. <span data-ttu-id="76246-315">Nimmt die vorangehende Liste und entfernt die Übereinstimmungen, die nicht zu den [MatcherPolicy](xref:Microsoft.AspNetCore.Routing.MatcherPolicy)-Instanzen passen.</span><span class="sxs-lookup"><span data-stu-id="76246-315">Takes the preceding list and removes matches that fail the set of [MatcherPolicy](xref:Microsoft.AspNetCore.Routing.MatcherPolicy) instances.</span></span>
1. <span data-ttu-id="76246-316">Verwendet [EndpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector), um eine abschließende Entscheidung anhand der vorangehenden Liste zu treffen.</span><span class="sxs-lookup"><span data-stu-id="76246-316">Uses the [EndpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector) to make a final decision from the preceding list.</span></span>

<span data-ttu-id="76246-317">Die Liste der Endpunkte wird entsprechend den folgenden Punkten priorisiert:</span><span class="sxs-lookup"><span data-stu-id="76246-317">The list of endpoints is prioritized according to:</span></span>

* <span data-ttu-id="76246-318">Die [RouteEndpoint.Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="76246-318">The [RouteEndpoint.Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)</span></span>
* <span data-ttu-id="76246-319">Die [Priorität der Routenvorlage](#rtp)</span><span class="sxs-lookup"><span data-stu-id="76246-319">The [route template precedence](#rtp)</span></span>

<span data-ttu-id="76246-320">Alle übereinstimmenden Endpunkte werden in jeder Phase verarbeitet, bis <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector> erreicht ist.</span><span class="sxs-lookup"><span data-stu-id="76246-320">All matching endpoints are processed in each phase until the <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector> is reached.</span></span> <span data-ttu-id="76246-321">`EndpointSelector` stellt die abschließende Phase dar.</span><span class="sxs-lookup"><span data-stu-id="76246-321">The `EndpointSelector` is the final phase.</span></span> <span data-ttu-id="76246-322">Darin wird der Endpunkt mit der höchsten Priorität aus den Übereinstimmungen als beste Übereinstimmung ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="76246-322">It chooses the highest priority endpoint from the matches as the best match.</span></span> <span data-ttu-id="76246-323">Wenn es andere Übereinstimmungen mit derselben Priorität wie die beste Übereinstimmung gibt, wird ein Ausnahmefehler wegen einer nicht eindeutigen Übereinstimmung ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="76246-323">If there are other matches with the same priority as the best match, an ambiguous match exception is thrown.</span></span>

<span data-ttu-id="76246-324">Die Routenpriorität wird anhand einer **spezifischeren** Routenvorlage berechnet, der eine höhere Priorität eingeräumt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-324">The route precedence is computed based on a **more specific** route template being given a higher priority.</span></span> <span data-ttu-id="76246-325">Dies wird z. B. anhand der Vorlagen `/hello` und `/{message}` deutlich:</span><span class="sxs-lookup"><span data-stu-id="76246-325">For example, consider the templates `/hello` and `/{message}`:</span></span>

* <span data-ttu-id="76246-326">Beide stimmen mit dem URL-Pfad `/hello` überein.</span><span class="sxs-lookup"><span data-stu-id="76246-326">Both match the URL path `/hello`.</span></span>
* <span data-ttu-id="76246-327">`/hello` ist spezifischer und hat daher eine höhere Priorität.</span><span class="sxs-lookup"><span data-stu-id="76246-327">`/hello`  is more specific and therefore higher priority.</span></span>

<span data-ttu-id="76246-328">Im Allgemeinen eignet sich die Routenpriorität gut, um die beste Übereinstimmung für die in der Praxis verwendeten URL-Schemata zu finden.</span><span class="sxs-lookup"><span data-stu-id="76246-328">In general, route precedence does a good job of choosing the best match for the kinds of URL schemes used in practice.</span></span> <span data-ttu-id="76246-329">Verwenden Sie <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> nur bei Bedarf, um eine Mehrdeutigkeit zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="76246-329">Use <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> only when necessary to avoid an ambiguity.</span></span>

<span data-ttu-id="76246-330">Aufgrund der Erweiterungsmöglichkeiten, die das Routing bietet, kann das Routingsystem die mehrdeutigen Routen nicht im Voraus berechnen.</span><span class="sxs-lookup"><span data-stu-id="76246-330">Due to the kinds of extensibility provided by routing, it isn't possible for the routing system to compute ahead of time the ambiguous routes.</span></span> <span data-ttu-id="76246-331">Betrachten Sie ein Beispiel wie die Routenvorlagen `/{message:alpha}` und `/{message:int}`:</span><span class="sxs-lookup"><span data-stu-id="76246-331">Consider an example such as the route templates `/{message:alpha}` and `/{message:int}`:</span></span>

* <span data-ttu-id="76246-332">Die `alpha`-Einschränkung gleicht nur alphabetische Zeichen ab.</span><span class="sxs-lookup"><span data-stu-id="76246-332">The `alpha` constraint matches only alphabetic characters.</span></span>
* <span data-ttu-id="76246-333">Die `int`-Einschränkung gleicht nur Zahlen ab.</span><span class="sxs-lookup"><span data-stu-id="76246-333">The `int` constraint matches only numbers.</span></span>
* <span data-ttu-id="76246-334">Diese Vorlagen haben die gleiche Routenpriorität, aber es gibt keine einzige URL, auf die sie beide zutreffen.</span><span class="sxs-lookup"><span data-stu-id="76246-334">These templates have the same route precedence, but there's no single URL they both match.</span></span>
* <span data-ttu-id="76246-335">Wenn das Routingsystem beim Starten einen Mehrdeutigkeitsfehler gemeldet hat, würde dieser den gültigen Anwendungsfall blockieren.</span><span class="sxs-lookup"><span data-stu-id="76246-335">If the routing system reported an ambiguity error at startup, it would block this valid use case.</span></span>

> [!WARNING]
>
> <span data-ttu-id="76246-336">Die Reihenfolge der Vorgänge in <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> wirkt sich nicht auf das Routingverhalten aus, mit einer Ausnahme.</span><span class="sxs-lookup"><span data-stu-id="76246-336">The order of operations inside <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> doesn't influence the behavior of routing, with one exception.</span></span> <span data-ttu-id="76246-337"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> und <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> weisen ihren Endpunkten automatisch einen Reihenfolgenwert zu, basierend auf der Reihenfolge, in der sie aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="76246-337"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> and <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> automatically assign an order value to their endpoints based on the order they are invoked.</span></span> <span data-ttu-id="76246-338">Dadurch wird das Langzeitverhalten von Controllern simuliert, ohne dass das Routingsystem die gleichen Garantien bietet wie ältere Routingimplementierungen.</span><span class="sxs-lookup"><span data-stu-id="76246-338">This simulates long-time behavior of controllers without the routing system providing the same guarantees as older routing implementations.</span></span>
>
> <span data-ttu-id="76246-339">Bei der bisherigen Routingimplementierung war es möglich, eine Routingerweiterung vorzunehmen, die von der Verarbeitungsreihenfolge der Routen abhängt.</span><span class="sxs-lookup"><span data-stu-id="76246-339">In the legacy implementation of routing, it's possible to implement routing extensibility that has a dependency on the order in which routes are processed.</span></span> <span data-ttu-id="76246-340">Endpunktrouting in ASP.NET Core 3.0 und höher:</span><span class="sxs-lookup"><span data-stu-id="76246-340">Endpoint routing in ASP.NET Core 3.0 and later:</span></span>
> 
> * <span data-ttu-id="76246-341">Weist kein Konzept für Routen auf.</span><span class="sxs-lookup"><span data-stu-id="76246-341">Doesn't have a concept of routes.</span></span>
> * <span data-ttu-id="76246-342">Bietet keine garantierte Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="76246-342">Doesn't provide ordering guarantees.</span></span> <span data-ttu-id="76246-343">Alle Endpunkte werden gleichzeitig verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="76246-343">All endpoints are processed at once.</span></span>
>
> <span data-ttu-id="76246-344">Wenn dies bedeutet, dass Sie mit dem Legacy-Routingsystem nicht weiterkommen, [öffnen Sie ein GitHub-Problem zur Unterstützung](https://github.com/dotnet/aspnetcore/issues).</span><span class="sxs-lookup"><span data-stu-id="76246-344">If this means you're stuck using the legacy routing system, [open a GitHub issue for assistance](https://github.com/dotnet/aspnetcore/issues).</span></span>

<a name="rtp"></a>

### <a name="route-template-precedence-and-endpoint-selection-order"></a><span data-ttu-id="76246-345">Routenvorlagenpriorität und Reihenfolge der Endpunktauswahl</span><span class="sxs-lookup"><span data-stu-id="76246-345">Route template precedence and endpoint selection order</span></span>

<span data-ttu-id="76246-346">Die [Routenvorlagenpriorität](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) ist ein System, bei dem jeder Routenvorlage ein Wert zugewiesen wird, je nachdem, wie spezifisch diese ist.</span><span class="sxs-lookup"><span data-stu-id="76246-346">[Route template precedence](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) is a system that assigns each route template a value based on how specific it is.</span></span> <span data-ttu-id="76246-347">Routenvorlagenpriorität:</span><span class="sxs-lookup"><span data-stu-id="76246-347">Route template precedence:</span></span>

* <span data-ttu-id="76246-348">Verhindert, dass die Reihenfolge der Endpunkte häufig angepasst werden muss.</span><span class="sxs-lookup"><span data-stu-id="76246-348">Avoids the need to adjust the order of endpoints in common cases.</span></span>
* <span data-ttu-id="76246-349">Versucht, die allgemeinen Erwartungen an das Routingverhalten abzugleichen.</span><span class="sxs-lookup"><span data-stu-id="76246-349">Attempts to match the common-sense expectations of routing behavior.</span></span>

<span data-ttu-id="76246-350">Dies wird z. B. anhand der Vorlagen `/Products/List` und `/Products/{id}` deutlich.</span><span class="sxs-lookup"><span data-stu-id="76246-350">For example, consider templates `/Products/List` and `/Products/{id}`.</span></span> <span data-ttu-id="76246-351">Es wäre begründet, anzunehmen, dass `/Products/List` eine bessere Übereinstimmung als `/Products/{id}` für den URL-Pfad `/Products/List` ist.</span><span class="sxs-lookup"><span data-stu-id="76246-351">It would be reasonable to assume that `/Products/List` is a better match than `/Products/{id}` for the URL path `/Products/List`.</span></span> <span data-ttu-id="76246-352">Dies funktioniert, weil das Literalsegment `/List` eine höhere Priorität hat als das Parametersegment `/{id}`.</span><span class="sxs-lookup"><span data-stu-id="76246-352">The works because the literal segment `/List` is considered to have better precedence than the parameter segment `/{id}`.</span></span>

<span data-ttu-id="76246-353">Wie die Priorisierung im Einzelnen funktioniert, ist an die Definition der Routenvorlagen gekoppelt:</span><span class="sxs-lookup"><span data-stu-id="76246-353">The details of how precedence works are coupled to how route templates are defined:</span></span>

* <span data-ttu-id="76246-354">Vorlagen mit mehr Segmenten sind in der Regel spezifischer.</span><span class="sxs-lookup"><span data-stu-id="76246-354">Templates with more segments are considered more specific.</span></span>
* <span data-ttu-id="76246-355">Ein Segment mit Literaltext gilt als spezifischer als ein Parametersegment.</span><span class="sxs-lookup"><span data-stu-id="76246-355">A segment with literal text is considered more specific than a parameter segment.</span></span>
* <span data-ttu-id="76246-356">Ein Parametersegment mit einer Einschränkung gilt als spezifischer als ein Parametersegment ohne Einschränkung.</span><span class="sxs-lookup"><span data-stu-id="76246-356">A parameter segment with a constraint is considered more specific than one without.</span></span>
* <span data-ttu-id="76246-357">Ein komplexes Segment wird als genauso spezifisch betrachtet wie ein Parametersegment mit einer Einschränkung.</span><span class="sxs-lookup"><span data-stu-id="76246-357">A complex segment is considered as specific as a parameter segment with a constraint.</span></span>
* <span data-ttu-id="76246-358">Erfassen Sie alle Parameter, die am wenigsten spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="76246-358">Catch all parameters are the least specific.</span></span>

<span data-ttu-id="76246-359">Einen Verweis auf genaue Werte finden Sie im [Quellcode auf GitHub](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L189).</span><span class="sxs-lookup"><span data-stu-id="76246-359">See the [source code on GitHub](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L189) for a reference of exact values.</span></span>

<a name="lg"></a>

### <a name="url-generation-concepts"></a><span data-ttu-id="76246-360">Konzepte zur URL-Generierung</span><span class="sxs-lookup"><span data-stu-id="76246-360">URL generation concepts</span></span>

<span data-ttu-id="76246-361">URL-Generierung:</span><span class="sxs-lookup"><span data-stu-id="76246-361">URL generation:</span></span>

* <span data-ttu-id="76246-362">Der Prozess, bei dem durch Routing ein URL-Pfad basierend auf mehreren Routenwerten erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-362">Is the process by which routing can create a URL path based on a set of route values.</span></span>
* <span data-ttu-id="76246-363">Sie ermöglicht eine logische Trennung zwischen den Endpunkten und den URLs, die auf diese zugreifen.</span><span class="sxs-lookup"><span data-stu-id="76246-363">Allows for a logical separation between endpoints and the URLs that access them.</span></span>

<span data-ttu-id="76246-364">Das Endpunktrouting umfasst die API zur Linkgenerierung (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span><span class="sxs-lookup"><span data-stu-id="76246-364">Endpoint routing includes the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API.</span></span> <span data-ttu-id="76246-365">`LinkGenerator` ist ein Singleton-Dienst, der in [DI](xref:fundamentals/dependency-injection) verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="76246-365">`LinkGenerator` is a singleton service available from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="76246-366">Die `LinkGenerator`-API kann außerhalb des Kontexts einer ausgeführten Anforderung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-366">The `LinkGenerator` API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="76246-367">[Mvc.IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) und Szenarios, die von <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> abhängig sind (z. B. [Taghilfsprogramme](xref:mvc/views/tag-helpers/intro), HTML-Hilfsprogramme und [Aktionsergebnisse](xref:mvc/controllers/actions)), verwenden die `LinkGenerator`-API, um entsprechende Funktionen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="76246-367">[Mvc.IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the `LinkGenerator` API internally to provide link generating capabilities.</span></span>

<span data-ttu-id="76246-368">Die API zur Linkgenerierung wird von Konzepten wie **Adressen** und **Adressschemas** unterstützt.</span><span class="sxs-lookup"><span data-stu-id="76246-368">The link generator is backed by the concept of an **address** and **address schemes**.</span></span> <span data-ttu-id="76246-369">Sie können mithilfe eines Adressschemas die Endpunkte bestimmen, die bei der Linkgenerierung berücksichtigt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="76246-369">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="76246-370">Beispielsweise werden Routennamen und Routenwerte als Adressschemas implementiert. Diese Szenarios kennen viele Benutzer von Controllern und Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="76246-370">For example, the route name and route values scenarios many users are familiar with from controllers and Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="76246-371">Die API zur Linkgenerierung kann Controller und Razor Pages über die folgenden Erweiterungsmethoden miteinander verknüpfen:</span><span class="sxs-lookup"><span data-stu-id="76246-371">The link generator can link to controllers and Razor Pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="76246-372">Beim Überladen dieser Methoden werden Argumente akzeptiert, die den `HttpContext` umfassen.</span><span class="sxs-lookup"><span data-stu-id="76246-372">Overloads of these methods accept arguments that include the `HttpContext`.</span></span> <span data-ttu-id="76246-373">Diese Methoden sind zwar in funktionaler Hinsicht äquivalent zu [Url.Action](xref:System.Web.Mvc.UrlHelper.Action*) und [Url.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), bieten aber zusätzliche Flexibilität und Optionen.</span><span class="sxs-lookup"><span data-stu-id="76246-373">These methods are functionally equivalent to [Url.Action](xref:System.Web.Mvc.UrlHelper.Action*) and [Url.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), but offer additional flexibility and options.</span></span>

<span data-ttu-id="76246-374">Die `GetPath*`-Methoden sind `Url.Action` und `Url.Page` in der Hinsicht ähnlich, dass sie einen URI mit einem absoluten Pfad generieren.</span><span class="sxs-lookup"><span data-stu-id="76246-374">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page`, in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="76246-375">Die `GetUri*`-Methoden generieren immer einen absoluten URI mit einem Schema und einem Host.</span><span class="sxs-lookup"><span data-stu-id="76246-375">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="76246-376">Die Methoden, die einen `HttpContext` akzeptieren, generieren im Kontext der ausgeführten Anforderung einen URI.</span><span class="sxs-lookup"><span data-stu-id="76246-376">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="76246-377">Die [Umgebungsroutenwerte](#ambient), der URL-basierte Pfad, das Schema und der Host von der ausführenden Anforderung werden so lange verwendet, bis sie außer Kraft gesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-377">The [ambient](#ambient) route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="76246-378"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> wird mit einer Adresse aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="76246-378"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="76246-379">Ein URI wird in zwei Schritten generiert:</span><span class="sxs-lookup"><span data-stu-id="76246-379">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="76246-380">Eine Adresse wird an eine Liste von Endpunkten gebunden, die der Adresse zugeordnet werden können.</span><span class="sxs-lookup"><span data-stu-id="76246-380">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="76246-381">Jedes <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> eines Endpunkts wird bewertet, bis ein Routenmuster gefunden wird, das den angegebenen Werten zugeordnet werden kann.</span><span class="sxs-lookup"><span data-stu-id="76246-381">Each endpoint's <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="76246-382">Die daraus resultierende Ausgabe wird mit URI-Teilen kombiniert, die für die API zur Linkgenerierung bereitgestellt wird, und zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="76246-382">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="76246-383">Die von <xref:Microsoft.AspNetCore.Routing.LinkGenerator> bereitgestellten Methoden unterstützen die Standardfunktionen zur Generierung von Links für jeden beliebigen Adresstypen.</span><span class="sxs-lookup"><span data-stu-id="76246-383">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="76246-384">Am praktischsten ist es, die API zur Linkgenerierung mit Erweiterungsmethoden zu verwenden, die Vorgänge für einen bestimmten Adresstypen ausführen:</span><span class="sxs-lookup"><span data-stu-id="76246-384">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type:</span></span>

| <span data-ttu-id="76246-385">Erweiterungsmethode</span><span class="sxs-lookup"><span data-stu-id="76246-385">Extension Method</span></span> | <span data-ttu-id="76246-386">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="76246-386">Description</span></span> |
| ---------------- | ----------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="76246-387">Generiert einen URI mit einem absoluten Pfad, der auf den angegebenen Werten basiert.</span><span class="sxs-lookup"><span data-stu-id="76246-387">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="76246-388">Generiert einen absoluten URI, der auf den angegebenen Werten basiert.</span><span class="sxs-lookup"><span data-stu-id="76246-388">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="76246-389">Beachten Sie die folgenden Implikationen zum Aufrufen von <xref:Microsoft.AspNetCore.Routing.LinkGenerator>-Methoden:</span><span class="sxs-lookup"><span data-stu-id="76246-389">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="76246-390">Verwenden Sie `GetUri*`-Erweiterungsmethoden in App-Konfigurationen, die den `Host`-Header von eingehenden Anforderungen nicht überprüfen, mit Bedacht.</span><span class="sxs-lookup"><span data-stu-id="76246-390">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="76246-391">Wenn der `Host`-Header von eingehenden Anforderungen nicht überprüft wird, können nicht vertrauenswürdige Anforderungseingaben zurück an den Client in URIs einer Ansicht bzw. Seite zurückgesendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-391">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view or page.</span></span> <span data-ttu-id="76246-392">Es wird empfohlen, dass alle Produktions-Apps ihren Server so konfigurieren, dass der `Host`-Header auf bekannte gültige Werte überprüft wird.</span><span class="sxs-lookup"><span data-stu-id="76246-392">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="76246-393">Verwenden Sie <xref:Microsoft.AspNetCore.Routing.LinkGenerator> in Kombination mit `Map` oder `MapWhen` in Middleware mit Bedacht.</span><span class="sxs-lookup"><span data-stu-id="76246-393">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="76246-394">`Map*` ändert den Basispfad der ausgeführten Anforderung. Dies beeinflusst die Ausgabe der Linkgenerierung.</span><span class="sxs-lookup"><span data-stu-id="76246-394">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="76246-395">Für alle <xref:Microsoft.AspNetCore.Routing.LinkGenerator>-APIs ist die Angabe eines Basispfads zulässig.</span><span class="sxs-lookup"><span data-stu-id="76246-395">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="76246-396">Geben Sie einen leeren Basispfad an, um die Auswirkungen von `Map*` auf die Linkgenerierung rückgängig zu machen.</span><span class="sxs-lookup"><span data-stu-id="76246-396">Specify an empty base path to undo the `Map*` affect on link generation.</span></span>

### <a name="middleware-example"></a><span data-ttu-id="76246-397">Middlewarebeispiel</span><span class="sxs-lookup"><span data-stu-id="76246-397">Middleware example</span></span>

<span data-ttu-id="76246-398">Im folgenden Beispiel verwendet eine Middleware die <xref:Microsoft.AspNetCore.Routing.LinkGenerator>-API, um eine Verknüpfung zu einer Aktionsmethode herzustellen, die Speicherprodukte aufführt.</span><span class="sxs-lookup"><span data-stu-id="76246-398">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create a link to an action method that lists store products.</span></span> <span data-ttu-id="76246-399">Sie können für jede beliebige Klasse in einer App die API zur Linkgenerierung verwenden, indem Sie diese in eine Klasse einfügen und `GenerateLink` aufrufen:</span><span class="sxs-lookup"><span data-stu-id="76246-399">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Middleware/ProductsLinkMiddleware.cs?name=snippet)]

<a name="rtr"></a>

## <a name="route-template-reference"></a><span data-ttu-id="76246-400">Referenz für Routenvorlagen</span><span class="sxs-lookup"><span data-stu-id="76246-400">Route template reference</span></span>

<span data-ttu-id="76246-401">Token in `{}` definieren Routenparameter, die beim Abgleich der Route gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="76246-401">Tokens within `{}` define route parameters that are bound if the route is matched.</span></span> <span data-ttu-id="76246-402">In einem Routensegment können mehrere Routenparameter definiert werden, müssen aber durch einen Literalwert getrennt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-402">More than one route parameter can be defined in a route segment, but route parameters  must be separated by a literal value.</span></span> <span data-ttu-id="76246-403">`{controller=Home}{action=Index}` ist z.B. keine gültige Route, da sich zwischen `{controller}` und `{action}` kein Literalwert befindet.</span><span class="sxs-lookup"><span data-stu-id="76246-403">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span>  <span data-ttu-id="76246-404">Routenparameter müssen einen Namen besitzen und können zusätzliche Attribute aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-404">Route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="76246-405">Eine Literalzeichenfolge, die nicht den Routenparametern entspricht (z.B. `{id}`), muss zusammen mit dem Pfadtrennzeichen `/` mit dem URL-Text übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="76246-405">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="76246-406">Beim Abgleich von Text wird nicht zwischen Groß-/Kleinbuchstaben unterschieden, und die Übereinstimmung basiert auf der decodierten Repräsentation des URL-Pfads.</span><span class="sxs-lookup"><span data-stu-id="76246-406">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="76246-407">Damit das Trennzeichen (`{` oder `}`) der Routenparameter-Literalzeichenfolge bei einem Abgleich gefunden wird, muss es doppelt vorhanden sein, was einem Escapezeichen entspricht.</span><span class="sxs-lookup"><span data-stu-id="76246-407">To match a literal route parameter delimiter `{` or `}`, escape the delimiter by repeating the character.</span></span> <span data-ttu-id="76246-408">Beispielsweise `{{` oder `}}`.</span><span class="sxs-lookup"><span data-stu-id="76246-408">For example `{{` or `}}`.</span></span>

<span data-ttu-id="76246-409">Sternchen `*` oder Doppelsternchen `**`:</span><span class="sxs-lookup"><span data-stu-id="76246-409">Asterisk `*` or double asterisk `**`:</span></span>

* <span data-ttu-id="76246-410">Können als Präfix für einen Routenparameter verwendet werden, um eine Bindung zum verbleibenden Teil des URI herzustellen.</span><span class="sxs-lookup"><span data-stu-id="76246-410">Can be used as a prefix to a route parameter to bind to the rest of the URI.</span></span>
* <span data-ttu-id="76246-411">Werden **Catch-All**-Parameter genannt.</span><span class="sxs-lookup"><span data-stu-id="76246-411">Are called a **catch-all** parameters.</span></span> <span data-ttu-id="76246-412">Zum Beispiel `blog/{**slug}`:</span><span class="sxs-lookup"><span data-stu-id="76246-412">For example, `blog/{**slug}`:</span></span>
  * <span data-ttu-id="76246-413">Entspricht einem beliebigen URI, der mit `/blog` beginnt und einem beliebigen Wert folgt.</span><span class="sxs-lookup"><span data-stu-id="76246-413">Matches any URI that starts with `/blog` and has any value following it.</span></span>
  * <span data-ttu-id="76246-414">Der Wert nach `/blog` wird dem [Slug](https://developer.mozilla.org/docs/Glossary/Slug)-Routenwert zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="76246-414">The value following `/blog` is assigned to the [slug](https://developer.mozilla.org/docs/Glossary/Slug) route value.</span></span>

<span data-ttu-id="76246-415">Durch Catch-All-Parameter können auch leere Zeichenfolgen gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="76246-415">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="76246-416">Der Catch-All-Parameter schützt die entsprechenden Zeichen (Escaping), wenn die Route verwendet wird, um eine URL, einschließlich Pfadtrennzeichen (`/`) zu generieren.</span><span class="sxs-lookup"><span data-stu-id="76246-416">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator `/` characters.</span></span> <span data-ttu-id="76246-417">Z.B. generiert die Route `foo/{*path}` mit den Routenwerten `{ path = "my/path" }``foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="76246-417">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="76246-418">Beachten Sie den umgekehrten Schrägstrich mit Escapezeichen.</span><span class="sxs-lookup"><span data-stu-id="76246-418">Note the escaped forward slash.</span></span> <span data-ttu-id="76246-419">Um Trennzeichen für Roundtrips einsetzen zu können, verwenden Sie das Routenparameterpräfix `**`.</span><span class="sxs-lookup"><span data-stu-id="76246-419">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="76246-420">Die Route `foo/{**path}` mit `{ path = "my/path" }` generiert `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="76246-420">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="76246-421">Bei einem URL-Muster, durch das ein Dateiname mit einer optionalen Erweiterung erfasst werden soll, sind noch weitere Aspekte zu berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="76246-421">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="76246-422">Dies wird z.B. anhand der Vorlage `files/{filename}.{ext?}` deutlich.</span><span class="sxs-lookup"><span data-stu-id="76246-422">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="76246-423">Wenn sowohl für `filename` als auch für `ext` Werte vorhanden sind, werden beide Werte angegeben.</span><span class="sxs-lookup"><span data-stu-id="76246-423">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="76246-424">Wenn nur für `filename` ein Wert in der URL vorhanden ist, wird für die Route eine Übereinstimmung ermittelt, da der nachstehende Punkt (`.`) optional ist.</span><span class="sxs-lookup"><span data-stu-id="76246-424">If only a value for `filename` exists in the URL, the route matches because the trailing `.` is  optional.</span></span> <span data-ttu-id="76246-425">Für die folgenden URLs wird eine Übereinstimmung für die Route ermittelt:</span><span class="sxs-lookup"><span data-stu-id="76246-425">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="76246-426">Routenparameter können über mehrere **Standardwerte** verfügen, die nach dem Parameternamen angegeben werden und durch ein Gleichheitszeichen (`=`) voneinander getrennt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-426">Route parameters may have **default values** designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="76246-427">Mit `{controller=Home}` wird beispielsweise `Home` als Standardwert für `controller` definiert.</span><span class="sxs-lookup"><span data-stu-id="76246-427">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="76246-428">Der Standardwert wird verwendet, wenn kein Wert in der Parameter-URL vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="76246-428">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="76246-429">Routenparameter sind optional, wenn am Ende des Parameternamens ein Fragezeichen (`?`) angefügt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-429">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name.</span></span> <span data-ttu-id="76246-430">Beispielsweise `id?`.</span><span class="sxs-lookup"><span data-stu-id="76246-430">For example, `id?`.</span></span> <span data-ttu-id="76246-431">Zwischen optionalen Werten und Standardroutenparametern besteht folgender Unterschied:</span><span class="sxs-lookup"><span data-stu-id="76246-431">The difference between optional values and default route parameters is:</span></span>

* <span data-ttu-id="76246-432">Ein Routenparameter mit einem Standardwert erzeugt immer einen Wert.</span><span class="sxs-lookup"><span data-stu-id="76246-432">A route parameter with a default value always produces a value.</span></span>
* <span data-ttu-id="76246-433">Ein optionaler Parameter hat nur dann einen Wert, wenn ein Wert von der Anforderungs-URL bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-433">An optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="76246-434">Routenparameter können Einschränkungen aufweisen, die mit dem gebundenen Routenwert der URL übereinstimmen müssen.</span><span class="sxs-lookup"><span data-stu-id="76246-434">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="76246-435">Eine Inline-Einschränkung für einen Routenparameter geben Sie an, indem Sie hinter dem Namen des Routenparameters einen Doppelpunkt (`:`) und einen Einschränkungsnamen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="76246-435">Adding `:` and constraint name after the route parameter name specifies an inline constraint on a route parameter.</span></span> <span data-ttu-id="76246-436">Wenn für die Einschränkung Argumente erforderlich sind, werden diese nach dem Einschränkungsnamen in Klammern (`(...)`) eingeschlossen.</span><span class="sxs-lookup"><span data-stu-id="76246-436">If the constraint requires arguments, they're enclosed in parentheses `(...)` after the constraint name.</span></span> <span data-ttu-id="76246-437">Mehrere *Inline-Einschränkungen* können festgelegt werden, indem ein weiterer Doppelpunkt (`:`) und Einschränkungsname hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-437">Multiple *inline constraints* can be specified by appending another `:` and constraint name.</span></span>

<span data-ttu-id="76246-438">Der Einschränkungsname und die Argumente werden dem <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver>-Dienst übergeben, wodurch eine Instanz von <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> für die URL-Verarbeitung erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="76246-438">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="76246-439">In der Routenvorlage `blog/{article:minlength(10)}` wird beispielsweise die Einschränkung `minlength` mit dem Argument `10` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-439">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="76246-440">Weitere Informationen zu Routeneinschränkungen und eine Liste der vom Framework bereitgestellten Einschränkungen finden Sie im Abschnitt [Referenz zu Routeneinschränkungen](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-440">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="76246-441">Routenparameter können darüber hinaus über Parametertransformatoren verfügen.</span><span class="sxs-lookup"><span data-stu-id="76246-441">Route parameters may also have parameter transformers.</span></span> <span data-ttu-id="76246-442">Diese wandeln den Wert eines Parameters beim Generieren von Links um und passen Aktionen und Seiten an URLs an.</span><span class="sxs-lookup"><span data-stu-id="76246-442">Parameter transformers transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="76246-443">Wie Einschränkungen können auch Parametertransformatoren einem Routenparameter inline hinzugefügt werden, indem ein Doppelpunkt (`:`) und der Name des Transformators hinter dem Namen des Routenparameters hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-443">Like constraints, parameter transformers can be added inline to a route parameter by adding a `:` and transformer name after the route parameter name.</span></span> <span data-ttu-id="76246-444">In der Routenvorlage `blog/{article:slugify}` wird beispielsweise der Transformator `slugify` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-444">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="76246-445">Weitere Informationen zu Parametertransformatoren finden Sie im Abschnitt [Parametertransformatorreferenz](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-445">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="76246-446">Die folgende Tabelle enthält Beispielvorlagen für Routen und deren Verhalten:</span><span class="sxs-lookup"><span data-stu-id="76246-446">The following table demonstrates example route templates and their behavior:</span></span>

| <span data-ttu-id="76246-447">Routenvorlage</span><span class="sxs-lookup"><span data-stu-id="76246-447">Route Template</span></span>                           | <span data-ttu-id="76246-448">Beispiel-URI für Übereinstimmung</span><span class="sxs-lookup"><span data-stu-id="76246-448">Example Matching URI</span></span>    | <span data-ttu-id="76246-449">Der Anforderungs-URI&hellip;</span><span class="sxs-lookup"><span data-stu-id="76246-449">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="76246-450">Nur für den Pfad `/hello` wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-450">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="76246-451">Eine Übereinstimmung wird ermittelt, und `Page` wird auf `Home` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-451">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="76246-452">Eine Übereinstimmung wird ermittelt, und `Page` wird auf `Contact` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-452">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="76246-453">Stimmt mit dem `Products`-Controller und der `List`-Aktion überein.</span><span class="sxs-lookup"><span data-stu-id="76246-453">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="76246-454">Stimmt mit dem `Products`-Controller und der `Details`-Aktion (mit `id` auf 123 festgelegt) überein.</span><span class="sxs-lookup"><span data-stu-id="76246-454">Maps to the `Products` controller and  `Details` action with`id` set to 123.</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="76246-455">Stimmt mit dem `Home`-Controller und der `Index`-Methode überein.</span><span class="sxs-lookup"><span data-stu-id="76246-455">Maps to the `Home` controller and `Index` method.</span></span> <span data-ttu-id="76246-456">`id` wird ignoriert.</span><span class="sxs-lookup"><span data-stu-id="76246-456">`id` is ignored.</span></span>        |
| `{controller=Home}/{action=Index}/{id?}` | `/Products`         | <span data-ttu-id="76246-457">Stimmt mit dem `Products`-Controller und der `Index`-Methode überein.</span><span class="sxs-lookup"><span data-stu-id="76246-457">Maps to the `Products` controller and `Index` method.</span></span> <span data-ttu-id="76246-458">`id` wird ignoriert.</span><span class="sxs-lookup"><span data-stu-id="76246-458">`id` is ignored.</span></span>        |

<span data-ttu-id="76246-459">Mit Vorlagen lässt sich Routing besonders leicht durchführen.</span><span class="sxs-lookup"><span data-stu-id="76246-459">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="76246-460">Einschränkungen und Standardwerte können auch außerhalb der Routenvorlage angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="76246-460">Constraints and defaults can also be specified outside the route template.</span></span>

### <a name="complex-segments"></a><span data-ttu-id="76246-461">Komplexe Segmente</span><span class="sxs-lookup"><span data-stu-id="76246-461">Complex segments</span></span>

<span data-ttu-id="76246-462">Komplexe Segmente werden von rechts nach links auf eine [nicht gierige](#greedy) Weise durch entsprechende Literaltrennzeichen verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="76246-462">Complex segments are processed by matching up literal delimiters from right to left in a [non-greedy](#greedy) way.</span></span> <span data-ttu-id="76246-463">Beispielsweise ist `[Route("/a{b}c{d}")]` ein komplexes Segment.</span><span class="sxs-lookup"><span data-stu-id="76246-463">For example, `[Route("/a{b}c{d}")]` is a complex segment.</span></span>
<span data-ttu-id="76246-464">Komplexe Segmente funktionieren auf eine bestimmte Weise, die für eine erfolgreiche Verwendung verstanden werden muss.</span><span class="sxs-lookup"><span data-stu-id="76246-464">Complex segments work in a particular way that must be understood to use them successfully.</span></span> <span data-ttu-id="76246-465">Das Beispiel in diesem Abschnitt zeigt, warum komplexe Segmente nur dann wirklich gut funktionieren, wenn der Trennzeichentext nicht innerhalb der Parameterwerte erscheint.</span><span class="sxs-lookup"><span data-stu-id="76246-465">The example in this section demonstrates why complex segments only really work well when the delimiter text doesn't appear inside the parameter values.</span></span> <span data-ttu-id="76246-466">Für komplexere Fälle ist die Verwendung eines [RegEx](/dotnet/standard/base-types/regular-expressions) und das anschließende manuelle Extrahieren der Werte erforderlich.</span><span class="sxs-lookup"><span data-stu-id="76246-466">Using a [regex](/dotnet/standard/base-types/regular-expressions) and then manually extracting the values is needed for more complex cases.</span></span>

<span data-ttu-id="76246-467">Dies ist eine Zusammenfassung der Schritte, die beim Routing mit der Vorlage `/a{b}c{d}` und dem URL-Pfad `/abcd` ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-467">This is a summary of the steps that routing performs with the template `/a{b}c{d}` and the URL path `/abcd`.</span></span> <span data-ttu-id="76246-468">`|` wird verwendet, um die Funktionsweise des Algorithmus besser zu veranschaulichen:</span><span class="sxs-lookup"><span data-stu-id="76246-468">The `|` is used to help visualize how the algorithm works:</span></span>

* <span data-ttu-id="76246-469">Das erste Literal von rechts nach links ist `c`.</span><span class="sxs-lookup"><span data-stu-id="76246-469">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="76246-470">Daher wird `/abcd` von rechts durchsucht und `/ab|c|d` gefunden.</span><span class="sxs-lookup"><span data-stu-id="76246-470">So `/abcd` is searched from right and finds `/ab|c|d`.</span></span>
* <span data-ttu-id="76246-471">Alles auf der rechten Seite (`d`) ist jetzt mit dem Routenparameter `{d}` abgeglichen.</span><span class="sxs-lookup"><span data-stu-id="76246-471">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="76246-472">Das nächste Literal von rechts nach links ist `a`.</span><span class="sxs-lookup"><span data-stu-id="76246-472">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="76246-473">Also wird `/ab|c|d` dort gesucht, wo die Suche unterbrochen wurde, und dann wird `a` in `/|a|b|c|d` gefunden.</span><span class="sxs-lookup"><span data-stu-id="76246-473">So `/ab|c|d` is searched starting where we left off, then `a` is found `/|a|b|c|d`.</span></span>
* <span data-ttu-id="76246-474">Der Wert auf der rechten Seite (`b`) ist jetzt mit dem Routenparameter `{b}` abgeglichen.</span><span class="sxs-lookup"><span data-stu-id="76246-474">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="76246-475">Es ist kein verbleibender Text und keine verbleibende Routenvorlage vorhanden. Folglich ist dies eine Übereinstimmung.</span><span class="sxs-lookup"><span data-stu-id="76246-475">There is no remaining text and no remaining route template, so this is a match.</span></span>

<span data-ttu-id="76246-476">Nachfolgend ist ein Beispiel für einen negativen Fall mit derselben Vorlage `/a{b}c{d}` und dem URL-Pfad `/aabcd`.</span><span class="sxs-lookup"><span data-stu-id="76246-476">Here's an example of a negative case using the same template `/a{b}c{d}` and the URL path `/aabcd`.</span></span> <span data-ttu-id="76246-477">`|` wird verwendet, um die Funktionsweise des Algorithmus besser zu veranschaulichen:</span><span class="sxs-lookup"><span data-stu-id="76246-477">The `|` is used to help visualize how the algorithm works.</span></span> <span data-ttu-id="76246-478">Bei diesem Fall handelt es sich nicht um eine Übereinstimmung, was durch denselben Algorithmus belegt wird:</span><span class="sxs-lookup"><span data-stu-id="76246-478">This case isn't a match, which is explained by the same algorithm:</span></span>
* <span data-ttu-id="76246-479">Das erste Literal von rechts nach links ist `c`.</span><span class="sxs-lookup"><span data-stu-id="76246-479">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="76246-480">Daher wird `/aabcd` von rechts durchsucht und `/aab|c|d` gefunden.</span><span class="sxs-lookup"><span data-stu-id="76246-480">So `/aabcd` is searched from right and finds `/aab|c|d`.</span></span>
* <span data-ttu-id="76246-481">Alles auf der rechten Seite (`d`) ist jetzt mit dem Routenparameter `{d}` abgeglichen.</span><span class="sxs-lookup"><span data-stu-id="76246-481">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="76246-482">Das nächste Literal von rechts nach links ist `a`.</span><span class="sxs-lookup"><span data-stu-id="76246-482">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="76246-483">Also wird `/aab|c|d` dort gesucht, wo die Suche unterbrochen wurde, und dann wird `a` in `/a|a|b|c|d` gefunden.</span><span class="sxs-lookup"><span data-stu-id="76246-483">So `/aab|c|d` is searched starting where we left off, then `a` is found `/a|a|b|c|d`.</span></span>
* <span data-ttu-id="76246-484">Der Wert auf der rechten Seite (`b`) ist jetzt mit dem Routenparameter `{b}` abgeglichen.</span><span class="sxs-lookup"><span data-stu-id="76246-484">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="76246-485">Zu diesem Zeitpunkt gibt es noch verbleibenden Text `a`, aber es gibt keine Routenvorlage mehr, die der Algorithmus analysieren kann, weshalb dies keine Übereinstimmung ist.</span><span class="sxs-lookup"><span data-stu-id="76246-485">At this point there is remaining text `a`, but the algorithm has run out of route template to parse, so this is not a match.</span></span>

<span data-ttu-id="76246-486">Da der übereinstimmende Algorithmus [nicht gierig](#greedy) ist:</span><span class="sxs-lookup"><span data-stu-id="76246-486">Since the matching algorithm is [non-greedy](#greedy):</span></span>

* <span data-ttu-id="76246-487">Entspricht er der kleinstmöglichen Textmenge in jedem Schritt.</span><span class="sxs-lookup"><span data-stu-id="76246-487">It matches the smallest amount of text possible in each step.</span></span>
* <span data-ttu-id="76246-488">Alle Fälle, in denen der Trennzeichenwert in den Parameterwerten angezeigt wird, stimmen nicht überein.</span><span class="sxs-lookup"><span data-stu-id="76246-488">Any case where the delimiter value appears inside the parameter values results in not matching.</span></span>

<span data-ttu-id="76246-489">Reguläre Ausdrücke bieten eine viel bessere Kontrolle über das Abgleichsverhalten.</span><span class="sxs-lookup"><span data-stu-id="76246-489">Regular expressions provide much more control over their matching behavior.</span></span>

<a name="greedy"></a>

<span data-ttu-id="76246-490">Beim gierigen Abgleich, auch als [Lazy Matching](https://wikipedia.org/wiki/Regular_expression#Lazy_matching) bezeichnet, wird die größtmögliche Zeichenfolge abgeglichen.</span><span class="sxs-lookup"><span data-stu-id="76246-490">Greedy matching, also know as [lazy matching](https://wikipedia.org/wiki/Regular_expression#Lazy_matching), matches the largest possible string.</span></span> <span data-ttu-id="76246-491">Beim nicht gierigen Abgleich ist dies die kürzeste Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="76246-491">Non-greedy matches the smallest possible string.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="76246-492">Referenz für Routeneinschränkungen</span><span class="sxs-lookup"><span data-stu-id="76246-492">Route constraint reference</span></span>

<span data-ttu-id="76246-493">Routeneinschränkungen werden angewendet, wenn eine Übereinstimmung mit der eingehenden URL gefunden wurde und der URL-Pfad in Routenwerten mit Token versehen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-493">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="76246-494">In der Regel wird mit Routeneinschränkungen der Routenwert der zugehörigen Vorlage geprüft. Dabei wird anhand einer True/False-Entscheidung bestimmt, ob der Wert gültig ist.</span><span class="sxs-lookup"><span data-stu-id="76246-494">Route constraints generally inspect the route value associated via the route template and make a true or false decision about whether the value is acceptable.</span></span> <span data-ttu-id="76246-495">Für einige Routeneinschränkungen werden anstelle des Routenwerts andere Daten verwendet, um zu ermitteln, ob das Routing einer Anforderung möglich ist.</span><span class="sxs-lookup"><span data-stu-id="76246-495">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="76246-496"><xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> kann beispielsweise auf der Grundlage des HTTP-Verbs eine Anforderung entweder annehmen oder ablehnen.</span><span class="sxs-lookup"><span data-stu-id="76246-496">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="76246-497">Einschränkungen werden in Routinganforderungen und bei der Linkgenerierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-497">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="76246-498">Verwenden Sie keine Einschränkungen für die Eingabeüberprüfung.</span><span class="sxs-lookup"><span data-stu-id="76246-498">Don't use constraints for input validation.</span></span> <span data-ttu-id="76246-499">Wenn Einschränkungen für die Eingabevalidierung verwendet werden, führt eine ungültige Eingabe zu einem `404`-Fehler (Nicht gefunden).</span><span class="sxs-lookup"><span data-stu-id="76246-499">If constraints are used for input validation, invalid input results in a `404` Not Found response.</span></span> <span data-ttu-id="76246-500">Eine ungültige Eingabe sollte zu einer ungültigen Anforderung (`400`) mit einer entsprechenden Fehlermeldung führen.</span><span class="sxs-lookup"><span data-stu-id="76246-500">Invalid input should produce a `400` Bad Request with an appropriate error message.</span></span> <span data-ttu-id="76246-501">Verwenden Sie Routeneinschränkungen nicht, um Eingaben für eine bestimmte Route zu überprüfen, sondern um ähnliche Routen zu unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="76246-501">Route constraints are used to disambiguate similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="76246-502">In der folgenden Tabelle werden Beispiele für Routeneinschränkungen und deren zu erwartendes Verhalten beschrieben:</span><span class="sxs-lookup"><span data-stu-id="76246-502">The following table demonstrates example route constraints and their expected behavior:</span></span>

| <span data-ttu-id="76246-503">Einschränkung</span><span class="sxs-lookup"><span data-stu-id="76246-503">constraint</span></span> | <span data-ttu-id="76246-504">Beispiel</span><span class="sxs-lookup"><span data-stu-id="76246-504">Example</span></span> | <span data-ttu-id="76246-505">Beispiele für Übereinstimmungen</span><span class="sxs-lookup"><span data-stu-id="76246-505">Example Matches</span></span> | <span data-ttu-id="76246-506">Hinweise</span><span class="sxs-lookup"><span data-stu-id="76246-506">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="76246-507">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="76246-507">`123456789`, `-123456789`</span></span> | <span data-ttu-id="76246-508">Für jeden Integer wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-508">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="76246-509">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="76246-509">`true`, `FALSE`</span></span> | <span data-ttu-id="76246-510">Entspricht `true` oder `false`.</span><span class="sxs-lookup"><span data-stu-id="76246-510">Matches `true` or `false`.</span></span> <span data-ttu-id="76246-511">Groß-/Kleinschreibung nicht beachten</span><span class="sxs-lookup"><span data-stu-id="76246-511">Case-insensitive</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="76246-512">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="76246-512">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="76246-513">Entspricht einem gültigen `DateTime`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-513">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="76246-514">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-514">See preceding warning.</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="76246-515">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="76246-515">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="76246-516">Entspricht einem gültigen `decimal`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-516">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="76246-517">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-517">See preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="76246-518">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="76246-518">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="76246-519">Entspricht einem gültigen `double`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-519">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="76246-520">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-520">See preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="76246-521">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="76246-521">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="76246-522">Entspricht einem gültigen `float`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-522">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="76246-523">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-523">See preceding warning.</span></span>|
| `guid` | `{id:guid}` | `CD2C1638-1638-72D5-1638-DEADBEEF1638` | <span data-ttu-id="76246-524">Für einen gültigen `Guid`-Wert wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-524">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="76246-525">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="76246-525">`123456789`, `-123456789`</span></span> | <span data-ttu-id="76246-526">Für einen gültigen `long`-Wert wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-526">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="76246-527">Die Zeichenfolge muss mindestens eine Länge von 4 Zeichen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-527">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="76246-528">Die Zeichenfolge darf maximal eine Länge von 8 Zeichen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-528">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="76246-529">Die Zeichenfolge muss genau 12 Zeichen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-529">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="76246-530">Die Zeichenfolge muss mindestens eine Länge von 8 und darf maximal eine Länge von 16 Zeichen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-530">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="76246-531">Der Integerwert muss mindestens 18 sein.</span><span class="sxs-lookup"><span data-stu-id="76246-531">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="76246-532">Der Integerwert darf nicht größer als 120 sein.</span><span class="sxs-lookup"><span data-stu-id="76246-532">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="76246-533">Der Integerwert muss zwischen 18 und 120 liegen.</span><span class="sxs-lookup"><span data-stu-id="76246-533">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="76246-534">Die Zeichenfolge muss aus mindestens einem alphabetische Zeichen bestehen, `a`-`z` und ohne Unterscheidung zwischen Groß-/Kleinbuchstaben.</span><span class="sxs-lookup"><span data-stu-id="76246-534">String must consist of one or more alphabetical characters, `a`-`z` and case-insensitive.</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="76246-535">Die Zeichenfolge muss mit dem regulären Ausdruck übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="76246-535">String must match the regular expression.</span></span> <span data-ttu-id="76246-536">Weitere Informationen finden Sie unter Tipps zum Definieren eines regulären Ausdrucks.</span><span class="sxs-lookup"><span data-stu-id="76246-536">See tips about defining a regular expression.</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="76246-537">Hierdurch wird erzwungen, dass ein Wert, der kein Parameter ist, für die URL-Generierung vorhanden sein muss.</span><span class="sxs-lookup"><span data-stu-id="76246-537">Used to enforce that a non-parameter value is present during URL generation</span></span> |

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="76246-538">Auf einen einzelnen Parameter können mehrere durch Doppelpunkte getrennte Einschränkungen angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-538">Multiple, colon delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="76246-539">Durch die folgende Einschränkung wird ein Parameter beispielsweise auf einen Integerwert größer oder gleich 1 beschränkt:</span><span class="sxs-lookup"><span data-stu-id="76246-539">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="76246-540">Für Routeneinschränkungen, mit denen die URL überprüft wird und die in den CLR-Typ umgewandelt werden, wird immer die invariante Kultur verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-540">Route constraints that verify the URL and are converted to a CLR type always use the invariant culture.</span></span> <span data-ttu-id="76246-541">Dies gilt z. B. für die Konvertierung in den CLR-Typ `int` oder `DateTime`.</span><span class="sxs-lookup"><span data-stu-id="76246-541">For example, conversion to the CLR type `int` or `DateTime`.</span></span> <span data-ttu-id="76246-542">Diese Einschränkungen setzen voraus, dass die URL nicht lokalisierbar ist.</span><span class="sxs-lookup"><span data-stu-id="76246-542">These constraints assume that the URL is not localizable.</span></span> <span data-ttu-id="76246-543">Die vom Framework bereitgestellten Routeneinschränkungen ändern nicht die Werte, die in Routenwerten gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="76246-543">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="76246-544">Alle Routenwerte, die aus der URL analysiert werden, werden als Zeichenfolgen gespeichert.</span><span class="sxs-lookup"><span data-stu-id="76246-544">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="76246-545">Durch die `float`-Einschränkung wird beispielsweise versucht, den Routenwert in einen Gleitkommawert zu konvertieren. Mit dem konvertierten Wert wird allerdings nur überprüft, ob eine Umwandlung überhaupt möglich ist.</span><span class="sxs-lookup"><span data-stu-id="76246-545">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

### <a name="regular-expressions-in-constraints"></a><span data-ttu-id="76246-546">Reguläre Ausdrücke in Einschränkungen</span><span class="sxs-lookup"><span data-stu-id="76246-546">Regular expressions in constraints</span></span>

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="76246-547">Reguläre Ausdrücke können mithilfe der `regex(...)`-Routeneinschränkung als Inline-Einschränkungen angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="76246-547">Regular expressions can be specified as inline constraints using the `regex(...)` route constraint.</span></span> <span data-ttu-id="76246-548">Methoden der <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*>-Familie akzeptieren auch ein Objektliteral von Einschränkungen.</span><span class="sxs-lookup"><span data-stu-id="76246-548">Methods in the <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> family also accept an object literal of constraints.</span></span> <span data-ttu-id="76246-549">Wenn dieses Formular verwendet wird, werden Zeichenfolgenwerte als reguläre Ausdrücke interpretiert.</span><span class="sxs-lookup"><span data-stu-id="76246-549">If that form is used, string values are interpreted as regular expressions.</span></span>

<span data-ttu-id="76246-550">Der folgende Code verwendet eine Inline-RegEx-Einschränkung:</span><span class="sxs-lookup"><span data-stu-id="76246-550">The following code uses an inline regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex.cs?name=snippet)]

<span data-ttu-id="76246-551">Der folgende Code verwendet ein Objektliteral, um eine RegEx-Einschränkung anzugeben:</span><span class="sxs-lookup"><span data-stu-id="76246-551">The following code uses an object literal to specify a regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex2.cs?name=snippet)]

<span data-ttu-id="76246-552">Im ASP.NET Core-Framework wird dem Konstruktor für reguläre Ausdrücke `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="76246-552">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="76246-553">Eine Beschreibung dieser Member finden Sie unter <xref:System.Text.RegularExpressions.RegexOptions>.</span><span class="sxs-lookup"><span data-stu-id="76246-553">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="76246-554">In regulären Ausdrücken werden Trennzeichen und Token verwendet, die auch beim Routing und in der Programmiersprache C# in ähnlicher Weise verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-554">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="76246-555">Token, die reguläre Ausdrücke enthalten, müssen mit einem Escapezeichen versehen werden.</span><span class="sxs-lookup"><span data-stu-id="76246-555">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="76246-556">Wenn Sie den regulären Ausdruck `^\d{3}-\d{2}-\d{4}$` in einer Inline-Einschränkung verwenden möchten, nutzen Sie eine der folgenden Optionen:</span><span class="sxs-lookup"><span data-stu-id="76246-556">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in an inline constraint, use one of the following:</span></span>

* <span data-ttu-id="76246-557">Ersetzen Sie `\`-Zeichen in der Zeichenfolge durch `\\`-Zeichen in der C#-Quelldatei, um das Escapezeichen für die Zeichenfolge `\` zu setzen.</span><span class="sxs-lookup"><span data-stu-id="76246-557">Replace `\` characters provided in the string as `\\` characters in the C# source file in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="76246-558">[Ausführliche Zeichenfolgeliterale](/dotnet/csharp/language-reference/keywords/string)</span><span class="sxs-lookup"><span data-stu-id="76246-558">[Verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="76246-559">Wenn Sie Trennzeichen für Routenparameter mit Escapezeichen versehen möchten (`{`, `}`, `[`, `]`), geben Sie jedes Zeichen im Ausdruck doppelt ein (z. B. `{{`, `}}`, `[[`, `]]`).</span><span class="sxs-lookup"><span data-stu-id="76246-559">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression, for example, `{{`, `}}`, `[[`, `]]`.</span></span> <span data-ttu-id="76246-560">In der folgenden Tabelle werden reguläre Ausdrücke und Ausdrücke aufgeführt, die mit Escapezeichen versehen sind:</span><span class="sxs-lookup"><span data-stu-id="76246-560">The following table shows a regular expression and its escaped version:</span></span>

| <span data-ttu-id="76246-561">Regulärer Ausdruck</span><span class="sxs-lookup"><span data-stu-id="76246-561">Regular expression</span></span>    | <span data-ttu-id="76246-562">Mit Escapezeichen versehener regulärer Ausdruck</span><span class="sxs-lookup"><span data-stu-id="76246-562">Escaped regular expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="76246-563">Beim Routing verwendete reguläre Ausdrücke beginnen oft mit dem `^`-Zeichen und stellen die Startposition der Zeichenfolge dar.</span><span class="sxs-lookup"><span data-stu-id="76246-563">Regular expressions used in routing often start with the `^` character and match the starting position of the string.</span></span> <span data-ttu-id="76246-564">Die Ausdrücke enden häufig mit einem Dollarzeichen (`$`) und stellen das Ende der Zeichenfolge dar.</span><span class="sxs-lookup"><span data-stu-id="76246-564">The expressions often end with the `$` character and match the end of the string.</span></span> <span data-ttu-id="76246-565">Mit den Zeichen `^` und `$` wird sichergestellt, dass der reguläre Ausdruck mit dem vollständigen Routenparameterwert übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="76246-565">The `^` and `$` characters ensure that the regular expression matches the entire route parameter value.</span></span> <span data-ttu-id="76246-566">Ohne die Zeichen `^` und `$` werden mit dem regulären Ausdruck alle Teilzeichenfolgen ermittelt, was häufig nicht gewünscht ist.</span><span class="sxs-lookup"><span data-stu-id="76246-566">Without the `^` and `$` characters, the regular expression matches any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="76246-567">In der folgenden Tabelle finden Sie Beispiele für reguläre Ausdrücke. Außerdem wird erklärt, warum ein Abgleich erfolgreich ist oder fehlschlägt:</span><span class="sxs-lookup"><span data-stu-id="76246-567">The following table provides examples and explains why they match or fail to match:</span></span>

| <span data-ttu-id="76246-568">expression</span><span class="sxs-lookup"><span data-stu-id="76246-568">Expression</span></span>   | <span data-ttu-id="76246-569">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="76246-569">String</span></span>    | <span data-ttu-id="76246-570">Match</span><span class="sxs-lookup"><span data-stu-id="76246-570">Match</span></span> | <span data-ttu-id="76246-571">Kommentar</span><span class="sxs-lookup"><span data-stu-id="76246-571">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="76246-572">hello</span><span class="sxs-lookup"><span data-stu-id="76246-572">hello</span></span>     | <span data-ttu-id="76246-573">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-573">Yes</span></span>   | <span data-ttu-id="76246-574">Teilzeichenfolge stimmt überein</span><span class="sxs-lookup"><span data-stu-id="76246-574">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="76246-575">123abc456</span><span class="sxs-lookup"><span data-stu-id="76246-575">123abc456</span></span> | <span data-ttu-id="76246-576">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-576">Yes</span></span>   | <span data-ttu-id="76246-577">Teilzeichenfolge stimmt überein</span><span class="sxs-lookup"><span data-stu-id="76246-577">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="76246-578">mz</span><span class="sxs-lookup"><span data-stu-id="76246-578">mz</span></span>        | <span data-ttu-id="76246-579">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-579">Yes</span></span>   | <span data-ttu-id="76246-580">Ausdruck stimmt überein</span><span class="sxs-lookup"><span data-stu-id="76246-580">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="76246-581">MZ</span><span class="sxs-lookup"><span data-stu-id="76246-581">MZ</span></span>        | <span data-ttu-id="76246-582">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-582">Yes</span></span>   | <span data-ttu-id="76246-583">keine Unterscheidung zwischen Groß-/Kleinbuchstaben</span><span class="sxs-lookup"><span data-stu-id="76246-583">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="76246-584">hello</span><span class="sxs-lookup"><span data-stu-id="76246-584">hello</span></span>     | <span data-ttu-id="76246-585">Nein</span><span class="sxs-lookup"><span data-stu-id="76246-585">No</span></span>    | <span data-ttu-id="76246-586">siehe Erläuterungen zu `^` und `$` oben</span><span class="sxs-lookup"><span data-stu-id="76246-586">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="76246-587">123abc456</span><span class="sxs-lookup"><span data-stu-id="76246-587">123abc456</span></span> | <span data-ttu-id="76246-588">Nein</span><span class="sxs-lookup"><span data-stu-id="76246-588">No</span></span>    | <span data-ttu-id="76246-589">siehe Erläuterungen zu `^` und `$` oben</span><span class="sxs-lookup"><span data-stu-id="76246-589">See `^` and `$` above</span></span> |

<span data-ttu-id="76246-590">Weitere Informationen zur Syntax von regulären Ausdrücken finden Sie unter [Sprachelemente für reguläre Ausdrücke – Kurzübersicht](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-590">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="76246-591">Einen regulären Ausdruck können Sie verwenden, um einen Parameter auf zulässige Werte einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="76246-591">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="76246-592">Mit `{action:regex(^(list|get|create)$)}` werden beispielsweise für den `action`-Routenwert nur die Werte `list`, `get` oder `create` abgeglichen.</span><span class="sxs-lookup"><span data-stu-id="76246-592">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="76246-593">Wenn die Zeichenfolge `^(list|get|create)$` dem Einschränkungswörterbuch übergeben wird, führt dies zum gleichen Ergebnis.</span><span class="sxs-lookup"><span data-stu-id="76246-593">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="76246-594">Auch Einschränkungen, die dem zugehörigen Wörterbuch hinzugefügt werden und mit keiner vorgegebenen Einschränkung übereinstimmen, werden als reguläre Ausdrücke behandelt.</span><span class="sxs-lookup"><span data-stu-id="76246-594">Constraints that are passed in the constraints dictionary that don't match one of the known constraints are also treated as regular expressions.</span></span> <span data-ttu-id="76246-595">Einschränkungen, die innerhalb einer Vorlage übergeben werden und mit keiner vorgegebenen Einschränkung übereinstimmen, werden nicht als reguläre Ausdrücke behandelt.</span><span class="sxs-lookup"><span data-stu-id="76246-595">Constraints that are passed  within a template that don't match one of the known constraints are not treated as regular expressions.</span></span>

### <a name="custom-route-constraints"></a><span data-ttu-id="76246-596">Benutzerdefinierte Routeneinschränkungen</span><span class="sxs-lookup"><span data-stu-id="76246-596">Custom route constraints</span></span>

<span data-ttu-id="76246-597">Benutzerdefinierte Routeneinschränkungen können durch Implementierung der <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>-Schnittstelle erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-597">Custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="76246-598">Die `IRouteConstraint`-Schnittstelle umfasst die <xref:System.Web.Routing.IRouteConstraint.Match*>-Methode, die `true` zurückgibt, wenn die Einschränkung erfüllt wird, und andernfalls `false`.</span><span class="sxs-lookup"><span data-stu-id="76246-598">The `IRouteConstraint` interface contains <xref:System.Web.Routing.IRouteConstraint.Match*>, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="76246-599">Benutzerdefinierte Routeneinschränkungen werden nur selten benötigt.</span><span class="sxs-lookup"><span data-stu-id="76246-599">Custom route constraints are rarely needed.</span></span> <span data-ttu-id="76246-600">Bevor Sie eine benutzerdefinierte Routeneinschränkung implementieren, sollten Sie Alternativen in Betracht ziehen, wie z. B. Modellbindung.</span><span class="sxs-lookup"><span data-stu-id="76246-600">Before implementing a custom route constraint, consider alternatives, such as model binding.</span></span>

<span data-ttu-id="76246-601">Zum Verwenden eines benutzerdefinierten `IRouteConstraint`-Elements muss der Routeneinschränkungstyp bei der <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>-Eigenschaft der App im Dienstcontainer registriert werden.</span><span class="sxs-lookup"><span data-stu-id="76246-601">To use a custom `IRouteConstraint`, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the service container.</span></span> <span data-ttu-id="76246-602">Eine `ConstraintMap` ist ein Wörterbuch, das Routeneinschränkungsschlüssel `IRouteConstraint`-Implementierungen zuordnet, die diese Einschränkungen überprüfen.</span><span class="sxs-lookup"><span data-stu-id="76246-602">A `ConstraintMap` is a dictionary that maps route constraint keys to `IRouteConstraint` implementations that validate those constraints.</span></span> <span data-ttu-id="76246-603">Die `ConstraintMap` einer App kann in `Startup.ConfigureServices` entweder als Teil eines [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*)-Aufrufs oder durch direktes Konfigurieren von <xref:Microsoft.AspNetCore.Routing.RouteOptions> mit `services.Configure<RouteOptions>` aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="76246-603">An app's `ConstraintMap` can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="76246-604">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="76246-604">For example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet)]

<span data-ttu-id="76246-605">Die vorangehende Einschränkung wird im folgenden Code angewendet:</span><span class="sxs-lookup"><span data-stu-id="76246-605">The preceding constraint is applied in the following code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet&highlight=6,13)]

<span data-ttu-id="76246-606">Die [MyDisplayRouteInfo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x/RoutingSample/Extensions/ControllerContextExtensions.cs)-Methode ist im [Beispieldownload](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) enthalten und dient der Anzeige von Routinginformationen.</span><span class="sxs-lookup"><span data-stu-id="76246-606">The [MyDisplayRouteInfo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x/RoutingSample/Extensions/ControllerContextExtensions.cs) method is included in the [sample download](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) and is used to display routing information.</span></span>

<span data-ttu-id="76246-607">Die Implementierung von `MyCustomConstraint` verhindert die Anwendung von `0` auf einen Routenparameter:</span><span class="sxs-lookup"><span data-stu-id="76246-607">The implementation of `MyCustomConstraint` prevents `0` being applied to a route parameter:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet2)]

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="76246-608">Der vorangehende Code:</span><span class="sxs-lookup"><span data-stu-id="76246-608">The preceding code:</span></span>

* <span data-ttu-id="76246-609">Verhindert, dass `0` im `{id}`-Segment der Route vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="76246-609">Prevents `0` in the `{id}` segment of the route.</span></span>
* <span data-ttu-id="76246-610">Dient als einfaches Beispiel für die Implementierung einer benutzerdefinierten Einschränkung.</span><span class="sxs-lookup"><span data-stu-id="76246-610">Is shown to provide a basic example of implementing a custom constraint.</span></span> <span data-ttu-id="76246-611">Es sollte nicht in einer Produktions-App eingesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-611">It should not be used in a production app.</span></span>

<span data-ttu-id="76246-612">Der folgende Code bietet einen besseren Ansatz, um zu verhindern, dass eine `id` mit einer `0` verarbeitet wird:</span><span class="sxs-lookup"><span data-stu-id="76246-612">The following code is a better approach to preventing an `id` containing a `0` from being processed:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet2)]

<span data-ttu-id="76246-613">Der vorangehende Code bietet im Vergleich zum `MyCustomConstraint`-Ansatz folgende Vorteile:</span><span class="sxs-lookup"><span data-stu-id="76246-613">The preceding code has the following advantages over the `MyCustomConstraint` approach:</span></span>

* <span data-ttu-id="76246-614">Eine benutzerdefinierte Einschränkung ist nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="76246-614">It doesn't require a custom constraint.</span></span>
* <span data-ttu-id="76246-615">Es wird ein beschreibender Fehler zurückgegeben, wenn der Routenparameter `0` enthält.</span><span class="sxs-lookup"><span data-stu-id="76246-615">It returns a more descriptive error when the route parameter includes `0`.</span></span>

## <a name="parameter-transformer-reference"></a><span data-ttu-id="76246-616">Parametertransformatorreferenz</span><span class="sxs-lookup"><span data-stu-id="76246-616">Parameter transformer reference</span></span>

<span data-ttu-id="76246-617">Parametertransformatoren:</span><span class="sxs-lookup"><span data-stu-id="76246-617">Parameter transformers:</span></span>

* <span data-ttu-id="76246-618">Werden beim Generieren eines Links mit <xref:Microsoft.AspNetCore.Routing.LinkGenerator> ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="76246-618">Execute when generating a link using <xref:Microsoft.AspNetCore.Routing.LinkGenerator>.</span></span>
* <span data-ttu-id="76246-619">Implementieren Sie <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName>.</span><span class="sxs-lookup"><span data-stu-id="76246-619">Implement <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName>.</span></span>
* <span data-ttu-id="76246-620">Werden mithilfe von <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="76246-620">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="76246-621">Nehmen den Routenwert des Parameters an und transformieren ihn in einen neuen Zeichenfolgenwert.</span><span class="sxs-lookup"><span data-stu-id="76246-621">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="76246-622">Haben die Verwendung des transformierten Wert in einem generierten Link zur Folge.</span><span class="sxs-lookup"><span data-stu-id="76246-622">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="76246-623">Beispielsweise generiert ein benutzerdefinierter Parametertransformator `slugify` im Routenmuster `blog\{article:slugify}` mit `Url.Action(new { article = "MyTestArticle" })``blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="76246-623">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="76246-624">Betrachten Sie die folgende Implementierung von `IOutboundParameterTransformer`:</span><span class="sxs-lookup"><span data-stu-id="76246-624">Consider the following `IOutboundParameterTransformer` implementation:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet2)]

<span data-ttu-id="76246-625">Um einen Parametertransformator in einem Routenmuster zu verwenden, konfigurieren Sie ihn mit <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="76246-625">To use a parameter transformer in a route pattern, configure it using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet)]

<span data-ttu-id="76246-626">Das ASP.NET Core-Framework verwendet Parametertransformatoren, um den URI zu transformieren, zu dem ein Endpunkt aufgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="76246-626">The ASP.NET Core framework uses parameter transformers to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="76246-627">Beispielsweise wandeln Parametertransformatoren die Routenwerte um, die zum Zuordnen folgender Elemente verwendet werden: `area`, `controller`, `action` und `page`.</span><span class="sxs-lookup"><span data-stu-id="76246-627">For example, parameter transformers transform the route values used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapControllerRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="76246-628">Mit der vorstehenden Routenvorlage wird die Aktion `SubscriptionManagementController.GetAll` dem URI `/subscription-management/get-all` zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="76246-628">With the preceding route template, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="76246-629">Ein Parametertransformator ändert nicht die zum Generieren eines Links verwendeten Routenwerte.</span><span class="sxs-lookup"><span data-stu-id="76246-629">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="76246-630">Beispielsweise gibt `Url.Action("GetAll", "SubscriptionManagement")``/subscription-management/get-all` aus.</span><span class="sxs-lookup"><span data-stu-id="76246-630">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="76246-631">ASP.NET Core bietet API-Konventionen für die Verwendung von Parametertransformatoren mit generierten Routen:</span><span class="sxs-lookup"><span data-stu-id="76246-631">ASP.NET Core provides API conventions for using parameter transformers with generated routes:</span></span>

* <span data-ttu-id="76246-632">Die <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName>-Konvention wendet einen angegebenen Parametertransformator auf alle Attributrouten in der App an.</span><span class="sxs-lookup"><span data-stu-id="76246-632">The <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName> MVC convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="76246-633">Der Parametertransformator transformiert Attributroutentoken, wenn diese ersetzt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-633">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="76246-634">Weitere Informationen finden Sie unter [Verwenden eines Parametertransformators zum Anpassen der Tokenersetzung](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="76246-634">For more information, see [Use a parameter transformer to customize token replacement](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="76246-635">Razor Pages verwendet die <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention>-API-Konvention.</span><span class="sxs-lookup"><span data-stu-id="76246-635">Razor Pages uses the <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention> API convention.</span></span> <span data-ttu-id="76246-636">Diese Konvention wendet einen angegebenen Parametertransformator auf alle automatisch erkannten Razor Pages-Seiten an.</span><span class="sxs-lookup"><span data-stu-id="76246-636">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="76246-637">Der Parametertransformator transformiert die Ordner- und Dateinamensegmente von Razor Pages-Routen.</span><span class="sxs-lookup"><span data-stu-id="76246-637">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="76246-638">Weitere Informationen finden Sie unter [Verwenden eines Parametertransformators zum Anpassen von Seitenrouten](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="76246-638">For more information, see [Use a parameter transformer to customize page routes](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

<a name="ugr"></a>

## <a name="url-generation-reference"></a><span data-ttu-id="76246-639">Referenz für URL-Generierung</span><span class="sxs-lookup"><span data-stu-id="76246-639">URL generation reference</span></span>

<span data-ttu-id="76246-640">Dieser Abschnitt enthält eine Referenz für den Algorithmus, der durch die URL-Generierung implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="76246-640">This section contains a reference for the algorithm implemented by URL generation.</span></span> <span data-ttu-id="76246-641">In der Praxis werden bei den meisten komplexen Beispielen für die URL-Generierung Controller oder Razor Pages verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-641">In practice, most complex examples of URL generation use controllers or Razor Pages.</span></span> <span data-ttu-id="76246-642">Weitere Informationen finden Sie unter [Routing in Controllern](xref:mvc/controllers/routing) (Routing in Controllern).</span><span class="sxs-lookup"><span data-stu-id="76246-642">See  [routing in controllers](xref:mvc/controllers/routing) for additional information.</span></span>

<span data-ttu-id="76246-643">Die URL-Generierung beginnt mit einem Aufruf von [LinkGenerator.GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) oder einer ähnlichen Methode.</span><span class="sxs-lookup"><span data-stu-id="76246-643">The URL generation process begins with a call to [LinkGenerator.GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) or a similar method.</span></span> <span data-ttu-id="76246-644">Die Methode wird mit einer Adresse, mehreren Routenwerten und optional mit Informationen zur aktuellen Anforderung von `HttpContext` versehen.</span><span class="sxs-lookup"><span data-stu-id="76246-644">The method is provided with an address, a set of route values, and optionally information about the current request from `HttpContext`.</span></span>

<span data-ttu-id="76246-645">Im ersten Schritt wird die Adresse verwendet, um bestimmte Endpunktkandidaten mithilfe einer [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1)-Schnittstelle aufzulösen, die dem Adresstyp entspricht.</span><span class="sxs-lookup"><span data-stu-id="76246-645">The first step is to use the address to resolve a set of candidate endpoints using an [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1) that matches the address's type.</span></span>

<span data-ttu-id="76246-646">Sobald eine Kandidatengruppe anhand des Adressschemas gefunden wurde, werden die Endpunkte geordnet und iterativ verarbeitet, bis die URL-Generierung erfolgreich abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="76246-646">Once of set of candidates is found by the address scheme, the endpoints are ordered and processed iteratively until a URL generation operation succeeds.</span></span> <span data-ttu-id="76246-647">Bei der URL-Generierung wird **nicht** auf Mehrdeutigkeiten geprüft, daher ist das erste zurückgegebene Ergebnis das Endergebnis.</span><span class="sxs-lookup"><span data-stu-id="76246-647">URL generation does **not** check for ambiguities, the first result returned is the final result.</span></span>

### <a name="troubleshooting-url-generation-with-logging"></a><span data-ttu-id="76246-648">Behandeln von Problemen mit der Protokollierung bei der URL-Generierung</span><span class="sxs-lookup"><span data-stu-id="76246-648">Troubleshooting URL generation with logging</span></span>

<span data-ttu-id="76246-649">Der erste Schritt bei der Behebung von Problemen bei der URL-Generierung ist die Einstellung des Protokolliergrads von `Microsoft.AspNetCore.Routing` auf `TRACE`.</span><span class="sxs-lookup"><span data-stu-id="76246-649">The first step in troubleshooting URL generation is setting the logging level of `Microsoft.AspNetCore.Routing` to `TRACE`.</span></span> <span data-ttu-id="76246-650">`LinkGenerator` protokolliert viele Details über die Verarbeitung, die bei der Problembehebung nützlich sein können.</span><span class="sxs-lookup"><span data-stu-id="76246-650">`LinkGenerator` logs many details about its processing which can be useful to troubleshoot problems.</span></span>

<span data-ttu-id="76246-651">Ausführliche Informationen zur URL-Generierung finden Sie unter [Referenz für URL-Generierung](#ugr).</span><span class="sxs-lookup"><span data-stu-id="76246-651">See [URL generation reference](#ugr) for details on URL generation.</span></span>

### <a name="addresses"></a><span data-ttu-id="76246-652">Adressen</span><span class="sxs-lookup"><span data-stu-id="76246-652">Addresses</span></span>

<span data-ttu-id="76246-653">Mithilfe von Adressen wird bei der URL-Generierung ein Aufruf in der API zur Linkgenerierung an mehrere Endpunktkandidaten gebunden.</span><span class="sxs-lookup"><span data-stu-id="76246-653">Addresses are the concept in URL generation used to bind a call into the link generator to a set of candidate endpoints.</span></span>

<span data-ttu-id="76246-654">Adressen sind ein erweiterbares Konzept, das standardmäßig mit zwei Implementierungen bereitgestellt wird:</span><span class="sxs-lookup"><span data-stu-id="76246-654">Addresses are an extensible concept that come with two implementations by default:</span></span>

* <span data-ttu-id="76246-655">Die Verwendung von *Endpunktname* (`string`) als Adresse:</span><span class="sxs-lookup"><span data-stu-id="76246-655">Using *endpoint name* (`string`) as the address:</span></span>
    * <span data-ttu-id="76246-656">Bietet ähnliche Funktionalität wie der Routenname von MVC.</span><span class="sxs-lookup"><span data-stu-id="76246-656">Provides similar functionality to MVC's route name.</span></span>
    * <span data-ttu-id="76246-657">Wird der <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata>-Metadatentyp verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-657">Uses the <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata> metadata type.</span></span>
    * <span data-ttu-id="76246-658">Löst die bereitgestellte Zeichenfolge anhand der Metadaten aller registrierten Endpunkte auf.</span><span class="sxs-lookup"><span data-stu-id="76246-658">Resolves the provided string against the metadata of all registered endpoints.</span></span>
    * <span data-ttu-id="76246-659">Löst beim Start eine Ausnahme aus, wenn mehrere Endpunkte den gleichen Namen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-659">Throws an exception on startup if multiple endpoints use the same name.</span></span>
    * <span data-ttu-id="76246-660">Wird für die allgemeine Verwendung außerhalb von Controllern und Razor Pages empfohlen.</span><span class="sxs-lookup"><span data-stu-id="76246-660">Recommended for general-purpose use outside of controllers and Razor Pages.</span></span>
* <span data-ttu-id="76246-661">Die Verwendung von *Routenwerten* (<xref:Microsoft.AspNetCore.Routing.RouteValuesAddress>) als Adresse:</span><span class="sxs-lookup"><span data-stu-id="76246-661">Using *route values* (<xref:Microsoft.AspNetCore.Routing.RouteValuesAddress>) as the address:</span></span>
    * <span data-ttu-id="76246-662">Bietet eine ähnliche Funktionalität wie die Legacy-Funktion zur URL-Generierung von Controllern und Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="76246-662">Provides similar functionality to controllers and Razor Pages legacy URL generation.</span></span>
    * <span data-ttu-id="76246-663">Lässt sich nur schwer erweitern und debuggen.</span><span class="sxs-lookup"><span data-stu-id="76246-663">Very complex to extend and debug.</span></span>
    * <span data-ttu-id="76246-664">Bietet die Implementierung, die von `IUrlHelper`, Taghilfsprogrammen, HTML-Hilfsprogrammen, Aktionsergebnissen usw. verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="76246-664">Provides the implementation used by `IUrlHelper`, Tag Helpers, HTML Helpers, Action Results, etc.</span></span>

<span data-ttu-id="76246-665">Aufgabe des Adressschemas ist es, die Verbindung zwischen der Adresse und den übereinstimmenden Endpunkten anhand von beliebigen Kriterien herzustellen:</span><span class="sxs-lookup"><span data-stu-id="76246-665">The role of the address scheme is to make the association between the address and matching endpoints by arbitrary criteria:</span></span>

* <span data-ttu-id="76246-666">Das Schema für Endpunktenamen führt eine allgemeine Wörterbuchsuche durch.</span><span class="sxs-lookup"><span data-stu-id="76246-666">The endpoint name scheme performs a basic dictionary lookup.</span></span>
* <span data-ttu-id="76246-667">Das Schema der Routenwerte weist eine komplexe beste Teilmenge des Mengenalgorithmus auf.</span><span class="sxs-lookup"><span data-stu-id="76246-667">The route values scheme has a complex best subset of set algorithm.</span></span>

<a name="ambient"></a>

### <a name="ambient-values-and-explicit-values"></a><span data-ttu-id="76246-668">Umgebungswerte und explizite Werte</span><span class="sxs-lookup"><span data-stu-id="76246-668">Ambient values and explicit values</span></span>

<span data-ttu-id="76246-669">Aus der aktuellen Anforderung greift das Routing auf die Routenwerte der aktuellen Anforderung `HttpContext.Request.RouteValues` zu.</span><span class="sxs-lookup"><span data-stu-id="76246-669">From the current request, routing accesses the route values of the current request `HttpContext.Request.RouteValues`.</span></span> <span data-ttu-id="76246-670">Die mit der aktuellen Anforderung verbundenen Werte werden als **Umgebungswerte** bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="76246-670">The values associated with the current request are referred to as the **ambient values**.</span></span> <span data-ttu-id="76246-671">Aus Gründen der Übersichtlichkeit werden in der Dokumentation die an die Methoden übergebenen Routenwerte als **explizite Werte** bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="76246-671">For the purpose of clarity, the documentation refers to the route values passed in to methods as **explicit values**.</span></span>

<span data-ttu-id="76246-672">Das folgende Beispiel zeigt Umgebungswerte und explizite Werte.</span><span class="sxs-lookup"><span data-stu-id="76246-672">The following example shows ambient values and explicit values.</span></span> <span data-ttu-id="76246-673">Er liefert Umgebungswerte aus der aktuellen Anforderung und explizite Werte: `{ id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="76246-673">It provides ambient values from the current request and explicit values: `{ id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet)]

<span data-ttu-id="76246-674">Der vorangehende Code:</span><span class="sxs-lookup"><span data-stu-id="76246-674">The preceding code:</span></span>

* <span data-ttu-id="76246-675">Gibt `/Widget/Index/17` zurück.</span><span class="sxs-lookup"><span data-stu-id="76246-675">Returns `/Widget/Index/17`</span></span>
* <span data-ttu-id="76246-676">Ruft <xref:Microsoft.AspNetCore.Routing.LinkGenerator> über [DI](xref:fundamentals/dependency-injection) ab.</span><span class="sxs-lookup"><span data-stu-id="76246-676">Gets <xref:Microsoft.AspNetCore.Routing.LinkGenerator> via [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="76246-677">Der folgende Code liefert keine Umgebungswerte und keine expliziten Werte: `{ controller = "Home", action = "Subscribe", id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="76246-677">The following code provides no ambient values and explicit values: `{ controller = "Home", action = "Subscribe", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet2)]

<span data-ttu-id="76246-678">Die vorhergehende Methode gibt `/Home/Subscribe/17` zurück</span><span class="sxs-lookup"><span data-stu-id="76246-678">The preceding  method returns `/Home/Subscribe/17`</span></span>

<span data-ttu-id="76246-679">Der folgende Code in `WidgetController` gibt `/Widget/Subscribe/17` zurück:</span><span class="sxs-lookup"><span data-stu-id="76246-679">The following code in the `WidgetController` returns `/Widget/Subscribe/17`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet3)]

<span data-ttu-id="76246-680">Der folgende Code stellt den Controller aus den Umgebungswerten in der aktuellen Anforderung und explizite Werte dar: `{ action = "Edit", id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="76246-680">The following code provides the controller from ambient values in the current request and explicit values: `{ action = "Edit", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/GadgetController.cs?name=snippet)]

<span data-ttu-id="76246-681">Für den Code oben gilt:</span><span class="sxs-lookup"><span data-stu-id="76246-681">In the preceding code:</span></span>

* <span data-ttu-id="76246-682">`/Gadget/Edit/17` wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="76246-682">`/Gadget/Edit/17` is returned.</span></span>
* <span data-ttu-id="76246-683"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url> ruft die <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>-Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="76246-683"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url> gets the <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>.</span></span>
* <xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*>   
<span data-ttu-id="76246-684">generiert eine URL mit einem absoluten Pfad für eine Aktionsmethode.</span><span class="sxs-lookup"><span data-stu-id="76246-684">generates a URL with an absolute path for an action method.</span></span> <span data-ttu-id="76246-685">Die URL enthält den angegebenen `action`-Namen und `route`-Werte.</span><span class="sxs-lookup"><span data-stu-id="76246-685">The URL contains the specified `action` name and `route` values.</span></span>

<span data-ttu-id="76246-686">Sie liefert Umgebungswerte aus der aktuellen Anforderung und explizite Werte: `{ page = "./Edit, id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="76246-686">The following code provides ambient values from the current request and explicit values: `{ page = "./Edit, id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Pages/Index.cshtml.cs?name=snippet)]

<span data-ttu-id="76246-687">Im vorangehenden Code wird `url` auf `/Edit/17` festgelegt, wenn die Option zum Bearbeiten von Razor Page die folgende Seitendirektive enthält:</span><span class="sxs-lookup"><span data-stu-id="76246-687">The preceding code sets `url` to  `/Edit/17` when the Edit Razor Page contains the following page directive:</span></span>

 `@page "{id:int}"`

<span data-ttu-id="76246-688">Wenn die Routenvorlage `"{id:int}"` nicht in der Seite „Bearbeiten“ enthalten ist, ist `url` gleich `/Edit?id=17`.</span><span class="sxs-lookup"><span data-stu-id="76246-688">If the Edit page doesn't contain the `"{id:int}"` route template, `url` is `/Edit?id=17`.</span></span>

<span data-ttu-id="76246-689">Das Verhalten der <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>-Schnittstelle von MVC fügt zusätzlich zu den hier beschriebenen Regeln eine weitere Komplexitätsebene hinzu:</span><span class="sxs-lookup"><span data-stu-id="76246-689">The behavior of MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> adds a layer of complexity in addition to the rules described here:</span></span>

* <span data-ttu-id="76246-690">`IUrlHelper` liefert immer die Routenwerte aus der aktuellen Anforderung als Umgebungswerte.</span><span class="sxs-lookup"><span data-stu-id="76246-690">`IUrlHelper` always provides the route values from the current request as ambient values.</span></span>
* <span data-ttu-id="76246-691">[IUrlHelper.action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) kopiert immer die aktuellen Routenwerte `action` und `controller` als explizite Werte, sofern sie nicht vom Entwickler außer Kraft gesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-691">[IUrlHelper.Action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) always copies the current `action` and `controller` route values as explicit values unless overridden by the developer.</span></span>
* <span data-ttu-id="76246-692">[IUrlHelper.page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) kopiert immer den aktuellen Routenwert `page` als expliziten Wert, sofern er nicht außer Kraft gesetzt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-692">[IUrlHelper.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) always copies the current `page` route value as an explicit value unless overridden.</span></span> <!--by the user-->
* <span data-ttu-id="76246-693">`IUrlHelper.Page` setzt immer den aktuellen Routenwert `handler` mit `null` als expliziten Wert außer Kraft, sofern er nicht außer Kraft gesetzt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-693">`IUrlHelper.Page` always overrides the current `handler` route value with `null` as an explicit values unless overridden.</span></span>

<span data-ttu-id="76246-694">Benutzer sind oft von den Verhaltensdetails der Umgebungswerte überrascht, da MVC anscheinend nicht den eigenen Regeln folgt.</span><span class="sxs-lookup"><span data-stu-id="76246-694">Users are often surprised by the behavioral details of ambient values, because MVC doesn't seem to follow its own rules.</span></span> <span data-ttu-id="76246-695">Aus Verlaufs- und Kompatibilitätsgründen weisen bestimmte Routenwerte wie `action`, `controller`, `page` und `handler` ein spezielles Verhalten auf.</span><span class="sxs-lookup"><span data-stu-id="76246-695">For historical and compatibility reasons, certain route values such as `action`, `controller`, `page`, and `handler` have their own special-case behavior.</span></span>

<span data-ttu-id="76246-696">Die äquivalente Funktionalität, die durch `LinkGenerator.GetPathByAction` und `LinkGenerator.GetPathByPage` bereitgestellt wird, verdoppelt diese Anomalien von `IUrlHelper` aus Kompatibilitätsgründen.</span><span class="sxs-lookup"><span data-stu-id="76246-696">The equivalent functionality provided by `LinkGenerator.GetPathByAction` and `LinkGenerator.GetPathByPage` duplicates these anomalies of `IUrlHelper` for compatibility.</span></span>

### <a name="url-generation-process"></a><span data-ttu-id="76246-697">URL-Generierungsprozess</span><span class="sxs-lookup"><span data-stu-id="76246-697">URL generation process</span></span>

<span data-ttu-id="76246-698">Sobald die Gruppe der Endpunktkandidaten ermittelt ist, wird der URL-Generierungsalgorithmus angewendet:</span><span class="sxs-lookup"><span data-stu-id="76246-698">Once the set of candidate endpoints are found, the URL generation algorithm:</span></span>

* <span data-ttu-id="76246-699">Die Endpunkte werden iterativ verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="76246-699">Processes the endpoints iteratively.</span></span>
* <span data-ttu-id="76246-700">Das erste erfolgreiche Ergebnis wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="76246-700">Returns the first successful result.</span></span>

<span data-ttu-id="76246-701">Der erste Schritt in diesem Prozess wird als **Routenwertinvalidierung** bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="76246-701">The first step in this process is called **route value invalidation**.</span></span>  <span data-ttu-id="76246-702">Die Routenwertinvalidierung ist der Prozess, bei dem das Routing entscheidet, welche Routenwerte aus den Umgebungswerten verwendet und welche ignoriert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="76246-702">Route value invalidation is the process by which routing decides which route values from the ambient values should be used and which should be ignored.</span></span> <span data-ttu-id="76246-703">Jeder Umgebungswert wird berücksichtigt und entweder mit den expliziten Werten kombiniert oder aber ignoriert.</span><span class="sxs-lookup"><span data-stu-id="76246-703">Each ambient value is considered and either combined with the explicit values, or ignored.</span></span>

<span data-ttu-id="76246-704">Denken Sie daran, dass Umgebungswerte Anwendungsentwicklern in allgemeinen Fällen das Schreiben von Code sparen können.</span><span class="sxs-lookup"><span data-stu-id="76246-704">The best way to think about the role of ambient values is that they attempt to save application developers typing, in some common cases.</span></span> <span data-ttu-id="76246-705">In der Regel sind die Szenarios, in denen Umgebungswerte hilfreich sind, mit MVC verknüpft:</span><span class="sxs-lookup"><span data-stu-id="76246-705">Traditionally, the scenarios where ambient values are helpful are related to MVC:</span></span>

* <span data-ttu-id="76246-706">Bei der Verknüpfung mit einer anderen Aktion im gleichen Controller muss der Controllername nicht angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="76246-706">When linking to another action in the same controller, the controller name doesn't need to be specified.</span></span>
* <span data-ttu-id="76246-707">Bei der Verknüpfung mit einem anderen Controller im gleichen Bereich muss der Bereich nicht angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="76246-707">When linking to another controller in the same area, the area name doesn't need to be specified.</span></span>
* <span data-ttu-id="76246-708">Bei der Verknüpfung mit der gleichen Aktionsmethode müssen keine Routenwerte angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="76246-708">When linking to the same action method, route values don't need to be specified.</span></span>
* <span data-ttu-id="76246-709">Bei der Verknüpfung mit einem anderen Teil der App sollen keine Routenwerte übertragen werden, die für diesen Teil der App irrelevant sind.</span><span class="sxs-lookup"><span data-stu-id="76246-709">When linking to another part of the app, you don't want to carry over route values that have no meaning in that part of the app.</span></span>

<span data-ttu-id="76246-710">Aufrufe an `LinkGenerator` oder `IUrlHelper`, die `null` zurückgeben, sind meist dadurch bedingt, dass die Routenwertinvalidierung nicht verstanden wurde.</span><span class="sxs-lookup"><span data-stu-id="76246-710">Calls to `LinkGenerator` or `IUrlHelper` that return `null` are usually caused by not understanding route value invalidation.</span></span> <span data-ttu-id="76246-711">Beheben Sie die Routenwertinvalidierung, indem Sie explizit mehr Routenwerte angeben, um zu prüfen, ob das Problem dadurch gelöst wird.</span><span class="sxs-lookup"><span data-stu-id="76246-711">Troubleshoot route value invalidation by explicitly specifying more of the route values to see if that solves the problem.</span></span>

<span data-ttu-id="76246-712">Bei der Routenwertinvalidierung wird davon ausgegangen, dass das URL-Schema der Anwendung hierarchisch ist, mit einer von links nach rechts gebildeten Hierarchie.</span><span class="sxs-lookup"><span data-stu-id="76246-712">Route value invalidation works on the assumption that the app's URL scheme is hierarchical, with a hierarchy formed from left-to-right.</span></span> <span data-ttu-id="76246-713">Sehen Sie sich die einfache Controllerroutenvorlage `{controller}/{action}/{id?}` an, um ein Gespür dafür zu bekommen, wie dies in der Praxis funktioniert.</span><span class="sxs-lookup"><span data-stu-id="76246-713">Consider the basic controller route template `{controller}/{action}/{id?}` to get an intuitive sense of how this works in practice.</span></span> <span data-ttu-id="76246-714">Durch eine **Änderung** auf einen Wert werden alle rechts angezeigten Routenwerte **ungültig**.</span><span class="sxs-lookup"><span data-stu-id="76246-714">A **change** to a value **invalidates** all of the route values that appear to the right.</span></span> <span data-ttu-id="76246-715">Dies spricht für die These von der Hierarchie.</span><span class="sxs-lookup"><span data-stu-id="76246-715">This reflects the assumption about hierarchy.</span></span> <span data-ttu-id="76246-716">Wenn die App einen Umgebungswert für `id` hat und der Vorgang einen anderen Wert für `controller` angibt:</span><span class="sxs-lookup"><span data-stu-id="76246-716">If the app has an ambient value for `id`, and the operation specifies a different value for the `controller`:</span></span>

* <span data-ttu-id="76246-717">`id` wird nicht wiederverwendet, weil `{controller}` links von `{id?}` steht.</span><span class="sxs-lookup"><span data-stu-id="76246-717">`id` won't be reused because `{controller}` is to the left of `{id?}`.</span></span>

<span data-ttu-id="76246-718">Einige Beispiele veranschaulichen dieses Prinzip:</span><span class="sxs-lookup"><span data-stu-id="76246-718">Some examples demonstrating this principle:</span></span>

* <span data-ttu-id="76246-719">Wenn die expliziten Werte einen Wert für `id` enthalten, wird der Umgebungswert für `id` ignoriert.</span><span class="sxs-lookup"><span data-stu-id="76246-719">If the explicit values contain a value for `id`, the ambient value for `id` is ignored.</span></span> <span data-ttu-id="76246-720">Die Umgebungswerte für `controller` und `action` können verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-720">The ambient values for `controller` and `action` can be used.</span></span>
* <span data-ttu-id="76246-721">Wenn die expliziten Werte einen Wert für `action` enthalten, wird jeder Umgebungswert für `action` ignoriert.</span><span class="sxs-lookup"><span data-stu-id="76246-721">If the explicit values contain a value for `action`, any ambient value for `action` is ignored.</span></span> <span data-ttu-id="76246-722">Die Umgebungswerte für `controller` können verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-722">The ambient values for `controller` can be used.</span></span> <span data-ttu-id="76246-723">Wenn sich der explizite Wert für `action` von dem Umgebungswert für `action` unterscheidet, wird der Wert `id` nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-723">If the explicit value for `action` is different from the ambient value for `action`, the `id` value won't be used.</span></span>  <span data-ttu-id="76246-724">Wenn der explizite Wert für `action` mit dem Umgebungswert für `action` übereinstimmt, kann der Wert `id` verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-724">If the explicit value for `action` is the same as the ambient value for `action`, the `id` value can be used.</span></span>
* <span data-ttu-id="76246-725">Wenn die expliziten Werte einen Wert für `controller` enthalten, wird jeder Umgebungswert für `controller` ignoriert.</span><span class="sxs-lookup"><span data-stu-id="76246-725">If the explicit values contain a value for `controller`, any ambient value for `controller` is ignored.</span></span> <span data-ttu-id="76246-726">Wenn sich der explizite Wert für `controller` von dem Umgebungswert für `controller` unterscheidet, werden die Werte `action` und `id` nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-726">If the explicit value for `controller` is different from the ambient value for `controller`, the `action` and `id` values won't be used.</span></span> <span data-ttu-id="76246-727">Wenn der explizite Wert für `controller` mit dem Umgebungswert für `controller` übereinstimmt, können die Werte `action` und `id` verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-727">If the explicit value for `controller` is the same as the ambient value for `controller`, the `action` and `id` values can be used.</span></span>

<span data-ttu-id="76246-728">Dieser Prozess wird zusätzlich durch die vorhandenen Attributrouten und dedizierten konventionellen Routen erschwert.</span><span class="sxs-lookup"><span data-stu-id="76246-728">This process is further complicated by the existence of attribute routes and dedicated conventional routes.</span></span> <span data-ttu-id="76246-729">Konventionelle Routen des Controllers wie `{controller}/{action}/{id?}` legen eine Hierarchie mithilfe von Routenparametern fest.</span><span class="sxs-lookup"><span data-stu-id="76246-729">Controller conventional routes such as `{controller}/{action}/{id?}` specify a hierarchy using route parameters.</span></span> <span data-ttu-id="76246-730">Bei [bestimmten konventionellen Routen](xref:mvc/controllers/routing#dcr) und [Attributrouten](xref:mvc/controllers/routing#ar) zu Controllern und Razor Pages:</span><span class="sxs-lookup"><span data-stu-id="76246-730">For [dedicated conventional routes](xref:mvc/controllers/routing#dcr) and [attribute routes](xref:mvc/controllers/routing#ar) to controllers and Razor Pages:</span></span>

* <span data-ttu-id="76246-731">Gibt es eine Hierarchie für Routenwerte.</span><span class="sxs-lookup"><span data-stu-id="76246-731">There is a hierarchy of route values.</span></span>
* <span data-ttu-id="76246-732">Werden diese nicht in der Vorlage angezeigt.</span><span class="sxs-lookup"><span data-stu-id="76246-732">They don't appear in the template.</span></span>

<span data-ttu-id="76246-733">Für diese Fälle definiert die URL-Generierung das Konzept der **erforderlichen Werte**.</span><span class="sxs-lookup"><span data-stu-id="76246-733">For these cases, URL generation defines the **required values** concept.</span></span> <span data-ttu-id="76246-734">Bei Endpunkten, die von Controllern und Razor Pages erstellt wurden, sind erforderliche Werte angegeben, die eine Routenwertinvalidierung ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="76246-734">Endpoints created by controllers and Razor Pages have required values specified that allow route value invalidation to work.</span></span>

<span data-ttu-id="76246-735">Der Algorithmus der Routenwertinvalidierung im Detail:</span><span class="sxs-lookup"><span data-stu-id="76246-735">The route value invalidation algorithm in detail:</span></span>

* <span data-ttu-id="76246-736">Die erforderlichen Wertnamen werden mit den Routenparametern kombiniert und dann von links nach rechts verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="76246-736">The required value names are combined with the route parameters, then processed from left-to-right.</span></span>
* <span data-ttu-id="76246-737">Für jeden Parameter werden der Umgebungswert und der explizite Wert verglichen:</span><span class="sxs-lookup"><span data-stu-id="76246-737">For each parameter, the ambient value and explicit value are compared:</span></span>
    * <span data-ttu-id="76246-738">Wenn der Umgebungswert und der explizite Wert gleich sind, wird der Prozess fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="76246-738">If the ambient value and explicit value are the same, the process continues.</span></span>
    * <span data-ttu-id="76246-739">Wenn der Umgebungswert vorhanden ist und der explizite Wert nicht, wird der Umgebungswert bei der URL-Generierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-739">If the ambient value is present and the explicit value isn't, the ambient value is used when generating the URL.</span></span>
    * <span data-ttu-id="76246-740">Wenn der Umgebungswert nicht vorhanden ist und der explizite Wert vorhanden ist, verwerfen Sie den Umgebungswert und alle nachfolgenden Umgebungswerte.</span><span class="sxs-lookup"><span data-stu-id="76246-740">If the ambient value isn't present and the explicit value is, reject the ambient value and all subsequent ambient values.</span></span>
    * <span data-ttu-id="76246-741">Wenn der Umgebungswert und der explizite Wert vorhanden und die beiden Werte unterschiedlich sind, verwerfen Sie den Umgebungswert und alle nachfolgenden Umgebungswerte.</span><span class="sxs-lookup"><span data-stu-id="76246-741">If the ambient value and the explicit value are present, and the two values are different, reject the ambient value and all subsequent ambient values.</span></span>

<span data-ttu-id="76246-742">An diesem Punkt ist der Vorgang zur URL-Generierung bereit, Routeneinschränkungen auszuwerten.</span><span class="sxs-lookup"><span data-stu-id="76246-742">At this point, the URL generation operation is ready to evaluate route constraints.</span></span> <span data-ttu-id="76246-743">Die akzeptierten Werte werden mit den Standardwerten der Parameter kombiniert, die für Einschränkungen bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-743">The set of accepted values is combined with the parameter default values, which is provided to constraints.</span></span> <span data-ttu-id="76246-744">Wenn alle Einschränkungen erfüllt sind, wird der Vorgang fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="76246-744">If the constraints all pass, the operation continues.</span></span>

<span data-ttu-id="76246-745">Als Nächstes können die **akzeptierten Werte** verwendet werden, um die Routenvorlage zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="76246-745">Next, the **accepted values** can be used to expand the route template.</span></span> <span data-ttu-id="76246-746">Die Routenvorlage wird verarbeitet:</span><span class="sxs-lookup"><span data-stu-id="76246-746">The route template is processed:</span></span>

* <span data-ttu-id="76246-747">Von links nach rechts.</span><span class="sxs-lookup"><span data-stu-id="76246-747">From left-to-right.</span></span>
* <span data-ttu-id="76246-748">Für jeden Parameter wird der akzeptierte Wert ersetzt.</span><span class="sxs-lookup"><span data-stu-id="76246-748">Each parameter has its accepted value substituted.</span></span>
* <span data-ttu-id="76246-749">In den folgenden Sonderfällen:</span><span class="sxs-lookup"><span data-stu-id="76246-749">With the following special cases:</span></span>
  * <span data-ttu-id="76246-750">Wenn bei den akzeptierten Werten ein Wert fehlt und der Parameter einen Standardwert hat, wird der Standardwert verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-750">If the accepted values is missing a value and the parameter has a default value, the default value is used.</span></span>
  * <span data-ttu-id="76246-751">Wenn bei den akzeptierten Werten ein Wert fehlt und der Parameter optional ist, wird die Verarbeitung fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="76246-751">If the accepted values is missing a value and the parameter is optional, processing continues.</span></span>
  * <span data-ttu-id="76246-752">Wenn irgendein Routenparameter rechts neben einem fehlenden optionalen Parameter einen Wert hat, schlägt der Vorgang fehl.</span><span class="sxs-lookup"><span data-stu-id="76246-752">If any route parameter to the right of a missing optional parameter has a value, the operation fails.</span></span>
  * <!-- review default-valued parameters optional parameters --> <span data-ttu-id="76246-753">Zusammenhängende Parameter mit Standardwerten und optionale Parameter werden, wenn möglich, reduziert dargestellt.</span><span class="sxs-lookup"><span data-stu-id="76246-753">Contiguous default-valued parameters and optional parameters are collapsed where possible.</span></span>

<span data-ttu-id="76246-754">Explizit bereitgestellte Werte, für die keine Übereinstimmungen mit einem Routensegment ermittelt werden, werden der Abfragezeichenfolge hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="76246-754">Values explicitly provided that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="76246-755">In der folgenden Tabelle werden die Ergebnisse dargestellt, die aus der Verwendung der Routenvorlage `{controller}/{action}/{id?}` hervorgehen:</span><span class="sxs-lookup"><span data-stu-id="76246-755">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="76246-756">Umgebungswerte</span><span class="sxs-lookup"><span data-stu-id="76246-756">Ambient Values</span></span>                     | <span data-ttu-id="76246-757">Explizite Werte</span><span class="sxs-lookup"><span data-stu-id="76246-757">Explicit Values</span></span>                        | <span data-ttu-id="76246-758">Ergebnis</span><span class="sxs-lookup"><span data-stu-id="76246-758">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="76246-759">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="76246-759">controller = "Home"</span></span>                | <span data-ttu-id="76246-760">action = "About"</span><span class="sxs-lookup"><span data-stu-id="76246-760">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="76246-761">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="76246-761">controller = "Home"</span></span>                | <span data-ttu-id="76246-762">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="76246-762">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="76246-763">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="76246-763">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="76246-764">action = "About"</span><span class="sxs-lookup"><span data-stu-id="76246-764">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="76246-765">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="76246-765">controller = "Home"</span></span>                | <span data-ttu-id="76246-766">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="76246-766">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

### <a name="problems-with-route-value-invalidation"></a><span data-ttu-id="76246-767">Probleme mit der Routenwertinvalidierung</span><span class="sxs-lookup"><span data-stu-id="76246-767">Problems with route value invalidation</span></span>

<span data-ttu-id="76246-768">Ab ASP.NET Core 3.0 funktionieren einige Schemas zur URL-Generierung, die in früheren ASP.NET Core-Versionen verwendet wurden, nicht mehr sehr gut.</span><span class="sxs-lookup"><span data-stu-id="76246-768">As of ASP.NET Core 3.0, some URL generation schemes used in earlier ASP.NET Core versions don't work well with URL generation.</span></span> <span data-ttu-id="76246-769">Das ASP.NET Core-Team plant, in einer zukünftigen Version Features hinzuzufügen, die diese Anforderungen erfüllen.</span><span class="sxs-lookup"><span data-stu-id="76246-769">The ASP.NET Core team plans to add features to address these needs in a future release.</span></span> <span data-ttu-id="76246-770">Im Moment ist die beste Lösung die Verwendung von Legacy-Routingfunktionen.</span><span class="sxs-lookup"><span data-stu-id="76246-770">For now the best solution is to use legacy routing.</span></span>

<span data-ttu-id="76246-771">Der folgende Code zeigt ein Beispiel für ein Schema zur URL-Generierung, das vom Routing nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-771">The following code shows an example of a URL generation scheme that's not supported by routing.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupUnsupported.cs?name=snippet)]

<span data-ttu-id="76246-772">Im vorangehenden Code wird der `culture`-Routenparameter für die Lokalisierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-772">In the preceding code, the `culture` route parameter is used for localization.</span></span> <span data-ttu-id="76246-773">Ziel ist es, dass der `culture`-Parameter immer als Umgebungswert akzeptiert wird.</span><span class="sxs-lookup"><span data-stu-id="76246-773">The desire is to have the `culture` parameter always accepted as an ambient value.</span></span> <span data-ttu-id="76246-774">Der `culture`-Parameter wird jedoch aufgrund der Art und Weise, wie die erforderlichen Werte funktionieren, nicht als Umgebungswert akzeptiert:</span><span class="sxs-lookup"><span data-stu-id="76246-774">However, the `culture` parameter is not accepted as an ambient value because of the way required values work:</span></span>

* <span data-ttu-id="76246-775">In der `"default"`-Routenvorlage befindet sich der `culture`-Routenparameter links von `controller`, sodass `culture` durch Änderungen an `controller` nicht ungültig wird.</span><span class="sxs-lookup"><span data-stu-id="76246-775">In the `"default"` route template, the `culture` route parameter is to the left of `controller`, so changes to `controller` won't invalidate `culture`.</span></span>
* <span data-ttu-id="76246-776">In der `"blog"`-Routenvorlage wird der `culture`-Routenparameter rechts von `controller` betrachtet, der in den erforderlichen Werten aufgeführt ist.</span><span class="sxs-lookup"><span data-stu-id="76246-776">In the `"blog"` route template, the `culture` route parameter is considered to be to the right of `controller`, which appears in the required values.</span></span>

## <a name="configuring-endpoint-metadata"></a><span data-ttu-id="76246-777">Konfigurieren von Endpunktmetadaten</span><span class="sxs-lookup"><span data-stu-id="76246-777">Configuring endpoint metadata</span></span>

<span data-ttu-id="76246-778">Die folgenden Links enthalten Informationen zum Konfigurieren von Endpunktmetadaten:</span><span class="sxs-lookup"><span data-stu-id="76246-778">The following links provide information on configuring endpoint metadata:</span></span>

* [<span data-ttu-id="76246-779">Aktivieren von Cors mit Endpunktrouting</span><span class="sxs-lookup"><span data-stu-id="76246-779">Enable Cors with endpoint routing</span></span>](xref:security/cors#enable-cors-with-endpoint-routing)
* <span data-ttu-id="76246-780">[IAuthorizationPolicyProvider-Beispiel](https://github.com/dotnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) mit einem benutzerdefinierten `[MinimumAgeAuthorize]`-Attribut</span><span class="sxs-lookup"><span data-stu-id="76246-780">[IAuthorizationPolicyProvider sample](https://github.com/dotnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) using a custom `[MinimumAgeAuthorize]` attribute</span></span>
* <span data-ttu-id="76246-781">[Testen der Authentifizierung mit dem [Authorize]-Attribut](xref:security/authentication/identity#test-identity)</span><span class="sxs-lookup"><span data-stu-id="76246-781">[Test authentication with the [Authorize] attribute](xref:security/authentication/identity#test-identity)</span></span>
* <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*>
* <span data-ttu-id="76246-782">[Auswählen des Schemas mit dem [Authorize]-Attribut](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span><span class="sxs-lookup"><span data-stu-id="76246-782">[Selecting the scheme with the [Authorize] attribute](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span></span>
* <span data-ttu-id="76246-783">[Anwenden von Richtlinien mithilfe des [Authorize]-Attributs](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span><span class="sxs-lookup"><span data-stu-id="76246-783">[Applying policies using the [Authorize] attribute](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span></span>
* <xref:security/authorization/roles>

<a name="hostmatch"></a>

## <a name="host-matching-in-routes-with-requirehost"></a><span data-ttu-id="76246-784">Hostabgleich in Routen mit RequireHost</span><span class="sxs-lookup"><span data-stu-id="76246-784">Host matching in routes with RequireHost</span></span>

<span data-ttu-id="76246-785"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*> wendet eine Einschränkung auf die Route an, für die der angegebene Host erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="76246-785"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*> applies a constraint to the route which requires the specified host.</span></span> <span data-ttu-id="76246-786">Der `RequireHost`- oder [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute)-Parameter kann wie folgt lauten:</span><span class="sxs-lookup"><span data-stu-id="76246-786">The `RequireHost` or [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute) parameter can be:</span></span>

* <span data-ttu-id="76246-787">Host: `www.domain.com`, entspricht `www.domain.com` mit einem beliebigen Port.</span><span class="sxs-lookup"><span data-stu-id="76246-787">Host: `www.domain.com`, matches `www.domain.com` with any port.</span></span>
* <span data-ttu-id="76246-788">Host mit Platzhalter: `*.domain.com`, entspricht `www.domain.com`, `subdomain.domain.com` oder `www.subdomain.domain.com` an einem beliebigen Port.</span><span class="sxs-lookup"><span data-stu-id="76246-788">Host with wildcard: `*.domain.com`, matches `www.domain.com`, `subdomain.domain.com`, or `www.subdomain.domain.com` on any port.</span></span>
* <span data-ttu-id="76246-789">Port: `*:5000`, entspricht Port 5000 mit einem beliebigen Host.</span><span class="sxs-lookup"><span data-stu-id="76246-789">Port: `*:5000`, matches port 5000 with any host.</span></span>
* <span data-ttu-id="76246-790">Host und Port: `www.domain.com:5000` oder `*.domain.com:5000`, entspricht dem Host und Port.</span><span class="sxs-lookup"><span data-stu-id="76246-790">Host and port: `www.domain.com:5000` or `*.domain.com:5000`, matches host and port.</span></span>

<span data-ttu-id="76246-791">Es können mehrere Parameter mit `RequireHost` oder `[Host]` angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="76246-791">Multiple parameters can be specified using `RequireHost` or `[Host]`.</span></span> <span data-ttu-id="76246-792">Die Einschränkung gleicht die Hosts ab, die für einen der Parameter gültig sind.</span><span class="sxs-lookup"><span data-stu-id="76246-792">The constraint  matches hosts valid for any of the parameters.</span></span> <span data-ttu-id="76246-793">Beispielsweise entspricht `[Host("domain.com", "*.domain.com")]` `domain.com`, `www.domain.com` und `subdomain.domain.com`.</span><span class="sxs-lookup"><span data-stu-id="76246-793">For example, `[Host("domain.com", "*.domain.com")]` matches `domain.com`, `www.domain.com`, and `subdomain.domain.com`.</span></span>

<span data-ttu-id="76246-794">Im folgenden Code wird `RequireHost` verwendet, um den angegebenen Host auf der Route anzufordern:</span><span class="sxs-lookup"><span data-stu-id="76246-794">The following code uses `RequireHost` to require the specified host on the route:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRequireHost.cs?name=snippet)]

<span data-ttu-id="76246-795">Im folgenden Code wird das `[Host]`-Attribut für den Controller verwendet, um die einzelnen angegebenen Hosts anzufordern:</span><span class="sxs-lookup"><span data-stu-id="76246-795">The following code uses the `[Host]` attribute on the controller to require any of the specified hosts:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/ProductController.cs?name=snippet)]

<span data-ttu-id="76246-796">Wenn das `[Host]`-Attribut sowohl auf die Controller- als auch auf die Aktionsmethode angewendet wird, trifft Folgendes zu:</span><span class="sxs-lookup"><span data-stu-id="76246-796">When the `[Host]` attribute is applied to both the controller and action method:</span></span>

* <span data-ttu-id="76246-797">Das Attribut auf der Aktion wird verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-797">The attribute on the action is used.</span></span>
* <span data-ttu-id="76246-798">Das Controllerattribut wird ignoriert.</span><span class="sxs-lookup"><span data-stu-id="76246-798">The controller attribute is ignored.</span></span>

## <a name="performance-guidance-for-routing"></a><span data-ttu-id="76246-799">Leistungsleitfaden für das Routing</span><span class="sxs-lookup"><span data-stu-id="76246-799">Performance guidance for routing</span></span>

<span data-ttu-id="76246-800">Der Großteil der Routingfunktionalität wurde in ASP.NET Core 3.0 aktualisiert, um die Leistung zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="76246-800">Most of routing was updated in ASP.NET Core 3.0 to increase performance.</span></span>

<span data-ttu-id="76246-801">Wenn eine App Leistungsprobleme hat, wird die Ursache häufig beim Routing vermutet.</span><span class="sxs-lookup"><span data-stu-id="76246-801">When an app has performance problems, routing is often suspected as the problem.</span></span> <span data-ttu-id="76246-802">Das Routing wird deshalb in Betracht gezogen, weil Frameworks wie Controller und Razor Pages in ihren Protokollierungsmeldungen die innerhalb des Frameworks verbrachte Zeit angeben.</span><span class="sxs-lookup"><span data-stu-id="76246-802">The reason routing is suspected is that frameworks like controllers and Razor Pages report the amount of time spent inside the framework in their logging messages.</span></span> <span data-ttu-id="76246-803">Wenn es einen signifikanten Unterschied zwischen der von den Controllern gemeldeten Zeit und der Gesamtzeit der Anforderung gibt:</span><span class="sxs-lookup"><span data-stu-id="76246-803">When there's a significant difference between the time reported by controllers and the total time of the request:</span></span>

* <span data-ttu-id="76246-804">Schließen Entwickler ihren App-Code als Ursache des Problems aus.</span><span class="sxs-lookup"><span data-stu-id="76246-804">Developers eliminate their app code as the source of the problem.</span></span>
* <span data-ttu-id="76246-805">Wird in der Regel angenommen, dass das Routing die Ursache für das Problem ist.</span><span class="sxs-lookup"><span data-stu-id="76246-805">It's common to assume routing is the cause.</span></span>

<span data-ttu-id="76246-806">Die Leistung des Routings wird anhand von Tausenden von Endpunkten getestet.</span><span class="sxs-lookup"><span data-stu-id="76246-806">Routing is performance tested using thousands of endpoints.</span></span> <span data-ttu-id="76246-807">Es ist unwahrscheinlich, dass eine typische App auf ein Leistungsproblem stößt, nur weil diese zu umfangreich ist.</span><span class="sxs-lookup"><span data-stu-id="76246-807">It's unlikely that a typical app will encounter a performance problem just by being too large.</span></span> <span data-ttu-id="76246-808">Die häufigste Ursache für eine langsames Routing ist üblicherweise eine schlecht funktionierende benutzerdefinierte Middleware.</span><span class="sxs-lookup"><span data-stu-id="76246-808">The most common root cause of slow routing performance is usually a badly-behaving custom middleware.</span></span>

<span data-ttu-id="76246-809">Das folgende Codebeispiel veranschaulicht eine grundlegende Technik zur Eingrenzung der Verzögerungsquelle:</span><span class="sxs-lookup"><span data-stu-id="76246-809">This following code sample demonstrates a basic technique for narrowing down the source of delay:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupDelay.cs?name=snippet)]

<span data-ttu-id="76246-810">Auf das Zeitrouting:</span><span class="sxs-lookup"><span data-stu-id="76246-810">To time routing:</span></span>

* <span data-ttu-id="76246-811">Verschachteln Sie jede Middleware mit einer Kopie der im vorherigen Code gezeigten Zeitmiddleware.</span><span class="sxs-lookup"><span data-stu-id="76246-811">Interleave each middleware with a copy of the timing middleware shown in the preceding code.</span></span>
* <span data-ttu-id="76246-812">Fügen Sie einen eindeutigen Bezeichner hinzu, um die Zeitdaten mit dem Code zu korrelieren.</span><span class="sxs-lookup"><span data-stu-id="76246-812">Add a unique identifier to correlate the timing data with the code.</span></span>

<span data-ttu-id="76246-813">Dies ist ein einfacher Weg, um die Verzögerung zu verringern, wenn sie signifikant ist, zum Beispiel größer als `10ms`.</span><span class="sxs-lookup"><span data-stu-id="76246-813">This is a basic way to narrow down the delay when it's significant, for example, more than `10ms`.</span></span>  <span data-ttu-id="76246-814">Wenn `Time 2` von `Time 1` subtrahiert wird, ergibt sich die in der `UseRouting`-Middleware benötigte Zeit.</span><span class="sxs-lookup"><span data-stu-id="76246-814">Subtracting `Time 2` from `Time 1` reports the time spent inside the `UseRouting` middleware.</span></span>

<span data-ttu-id="76246-815">Der folgende Code verwendet einen kompakteren Ansatz als der vorangegangene Zeitcode:</span><span class="sxs-lookup"><span data-stu-id="76246-815">The following code uses a more compact approach to the preceding timing code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippetSW)]

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippet)]

### <a name="potentially-expensive-routing-features"></a><span data-ttu-id="76246-816">Potenziell teure Routingfeatures</span><span class="sxs-lookup"><span data-stu-id="76246-816">Potentially expensive routing features</span></span>

<span data-ttu-id="76246-817">Die folgende Liste gibt einen Einblick in Routingfeatures, die im Vergleich zu einfachen Routenvorlagen relativ teuer sind:</span><span class="sxs-lookup"><span data-stu-id="76246-817">The following list provides some insight into routing features that are relatively expensive compared with basic route templates:</span></span>

* <span data-ttu-id="76246-818">Reguläre Ausdrücke: Mit einer kleinen Menge an Eingaben ist möglich, reguläre Ausdrücke zu schreiben, die komplex sind oder eine lange Ausführungszeit haben.</span><span class="sxs-lookup"><span data-stu-id="76246-818">Regular expressions: It's possible to write regular expressions that are complex, or have long running time with a small amount of input.</span></span>

* <span data-ttu-id="76246-819">Komplexe Segmente (`{x}-{y}-{z}`):</span><span class="sxs-lookup"><span data-stu-id="76246-819">Complex segments (`{x}-{y}-{z}`):</span></span> 
  * <span data-ttu-id="76246-820">Sind wesentlich teurer als das Analysieren eines regulären URL-Pfadsegments.</span><span class="sxs-lookup"><span data-stu-id="76246-820">Are significantly more expensive than parsing a regular URL path segment.</span></span>
  * <span data-ttu-id="76246-821">Führen dazu, dass viel mehr Teilzeichenfolgen zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-821">Result in many more substrings being allocated.</span></span>
  * <span data-ttu-id="76246-822">Die komplexe Segmentlogik wurde beim Aktualisieren der ASP.NET Core 3.0-Routingleistung nicht aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="76246-822">The complex segment logic was not updated in ASP.NET Core 3.0 routing performance update.</span></span>

* <span data-ttu-id="76246-823">Synchroner Datenzugriff: Viele komplexe Apps verfügen im Rahmen Ihrer Routingfunktionen über Datenbankzugriff.</span><span class="sxs-lookup"><span data-stu-id="76246-823">Synchronous data access: Many complex apps have database access as part of their routing.</span></span> <span data-ttu-id="76246-824">Das Routing in ASP.NET Core 2.2 und früheren Versionen bietet möglicherweise nicht die richtigen Erweiterungspunkte zur Unterstützung des Routings für den Datenbankzugriff.</span><span class="sxs-lookup"><span data-stu-id="76246-824">ASP.NET Core 2.2 and earlier routing might not provide the right extensibility points to support database access routing.</span></span> <span data-ttu-id="76246-825">Zum Beispiel sind <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> und <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> synchron.</span><span class="sxs-lookup"><span data-stu-id="76246-825">For example, <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, and <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> are synchronous.</span></span> <span data-ttu-id="76246-826">Erweiterbarkeitspunkte wie <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> und <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> sind asynchron.</span><span class="sxs-lookup"><span data-stu-id="76246-826">Extensibility points such as <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> and <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> are asynchronous.</span></span>

## <a name="guidance-for-library-authors"></a><span data-ttu-id="76246-827">Leitfaden für Bibliotheksautoren</span><span class="sxs-lookup"><span data-stu-id="76246-827">Guidance for library authors</span></span>

<span data-ttu-id="76246-828">Dieser Abschnitt enthält Hinweise für Bibliotheksautoren, die auf dem Routing aufbauen.</span><span class="sxs-lookup"><span data-stu-id="76246-828">This section contains guidance for library authors building on top of routing.</span></span> <span data-ttu-id="76246-829">Diese Details sollen sicherstellen, dass App-Entwickler gute Erfahrungen mit Bibliotheken und Frameworks machen, die das Routing erweitern.</span><span class="sxs-lookup"><span data-stu-id="76246-829">These details are intended to ensure that app developers have a good experience using libraries and frameworks that extend routing.</span></span>

### <a name="define-endpoints"></a><span data-ttu-id="76246-830">Definieren von Endpunkten</span><span class="sxs-lookup"><span data-stu-id="76246-830">Define endpoints</span></span>

<span data-ttu-id="76246-831">Wenn Sie ein Framework erstellen möchten, das das Routing für den URL-Abgleich verwendet, sollten Sie zunächst eine Benutzeroberfläche definieren, die auf <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> aufbaut.</span><span class="sxs-lookup"><span data-stu-id="76246-831">To create a framework that uses routing for URL matching, start by defining a user experience that builds on top of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>

<span data-ttu-id="76246-832">**Es wird empfohlen,** dass Sie auf <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder> aufbauen.</span><span class="sxs-lookup"><span data-stu-id="76246-832">**DO** build on top of <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span> <span data-ttu-id="76246-833">Auf diese Weise können Benutzer Ihr Framework mit anderen ASP.NET Core-Features problemlos zusammenstellen.</span><span class="sxs-lookup"><span data-stu-id="76246-833">This allows users to compose your framework with other ASP.NET Core features without confusion.</span></span> <span data-ttu-id="76246-834">Jede ASP.NET Core-Vorlage umfasst die Routingfunktionalität.</span><span class="sxs-lookup"><span data-stu-id="76246-834">Every ASP.NET Core template includes routing.</span></span> <span data-ttu-id="76246-835">Gehen Sie davon aus, dass das Routing vorhanden und den Benutzern vertraut ist.</span><span class="sxs-lookup"><span data-stu-id="76246-835">Assume routing is present and familiar for users.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="76246-836">**Es wird empfohlen,** dass Sie einen versiegelten konkreten Typ aus einem Aufruf an `MapMyFramework(...)` zurückgeben, der <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder> implementiert.</span><span class="sxs-lookup"><span data-stu-id="76246-836">**DO** return a sealed concrete type from a call to `MapMyFramework(...)` that implements <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder>.</span></span> <span data-ttu-id="76246-837">Die meisten `Map...`-Methoden in Frameworks folgen diesem Muster.</span><span class="sxs-lookup"><span data-stu-id="76246-837">Most framework `Map...` methods follow this pattern.</span></span> <span data-ttu-id="76246-838">Die `IEndpointConventionBuilder`-Schnittstelle:</span><span class="sxs-lookup"><span data-stu-id="76246-838">The `IEndpointConventionBuilder` interface:</span></span>

* <span data-ttu-id="76246-839">Ermöglicht die Kombinierbarkeit von Metadaten.</span><span class="sxs-lookup"><span data-stu-id="76246-839">Allows composability of metadata.</span></span>
* <span data-ttu-id="76246-840">Wird von verschiedenen Erweiterungsmethoden angesteuert.</span><span class="sxs-lookup"><span data-stu-id="76246-840">Is targeted by a variety of extension methods.</span></span>

<span data-ttu-id="76246-841">Wenn Sie Ihren eigenen Typ deklarieren, können Sie dem Generator Ihre eigene frameworkspezifische Funktionalität hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="76246-841">Declaring your own type allows you to add your own framework-specific functionality to the builder.</span></span> <span data-ttu-id="76246-842">Es ist in Ordnung, einen vom Framework deklarierten Generator zu umschließen und Aufrufe an ihn weiterzuleiten.</span><span class="sxs-lookup"><span data-stu-id="76246-842">It's ok to wrap a framework-declared builder and forward calls to it.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequrireAuthorization()
                                 .WithMyFrameworkFeature(awesome: true);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="76246-843">**Ziehen Sie in Betracht,** Ihre eigene <xref:Microsoft.AspNetCore.Routing.EndpointDataSource>-Klasse zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="76246-843">**CONSIDER** writing your own <xref:Microsoft.AspNetCore.Routing.EndpointDataSource>.</span></span> <span data-ttu-id="76246-844">Die `EndpointDataSource`-Klasse vom primitiven Typ auf niedriger Ebene eignet sich zum Deklarieren und Aktualisieren einer Sammlung von Endpunkten.</span><span class="sxs-lookup"><span data-stu-id="76246-844">`EndpointDataSource` is the low-level primitive for declaring and updating a collection of endpoints.</span></span> <span data-ttu-id="76246-845">`EndpointDataSource` ist eine leistungsstarke API, die von Controllern und Razor Pages verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="76246-845">`EndpointDataSource` is a powerful API used by controllers and Razor Pages.</span></span>

<span data-ttu-id="76246-846">Die Routingtests haben ein [grundlegendes Beispiel](https://github.com/aspnet/AspNetCore/blob/master/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) für eine Datenquelle, die nicht aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="76246-846">The routing tests have a [basic example](https://github.com/aspnet/AspNetCore/blob/master/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) of a non-updating data source.</span></span>

<span data-ttu-id="76246-847">**Versuchen Sie nicht,** eine `EndpointDataSource`-Klasse standardmäßig zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="76246-847">**DO NOT** attempt to register an `EndpointDataSource` by default.</span></span> <span data-ttu-id="76246-848">Fordern Sie die Benutzer auf, Ihr Framework in <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="76246-848">Require users to register your framework in <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span> <span data-ttu-id="76246-849">Der Grundgedanke beim Routing ist, dass standardmäßig nichts enthalten ist, und dass die Endpunkte bei `UseEndpoints` registriert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="76246-849">The philosophy of routing is that nothing is included by default, and that `UseEndpoints` is the place to register endpoints.</span></span>

### <a name="creating-routing-integrated-middleware"></a><span data-ttu-id="76246-850">Erstellen von in das Routing integrierter Middleware</span><span class="sxs-lookup"><span data-stu-id="76246-850">Creating routing-integrated middleware</span></span>

<span data-ttu-id="76246-851">**Ziehen Sie in Betracht,** Metadatentypen als Schnittstelle zu definieren.</span><span class="sxs-lookup"><span data-stu-id="76246-851">**CONSIDER** defining metadata types as an interface.</span></span>

<span data-ttu-id="76246-852">**Ermöglichen Sie,** Metadatentypen als Attribut für Klassen und Methoden zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="76246-852">**DO** make it possible to use metadata types as an attribute on classes and methods.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet2)]

<span data-ttu-id="76246-853">Frameworks wie Controller und Razor Pages unterstützen die Anwendung von Metadatenattributen auf Typen und Methoden.</span><span class="sxs-lookup"><span data-stu-id="76246-853">Frameworks like controllers and Razor Pages support applying metadata attributes to types and methods.</span></span> <span data-ttu-id="76246-854">Für das Deklarieren von Metadatentypen gilt:</span><span class="sxs-lookup"><span data-stu-id="76246-854">If you declare metadata types:</span></span>

* <span data-ttu-id="76246-855">Machen Sie diese als [Attribute](/dotnet/csharp/programming-guide/concepts/attributes/) zugänglich.</span><span class="sxs-lookup"><span data-stu-id="76246-855">Make them accessible as [attributes](/dotnet/csharp/programming-guide/concepts/attributes/).</span></span>
* <span data-ttu-id="76246-856">Die meisten Benutzer sind mit der Anwendung von Attributen vertraut.</span><span class="sxs-lookup"><span data-stu-id="76246-856">Most users are familiar with applying attributes.</span></span>

<span data-ttu-id="76246-857">Durch die Deklaration eines Metadatentyps als Schnittstelle wird die Flexibilität zusätzlich erhöht:</span><span class="sxs-lookup"><span data-stu-id="76246-857">Declaring a metadata type as an interface adds another layer of flexibility:</span></span>

* <span data-ttu-id="76246-858">Schnittstelle können zusammengesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-858">Interfaces are composable.</span></span>
* <span data-ttu-id="76246-859">Entwickler können ihre eigenen Typen deklarieren, die mehrere Richtlinien kombinieren.</span><span class="sxs-lookup"><span data-stu-id="76246-859">Developers can declare their own types that combine multiple policies.</span></span>

<span data-ttu-id="76246-860">**Ermöglichen Sie,** Metadaten außer Kraft zu setzen, wie in folgendem Beispiel gezeigt:</span><span class="sxs-lookup"><span data-stu-id="76246-860">**DO** make it possible to override metadata, as shown in the following example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet)]

<span data-ttu-id="76246-861">Die beste Möglichkeit, diese Richtlinien zu befolgen, besteht darin, die Definition von **Markermetadaten** zu vermeiden:</span><span class="sxs-lookup"><span data-stu-id="76246-861">The best way to follow these guidelines is to avoid defining **marker metadata**:</span></span>

* <span data-ttu-id="76246-862">Suchen Sie nicht nur nach dem Vorhandensein eines Metadatentyps.</span><span class="sxs-lookup"><span data-stu-id="76246-862">Don't just look for the presence of a metadata type.</span></span>
* <span data-ttu-id="76246-863">Definieren Sie eine Eigenschaft für die Metadaten, und überprüfen Sie die Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="76246-863">Define a property on the metadata and check the property.</span></span>

<span data-ttu-id="76246-864">Die Metadatensammlung ist geordnet und unterstützt das Außerkraftsetzen nach Priorität.</span><span class="sxs-lookup"><span data-stu-id="76246-864">The metadata collection is ordered and supports overriding by priority.</span></span> <span data-ttu-id="76246-865">Im Fall von Controllern sind Metadaten für die Aktionsmethode am spezifischsten.</span><span class="sxs-lookup"><span data-stu-id="76246-865">In the case of controllers, metadata on the action method is most specific.</span></span>

<span data-ttu-id="76246-866">**Nutzen Sie** Middleware mit und ohne Routing.</span><span class="sxs-lookup"><span data-stu-id="76246-866">**DO** make middleware useful with and without routing.</span></span>

```csharp
app.UseRouting();

app.UseAuthorization(new AuthorizationPolicy() { ... });

app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequrireAuthorization();
});
```

<span data-ttu-id="76246-867">Ein gutes Beispiel für diese Vorgabe ist die `UseAuthorization`-Middleware.</span><span class="sxs-lookup"><span data-stu-id="76246-867">As an example of this guideline, consider the `UseAuthorization` middleware.</span></span> <span data-ttu-id="76246-868">Mithilfe der Autorisierungsmiddleware können Sie eine Fallbackrichtlinie einbauen.</span><span class="sxs-lookup"><span data-stu-id="76246-868">The authorization middleware allows you to pass in a fallback policy.</span></span> <!-- shown where?  (shown here) --> <span data-ttu-id="76246-869">Die Fallbackrichtlinie gilt, falls angegeben, für beide:</span><span class="sxs-lookup"><span data-stu-id="76246-869">The fallback policy, if specified, applies to both:</span></span>

* <span data-ttu-id="76246-870">Endpunkte ohne angegebene Richtlinie.</span><span class="sxs-lookup"><span data-stu-id="76246-870">Endpoints without a specified policy.</span></span>
* <span data-ttu-id="76246-871">Anforderungen, die nicht mit einem Endpunkt übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="76246-871">Requests that don't match an endpoint.</span></span>

<span data-ttu-id="76246-872">Dies macht die Autorisierungsmiddleware außerhalb des Routingkontexts sehr nützlich.</span><span class="sxs-lookup"><span data-stu-id="76246-872">This makes the authorization middleware useful outside of the context of routing.</span></span> <span data-ttu-id="76246-873">Die Autorisierungsmiddleware kann für die traditionelle Middlewareprogrammierung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-873">The authorization middleware can be used for traditional middleware programming.</span></span>

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="76246-874">Beim Routing werden Anforderungs-URIs Endpunkten zugeordnet und Anforderungen an diese Endpunkte weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="76246-874">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="76246-875">Routen werden in der App definiert und beim Start der App konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="76246-875">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="76246-876">Eine Route kann optional Werte aus der URL extrahieren, die in der Anforderung enthalten ist. Diese Werte können anschließend für die Verarbeitung der Anforderung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-876">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="76246-877">Mithilfe von Routeninformationen aus der App lassen sich durch das Routing URLs generieren, die Endpunkten zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-877">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="76246-878">Wenn Sie die aktuellsten Routingszenarios in ASP.NET Core 2.2 verwenden möchten, geben Sie die [Kompatibilitätsversion](xref:mvc/compatibility-version) zur Registrierung der MVC-Dienste in `Startup.ConfigureServices` an:</span><span class="sxs-lookup"><span data-stu-id="76246-878">To use the latest routing scenarios in ASP.NET Core 2.2, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="76246-879">Die Option <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> bestimmt, ob für das Routing intern endpunktbasierte Logik oder <xref:Microsoft.AspNetCore.Routing.IRouter>-basierte Logik von ASP.NET Core 2.1 oder früher verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="76246-879">The <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> option determines if routing should internally use endpoint-based logic or the <xref:Microsoft.AspNetCore.Routing.IRouter>-based logic of ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="76246-880">Wenn die Kompatibilitätsversion auf 2.2 oder höher festgelegt ist, lautet der Standardwert `true`.</span><span class="sxs-lookup"><span data-stu-id="76246-880">When the compatibility version is set to 2.2 or later, the default value is `true`.</span></span> <span data-ttu-id="76246-881">Legen Sie für den Wert `false` fest, um die vorherige Routinglogik zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="76246-881">Set the value to `false` to use the prior routing logic:</span></span>

```csharp
// Use the routing logic of ASP.NET Core 2.1 or earlier:
services.AddMvc(options => options.EnableEndpointRouting = false)
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="76246-882">Weitere Informationen zum <xref:Microsoft.AspNetCore.Routing.IRouter>-basierten Routing finden Sie in dem [Artikel zur Version 2.1 von ASP.NET Core](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="76246-882">For more information on <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, see the [ASP.NET Core 2.1 version of this topic](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="76246-883">In diesem Artikel wird das Low-Level-Routing in ASP.NET Core beschrieben.</span><span class="sxs-lookup"><span data-stu-id="76246-883">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="76246-884">Weitere Informationen zum Routing mit ASP.NET Core MVC finden Sie unter <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="76246-884">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="76246-885">Weitere Informationen zu Routingkonventionen in Razor Pages finden Sie unter <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="76246-885">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="76246-886">[Anzeigen oder Herunterladen von Beispielcode](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([Vorgehensweise zum Herunterladen](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="76246-886">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="76246-887">Routinggrundlagen</span><span class="sxs-lookup"><span data-stu-id="76246-887">Routing basics</span></span>

<span data-ttu-id="76246-888">Für die meisten Apps sollte eine grundlegendes und beschreibendes Routingschema ausgewählt werden, um lesbare und aussagekräftige URLs zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="76246-888">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="76246-889">Für die konventionelle Standardroute `{controller=Home}/{action=Index}/{id?}` gilt:</span><span class="sxs-lookup"><span data-stu-id="76246-889">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="76246-890">Sie unterstützt ein grundlegendes und beschreibendes Routingschema.</span><span class="sxs-lookup"><span data-stu-id="76246-890">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="76246-891">Sie stellt einen nützlichen Startpunkt für benutzeroberflächenbasierte Apps dar.</span><span class="sxs-lookup"><span data-stu-id="76246-891">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="76246-892">Entwickler fügen in der Regel in speziellen Situationen durch [Attributrouting](xref:mvc/controllers/routing#attribute-routing) oder dedizierte konventionelle Routen zusätzliche kurze Routen zu stark frequentierten Bereichen der App hinzu.</span><span class="sxs-lookup"><span data-stu-id="76246-892">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span> <span data-ttu-id="76246-893">Beispiele für spezielle Situationen sind unter anderem Blog- und E-Commerce-Endpunkte.</span><span class="sxs-lookup"><span data-stu-id="76246-893">Specialized situations examples include, blog and ecommerce endpoints.</span></span>

<span data-ttu-id="76246-894">Web-APIs sollten das Attributrouting verwenden, um die Funktionalität der App als einen Satz von Ressourcen zu modellieren, bei denen Vorgänge durch HTTP-Verben dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-894">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="76246-895">Dies bedeutet, dass viele Vorgänge, z. B. GET und POST, für dieselbe logische Ressource dieselbe URL verwenden.</span><span class="sxs-lookup"><span data-stu-id="76246-895">This means that many operations, for example, GET, and POST, on the same logical resource use the same URL.</span></span> <span data-ttu-id="76246-896">Das Attributrouting bietet eine Ebene der Steuerung, die für einen sorgfältigen Entwurf des öffentlichen Endpunktlayouts einer API erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="76246-896">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="76246-897">Razor Pages-Apps verwenden konventionelles Standardrouting, um benannte Ressourcen im *Razor*-Ordner einer App bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="76246-897">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="76246-898">Außerdem gibt es weitere Konventionen zum Anpassen des Routingverhaltens für Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="76246-898">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="76246-899">Weitere Informationen finden Sie unter <xref:razor-pages/index> und <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="76246-899">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="76246-900">Die Unterstützung zum Generieren von URLs ermöglicht es, die App ohne Hartcodierung der URLs zum Verlinken der App zu entwickeln.</span><span class="sxs-lookup"><span data-stu-id="76246-900">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="76246-901">Auf diese Weise kann mit einer grundlegenden Routingkonfiguration begonnen werden, und die Routen können geändert werden, wenn das Ressourcenlayout der App festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="76246-901">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="76246-902">Es werden *Endpunkte* (`Endpoint`) für das Routing verwendet, um logische Endpunkte in einer App darzustellen.</span><span class="sxs-lookup"><span data-stu-id="76246-902">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="76246-903">Ein Endpunkt definiert einen Delegaten zum Verarbeiten von Anforderungen und eine Sammlung von beliebigen Metadaten.</span><span class="sxs-lookup"><span data-stu-id="76246-903">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="76246-904">Die Metadaten werden zur Implementierung von übergreifenden Belangen verwendet, die auf Richtlinien und der Konfiguration basieren, die den einzelnen Endpunkten angefügt sind.</span><span class="sxs-lookup"><span data-stu-id="76246-904">The metadata is used implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="76246-905">Das Routingsystem weist die folgenden Eigenschaften auf:</span><span class="sxs-lookup"><span data-stu-id="76246-905">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="76246-906">Die Syntax der Routenvorlage wird zum Definieren von Routen mit Routenparametern verwendet, die mit Token versehen sind.</span><span class="sxs-lookup"><span data-stu-id="76246-906">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="76246-907">Sowohl die konventionelle Endpunktkonfiguration als auch die Endpunktkonfiguration mit Attributen ist zulässig.</span><span class="sxs-lookup"><span data-stu-id="76246-907">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="76246-908"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> wird verwendet, um zu bestimmen, ob ein URL-Parameter einen gültigen Wert für eine bestimmte Endpunkteinschränkung enthält.</span><span class="sxs-lookup"><span data-stu-id="76246-908"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="76246-909">App-Modelle wie MVC bzw. Razor Pages registrieren sämtliche ihrer Endpunkte, für die die Implementierung von Routingszenarios vorhersagbar ist.</span><span class="sxs-lookup"><span data-stu-id="76246-909">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="76246-910">Die Routingimplementierung trifft Routingentscheidungen, wenn diese in der Middlewarepipeline gewünscht sind.</span><span class="sxs-lookup"><span data-stu-id="76246-910">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="76246-911">Middleware, die nach Routingmiddleware angezeigt wird, kann das Ergebnis der Endpunktentscheidung der Routingmiddleware untersuchen, die für einen bestimmten Anforderungs-URI getroffen wurde.</span><span class="sxs-lookup"><span data-stu-id="76246-911">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="76246-912">Alle diese Endpunkte können an einer beliebigen Stelle in der Middlewarepipeline in der App aufgelistet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-912">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="76246-913">Apps können mithilfe von Routing URLs generieren (z. B. für Umleitungen oder Links), die auf Endpunktinformationen basieren. Dadurch wird die Erstellung von hartcodierten URLs verhindert, was wiederrum die Wartbarkeit verbessert.</span><span class="sxs-lookup"><span data-stu-id="76246-913">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="76246-914">Die URL-Generierung basiert auf Adressen, die beliebige Erweiterbarkeit unterstützen:</span><span class="sxs-lookup"><span data-stu-id="76246-914">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="76246-915">Die API zur Linkgenerierung (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) kann mithilfe von [Dependency Injection](xref:fundamentals/dependency-injection) an jeder beliebigen Stelle aufgelöst werden, um URLs zu generieren.</span><span class="sxs-lookup"><span data-stu-id="76246-915">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="76246-916">Wenn diese API nicht über Dependency Injection verfügbar ist, bietet <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> Methoden zum Erstellen von URLs.</span><span class="sxs-lookup"><span data-stu-id="76246-916">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="76246-917">Mit der Freigabe des Endpunktroutings in ASP.NET Core 2.2 wird die Endpunktverknüpfung auf MVC- bzw. Razor Pages-Aktionen und -Seiten eingeschränkt.</span><span class="sxs-lookup"><span data-stu-id="76246-917">With the release of endpoint routing in ASP.NET Core 2.2, endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="76246-918">Zukünftige Releases sollen Erweiterungen für Funktionen zur Verknüpfung von Endpunkten enthalten.</span><span class="sxs-lookup"><span data-stu-id="76246-918">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="76246-919">Die Routingfunktionalität wird über die Klasse <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> mit der [Middlewarepipeline](xref:fundamentals/middleware/index) verbunden.</span><span class="sxs-lookup"><span data-stu-id="76246-919">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="76246-920">[ASP.NET Core-MVC](xref:mvc/overview) fügt im Rahmen der Konfiguration die Routingfunktionalität der Middlewarepipeline hinzu und verarbeitet das Routing in MVC- und Razor Pages-Apps.</span><span class="sxs-lookup"><span data-stu-id="76246-920">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="76246-921">Informationen darüber, wie Sie Routing als eigenständige Komponente verwenden, finden Sie im Abschnitt [Verwenden von Routingmiddleware](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="76246-921">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="76246-922">URL-Zuordnung</span><span class="sxs-lookup"><span data-stu-id="76246-922">URL matching</span></span>

<span data-ttu-id="76246-923">Bei einer URL-Zuordnung werden eingehende Anforderungen durch Routing an einen *Endpunkt* gesendet.</span><span class="sxs-lookup"><span data-stu-id="76246-923">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="76246-924">Für diesen Prozess werden die Daten des URL-Pfads verwendet. Es können jedoch auch alle Daten der Anforderung genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-924">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="76246-925">Für die Skalierung der Größe und Komplexität einer App ist das Versenden von Anforderungen an unterschiedliche Handler entscheidend.</span><span class="sxs-lookup"><span data-stu-id="76246-925">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="76246-926">Das Routingsystem ist beim Endpunktrouting für alle Weiterleitungsentscheidungen zuständig.</span><span class="sxs-lookup"><span data-stu-id="76246-926">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="76246-927">Da die Middleware basierend auf dem ausgewählten Endpunkt Richtlinien anwendet, ist es wichtig, dass jede Entscheidung, die die Weiterleitung oder die Anwendung von Sicherheitsrichtlinien beeinträchtigen kann, innerhalb des Routingsystems getroffen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-927">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="76246-928">Wenn der Endpunktdelegat ausgeführt wird, werden die Eigenschaften von [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) auf Grundlage der bisher verarbeiteten Anforderungen auf entsprechende Werte festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-928">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="76246-929">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) ist ein Wörterbuch mit *Routenwerten*, das aus der Route erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-929">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="76246-930">Die Werte werden in der Regel durch die Tokenisierung der URL ermittelt und können so verwendet werden, dass Benutzereingaben akzeptiert oder weitere Entscheidungen in der App zum Versenden von Anforderungen getroffen werden.</span><span class="sxs-lookup"><span data-stu-id="76246-930">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="76246-931">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) ist eine Eigenschaftensammlung mit zusätzlichen Daten zur zugeordneten Route.</span><span class="sxs-lookup"><span data-stu-id="76246-931">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="76246-932"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> werden bereitgestellt, damit sich jeder Route Zustandsdaten zuordnen lassen, sodass in der App später Entscheidungen auf Grundlage der zugeordneten Route getroffen werden können.</span><span class="sxs-lookup"><span data-stu-id="76246-932"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="76246-933">Diese Werte werden vom Entwickler vorgegeben und beeinflussen das Routingverhalten **in keiner Weise**.</span><span class="sxs-lookup"><span data-stu-id="76246-933">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="76246-934">Außerdem können im Gegensatz zu [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), die sich in bzw. aus Zeichenfolgen konvertieren lassen müssen, Werte in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) einem beliebigen Typ entsprechen.</span><span class="sxs-lookup"><span data-stu-id="76246-934">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="76246-935">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) ist eine Liste der Routen, die an der Zuordnung der Anforderung beteiligt waren.</span><span class="sxs-lookup"><span data-stu-id="76246-935">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="76246-936">Routen können in anderen Routen geschachtelt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-936">Routes can be nested inside of one another.</span></span> <span data-ttu-id="76246-937">Die <xref:Microsoft.AspNetCore.Routing.RouteData.Routers>-Eigenschaft stellt den Pfad mithilfe der logischen Routenstruktur dar, die zu der Zuordnung geführt hat.</span><span class="sxs-lookup"><span data-stu-id="76246-937">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="76246-938">Üblicherweise ist das erste Element in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> die Routensammlung. Dieses sollte zur URL-Generierung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-938">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="76246-939">Das letzte Element in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> ist der Routenhandler, für den eine Zuordnung vorgenommen wurde.</span><span class="sxs-lookup"><span data-stu-id="76246-939">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="76246-940">URL-Generierung mit LinkGenerator</span><span class="sxs-lookup"><span data-stu-id="76246-940">URL generation with LinkGenerator</span></span>

<span data-ttu-id="76246-941">Bei der URL-Generierung wird durch Routing ein URL-Pfad basierend auf mehreren Routenwerten erstellt.</span><span class="sxs-lookup"><span data-stu-id="76246-941">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="76246-942">Dies ermöglicht eine logische Trennung zwischen den Endpunkten und den URLs, die auf diese zugreifen.</span><span class="sxs-lookup"><span data-stu-id="76246-942">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="76246-943">Das Endpunktrouting umfasst die API zur Linkgenerierung (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span><span class="sxs-lookup"><span data-stu-id="76246-943">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="76246-944"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> ist ein Singletondienst, der über [DI](xref:fundamentals/dependency-injection) abgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="76246-944"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="76246-945">Die API kann außerhalb des Kontexts einer ausgeführten Anforderung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-945">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="76246-946"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> und Szenarios für MVC, die von <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> abhängig sind (z. B. [Taghilfsprogramme](xref:mvc/views/tag-helpers/intro), HTML-Hilfsprogramme und [Aktionsergebnisse](xref:mvc/controllers/actions)), verwenden die API zur Linkgenerierung, um entsprechende Funktionen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="76246-946">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="76246-947">Die API zur Linkgenerierung wird von Konzepten wie *Adressen* und *Adressschemas* unterstützt.</span><span class="sxs-lookup"><span data-stu-id="76246-947">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="76246-948">Sie können mithilfe eines Adressschemas die Endpunkte bestimmen, die bei der Linkgenerierung berücksichtigt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="76246-948">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="76246-949">Beispielsweise werden Routennamen und Routenwerte als Adressschemas implementiert. Diese Szenarios kennen viele Benutzer von MVC bzw. Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="76246-949">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="76246-950">Die API zur Linkgenerierung kann MVC- bzw. Razor Pages-Aktionen und Seiten über die folgenden Erweiterungsmethoden miteinander verknüpfen:</span><span class="sxs-lookup"><span data-stu-id="76246-950">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="76246-951">Beim Überladen dieser Methoden werden Argumente akzeptiert, die den `HttpContext` umfassen.</span><span class="sxs-lookup"><span data-stu-id="76246-951">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="76246-952">Diese Methoden sind zwar in funktionaler Hinsicht äquivalent zu `Url.Action` und `Url.Page`, bieten aber zusätzliche Flexibilität und Optionen.</span><span class="sxs-lookup"><span data-stu-id="76246-952">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="76246-953">Die `GetPath*`-Methoden sind `Url.Action` und `Url.Page` in der Hinsicht ähnlich, dass sie einen URI mit einem absoluten Pfad generieren.</span><span class="sxs-lookup"><span data-stu-id="76246-953">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="76246-954">Die `GetUri*`-Methoden generieren immer einen absoluten URI mit einem Schema und einem Host.</span><span class="sxs-lookup"><span data-stu-id="76246-954">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="76246-955">Die Methoden, die einen `HttpContext` akzeptieren, generieren im Kontext der ausgeführten Anforderung einen URI.</span><span class="sxs-lookup"><span data-stu-id="76246-955">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="76246-956">Die Umgebungsroutenwerte, der URL-basierte Pfad, das Schema und der Host von der ausführenden Anforderung werden so lange verwendet, bis sie außer Kraft gesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-956">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="76246-957"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> wird mit einer Adresse aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="76246-957"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="76246-958">Ein URI wird in zwei Schritten generiert:</span><span class="sxs-lookup"><span data-stu-id="76246-958">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="76246-959">Eine Adresse wird an eine Liste von Endpunkten gebunden, die der Adresse zugeordnet werden können.</span><span class="sxs-lookup"><span data-stu-id="76246-959">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="76246-960">Jedes `RoutePattern` eines Endpunkts wird bewertet, bis ein Routenmuster gefunden wird, das den angegebenen Werten zugeordnet werden kann.</span><span class="sxs-lookup"><span data-stu-id="76246-960">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="76246-961">Die daraus resultierende Ausgabe wird mit URI-Teilen kombiniert, die für die API zur Linkgenerierung bereitgestellt wird, und zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="76246-961">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="76246-962">Die von <xref:Microsoft.AspNetCore.Routing.LinkGenerator> bereitgestellten Methoden unterstützen die Standardfunktionen zur Generierung von Links für jeden beliebigen Adresstypen.</span><span class="sxs-lookup"><span data-stu-id="76246-962">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="76246-963">Am praktischsten ist es, die API zur Linkgenerierung mit Erweiterungsmethoden zu verwenden, die Vorgänge für einen bestimmten Adresstypen ausführen.</span><span class="sxs-lookup"><span data-stu-id="76246-963">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="76246-964">Erweiterungsmethode</span><span class="sxs-lookup"><span data-stu-id="76246-964">Extension Method</span></span>   | <span data-ttu-id="76246-965">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="76246-965">Description</span></span>                                                         |
| ------------------ | ------------------------------------------------------------------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="76246-966">Generiert einen URI mit einem absoluten Pfad, der auf den angegebenen Werten basiert.</span><span class="sxs-lookup"><span data-stu-id="76246-966">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="76246-967">Generiert einen absoluten URI, der auf den angegebenen Werten basiert.</span><span class="sxs-lookup"><span data-stu-id="76246-967">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="76246-968">Beachten Sie die folgenden Implikationen zum Aufrufen von <xref:Microsoft.AspNetCore.Routing.LinkGenerator>-Methoden:</span><span class="sxs-lookup"><span data-stu-id="76246-968">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="76246-969">Verwenden Sie `GetUri*`-Erweiterungsmethoden in App-Konfigurationen, die den `Host`-Header von eingehenden Anforderungen nicht überprüfen, mit Bedacht.</span><span class="sxs-lookup"><span data-stu-id="76246-969">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="76246-970">Wenn der `Host`-Header von eingehenden Anforderungen nicht überprüft wird, können nicht vertrauenswürdige Anforderungseingaben zurück an den Client in URIs einer Ansicht bzw. Seite zurückgesendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-970">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="76246-971">Es wird empfohlen, dass alle Produktions-Apps ihren Server so konfigurieren, dass der `Host`-Header auf bekannte gültige Werte überprüft wird.</span><span class="sxs-lookup"><span data-stu-id="76246-971">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="76246-972">Verwenden Sie <xref:Microsoft.AspNetCore.Routing.LinkGenerator> in Kombination mit `Map` oder `MapWhen` in Middleware mit Bedacht.</span><span class="sxs-lookup"><span data-stu-id="76246-972">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="76246-973">`Map*` ändert den Basispfad der ausgeführten Anforderung. Dies beeinflusst die Ausgabe der Linkgenerierung.</span><span class="sxs-lookup"><span data-stu-id="76246-973">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="76246-974">Für alle <xref:Microsoft.AspNetCore.Routing.LinkGenerator>-APIs ist die Angabe eines Basispfads zulässig.</span><span class="sxs-lookup"><span data-stu-id="76246-974">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="76246-975">Geben Sie immer einen leeren Basispfad an, um den Einfluss von `Map*` auf die Linkgenerierung rückgängig zu machen.</span><span class="sxs-lookup"><span data-stu-id="76246-975">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="differences-from-earlier-versions-of-routing"></a><span data-ttu-id="76246-976">Unterschiede im Vergleich zu früheren Routingversionen</span><span class="sxs-lookup"><span data-stu-id="76246-976">Differences from earlier versions of routing</span></span>

<span data-ttu-id="76246-977">Es gibt einige Unterschiede zwischen dem Endpunktrouting in ASP.NET Core 2.2 oder höher und dem Routing in früheren Versionen von ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="76246-977">A few differences exist between endpoint routing in ASP.NET Core 2.2 or later and earlier versions of routing in ASP.NET Core:</span></span>

* <span data-ttu-id="76246-978">Das Endpunktroutingsystem unterstützt die <xref:Microsoft.AspNetCore.Routing.IRouter>-basierte Erweiterbarkeit einschließlich des Erbens von <xref:Microsoft.AspNetCore.Routing.Route> nicht.</span><span class="sxs-lookup"><span data-stu-id="76246-978">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="76246-979">Das Endpunktrouting unterstützt [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim) nicht.</span><span class="sxs-lookup"><span data-stu-id="76246-979">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="76246-980">Verwenden Sie die [Kompatibilitätsversion](xref:mvc/compatibility-version) für 2.1 (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`), um den Kompatibilitätsshim weiter zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="76246-980">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="76246-981">Das Verhalten des Endpunktroutings für die Schreibweise von generierten URIs ist bei der Verwendung von konventionellen Routen anders.</span><span class="sxs-lookup"><span data-stu-id="76246-981">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="76246-982">Sehen Sie sich die folgende Standardvorlage für Routen an:</span><span class="sxs-lookup"><span data-stu-id="76246-982">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="76246-983">Angenommen, Sie generieren mithilfe der folgenden Route einen Link zu einer Aktion:</span><span class="sxs-lookup"><span data-stu-id="76246-983">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="76246-984">Bei <xref:Microsoft.AspNetCore.Routing.IRouter>-basierten Routing generiert dieser Code einen URI von `/blog/ReadPost/17`, der die Schreibweise des angegebenen Routenwerts berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="76246-984">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="76246-985">Durch das Endpunktrouting in ASP.NET Core 2.2 oder höher wird `/Blog/ReadPost/17` hergestellt („Blog“ wird großgeschrieben).</span><span class="sxs-lookup"><span data-stu-id="76246-985">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="76246-986">Über das Endpunktrouting wird die `IOutboundParameterTransformer`-Schnittstelle bereitgestellt, die verwendet werden kann, um dieses Verhalten entweder global anzupassen oder auf unterschiedliche Konventionen zum Zuordnen von URLs anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="76246-986">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="76246-987">Weitere Informationen finden Sie im Abschnitt [Parametertransformatorreferenz](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-987">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="76246-988">Das Verhalten der von MVC bzw. Razor Pages mit konventionellen Routen verwendeten Linkgenerierung unterscheidet sich, wenn versucht wird, einen Controller bzw. eine Aktion oder Seite zu verknüpfen, die nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="76246-988">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="76246-989">Sehen Sie sich die folgende Standardvorlage für Routen an:</span><span class="sxs-lookup"><span data-stu-id="76246-989">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="76246-990">Angenommen, Sie generieren mithilfe der Standardvorlage wie folgt einen Link zu einer Aktion:</span><span class="sxs-lookup"><span data-stu-id="76246-990">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="76246-991">Bei `IRouter`-basiertem Routing ist das Ergebnis immer `/Blog/ReadPost/17`, auch wenn `BlogController` nicht vorhanden ist oder keine Aktionsmethode für `ReadPost` aufweist.</span><span class="sxs-lookup"><span data-stu-id="76246-991">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="76246-992">Erwartungsgemäß wird durch das Endpunktrouting in ASP.NET Core 2.2 oder höher `/Blog/ReadPost/17` erstellt, wenn die Aktionsmethode vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="76246-992">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="76246-993">*Wenn die Aktionsmethode allerdings nicht vorhanden ist, wird beim Endpunktrouting eine leere Zeichenfolge erstellt.*</span><span class="sxs-lookup"><span data-stu-id="76246-993">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="76246-994">Vom Konzept her wird beim Endpunktrouting nicht angenommen, dass der Endpunkt vorhanden ist, wenn es die Aktion nicht gibt.</span><span class="sxs-lookup"><span data-stu-id="76246-994">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="76246-995">Das Verhalten des *Algorithmus zum Aufheben der Gültigkeit von Umgebunsgwerten* bei der Linkgenerierung ist anders, wenn dieser im Zusammenhang mit dem Endpunktrouting verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="76246-995">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="76246-996">Anhand des Algorithmus *zum Aufheben der Gültigkeit von Umgebungswerten* wird entschieden, welche Routenwerte der zu diesem Zeitpunkt ausgeführten Anforderung (die Umgebunsgwerte) für die Linkgenerierung verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="76246-996">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="76246-997">Beim konventionellen Routing wurde stets die Gültigkeit von zusätzlichen Routenwerten aufgehoben, wenn eine Verknüpfung zu einer anderen Aktion hergestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="76246-997">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="76246-998">Beim Attributrouting ist dieses Verhalten vor dem Release von ASP.NET Core 2.2 nicht aufgetreten.</span><span class="sxs-lookup"><span data-stu-id="76246-998">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="76246-999">In früheren Versionen von ASP.NET Core wurden beim Herstellen von Verknüpfungen mit einer anderen Aktion, die dieselben Namen für Routenparameter verwendete, ein Fehler bei der Linkgenerierung ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="76246-999">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="76246-1000">In ASP.NET Core 2.2 oder höher wird bei beiden Arten des Routings die Gültigkeit von Werten aufgehoben, wenn eine Verknüpfung zu einer anderen Aktion hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1000">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="76246-1001">Sehen Sie sich das folgende Beispiel in ASP.NET Core 2.1 oder früher an.</span><span class="sxs-lookup"><span data-stu-id="76246-1001">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="76246-1002">Wenn eine Verknüpfung zu einer anderen Aktion (oder Seite) hergestellt wird, können Routenwerte auf unerwünschte Weise wiederverwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1002">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="76246-1003">In */Pages/Store/Product.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="76246-1003">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="76246-1004">In */Pages/Login.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="76246-1004">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="76246-1005">Wenn der URI in ASP.NET Core 2.1 oder früher `/Store/Product/18` ist, ist der Link, der von `@Url.Page("/Login")` auf der Speicher- bzw. Informationsseite generiert wird, `/Login/18`.</span><span class="sxs-lookup"><span data-stu-id="76246-1005">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="76246-1006">Der `id`-Wert von 18 wird wiederverwendet, obwohl das Ziel des Links ein vollkommen anderer Teil der App ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1006">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="76246-1007">Bei dem `id`-Routenwert im Kontext der `/Login`-Seite handelt es sich wahrscheinlich um den Wert einer Benutzer-ID und nicht um einen Wert einer Speicherprodukt-ID.</span><span class="sxs-lookup"><span data-stu-id="76246-1007">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="76246-1008">Beim Endpunktrouting mit ASP.NET Core 2.2 oder höher lautet das Ergebnis `/Login`.</span><span class="sxs-lookup"><span data-stu-id="76246-1008">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="76246-1009">Umgebungswerte werden nicht wiederverwendet, wenn das verknüpfte Ziel eine andere Aktion oder Seite ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1009">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="76246-1010">Syntax für Routenparameter für Roundtrips: Schrägstriche werden nicht codiert, wenn eine Syntax mit zwei Sternchen (`**`) für Catch-All-Parameter verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1010">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="76246-1011">Bei der Linkgenerierung codiert das Routingsystem mit Ausnahme von Schrägstrichen den Wert in einem Catch-All-Parameter, dem zwei Sternchen voranstehen (`**`), z. B. `{**myparametername}`.</span><span class="sxs-lookup"><span data-stu-id="76246-1011">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="76246-1012">Der Catch-All-Parameter mit zwei Sternchen wird beim `IRouter`-basierten Routing in ASP.NET Core 2.2 oder höher unterstützt.</span><span class="sxs-lookup"><span data-stu-id="76246-1012">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="76246-1013">Die Syntax mit einem Sternchen für Catch-All-Parameter in früheren Versionen von ASP.NET Core (`{*myparametername}`) wird weiter unterstützt, und Schrägstriche werden codiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1013">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="76246-1014">Route</span><span class="sxs-lookup"><span data-stu-id="76246-1014">Route</span></span>              | <span data-ttu-id="76246-1015">Link generiert mit:</span><span class="sxs-lookup"><span data-stu-id="76246-1015">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="76246-1016">`/search/admin%2Fproducts` (der Schrägstrich wird codiert)</span><span class="sxs-lookup"><span data-stu-id="76246-1016">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="76246-1017">Middlewarebeispiel</span><span class="sxs-lookup"><span data-stu-id="76246-1017">Middleware example</span></span>

<span data-ttu-id="76246-1018">Im folgenden Beispiel verwendet eine Middleware die <xref:Microsoft.AspNetCore.Routing.LinkGenerator>-API, um eine Verknüpfung zu einer Aktionsmethode herzustellen, die Speicherprodukte aufführt.</span><span class="sxs-lookup"><span data-stu-id="76246-1018">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="76246-1019">Sie können für jede beliebige Klasse in einer App die API zur Linkgenerierung verwenden, indem Sie diese in eine Klasse einfügen und `GenerateLink` aufrufen.</span><span class="sxs-lookup"><span data-stu-id="76246-1019">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="76246-1020">Erstellen von Routen</span><span class="sxs-lookup"><span data-stu-id="76246-1020">Create routes</span></span>

<span data-ttu-id="76246-1021">Die meisten Apps erstellen Routen, indem sie <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> oder eine ähnliche Erweiterungsmethode aufrufen, die in <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> definiert ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1021">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="76246-1022">All diese <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>-Erweiterungsmethoden erstellen eine Instanz von <xref:Microsoft.AspNetCore.Routing.Route> und fügen diese der Routensammlung hinzu.</span><span class="sxs-lookup"><span data-stu-id="76246-1022">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="76246-1023"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> akzeptiert keine Routenhandlerparameter.</span><span class="sxs-lookup"><span data-stu-id="76246-1023"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="76246-1024">Durch <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> werden nur Routen hinzugefügt, die vom <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*> verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1024"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="76246-1025">Weitere Informationen zum Routing in MVC finden Sie unter <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="76246-1025">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="76246-1026">Im folgenden Codebeispiel wird ein <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>-Aufruf dargestellt, der von einer typischen ASP.NET Core MVC-Routendefinition verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="76246-1026">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="76246-1027">Diese Vorlage ordnet einen URL-Pfad zu und extrahiert die Routenwerte.</span><span class="sxs-lookup"><span data-stu-id="76246-1027">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="76246-1028">Beispielsweise generiert der Pfad `/Products/Details/17` die folgenden Routenwerte: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="76246-1028">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="76246-1029">Routenwerte werden ermittelt, indem der URL-Pfad in Segmente aufgeteilt wird und jedes Segment mit dem Namen des *Routenparameters* in der Routenvorlage abgeglichen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1029">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="76246-1030">Jeder Routenparameter hat einen Namen.</span><span class="sxs-lookup"><span data-stu-id="76246-1030">Route parameters are named.</span></span> <span data-ttu-id="76246-1031">Die Parameter werden von Klammern `{ ... }` eingeschlossen und dadurch definiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1031">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="76246-1032">Die obige Vorlage kann auch dem URL-Pfad `/` zugeordnet werden und daraus die Werte `{ controller = Home, action = Index }` generieren.</span><span class="sxs-lookup"><span data-stu-id="76246-1032">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="76246-1033">Dies liegt daran, dass die Routenparameter `{controller}` und `{action}` über Standardwerte verfügen und der Routenparameter `id` optional ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1033">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="76246-1034">Hinter dem Namen des Routenparameters steht das Gleichheitszeichen (`=`), auf das der Wert folgt, der als Standardwert für den Parameter definiert wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1034">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="76246-1035">Durch ein Fragezeichen (`?`) nach dem Namen des Routenparameters wird ein optionaler Parameter definiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1035">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="76246-1036">Durch Routenparameter mit einem Standardwert wird *immer* ein Routenwert erzeugt, wenn eine Übereinstimmung für die Route ermittelt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1036">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="76246-1037">Bei optionalen Parametern wird kein Routenwert generiert, wenn kein entsprechendes URL-Pfadsegment vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1037">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="76246-1038">Eine ausführliche Beschreibung zu den Szenarios und zur Syntax der Routenvorlage finden Sie unter [Referenz zu Routenvorlagen](#route-template-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-1038">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="76246-1039">Im folgenden Beispiel definiert die Routenparameterdefinition `{id:int}` eine [Routeneinschränkung](#route-constraint-reference) für den Routenparameter `id`:</span><span class="sxs-lookup"><span data-stu-id="76246-1039">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="76246-1040">Durch diese Vorlage wird bei einem Abgleich beispielsweise der URL-Pfad `/Products/Details/17`, aber nicht `/Products/Details/Apples` gefunden.</span><span class="sxs-lookup"><span data-stu-id="76246-1040">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="76246-1041">In derartigen Einschränkungen wird <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementiert, und die Routenwerte werden auf Gültigkeit geprüft.</span><span class="sxs-lookup"><span data-stu-id="76246-1041">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="76246-1042">Im obigen Beispiel muss sich der Routenwert `id` in einen Integer konvertieren lassen.</span><span class="sxs-lookup"><span data-stu-id="76246-1042">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="76246-1043">Weitere Informationen zu Routeneinschränkungen, die vom Framework bereitgestellt werden, finden Sie in der [Referenz zu Routeneinschränkungen](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-1043">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="76246-1044">Bei zusätzlichen Überladungen von <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> werden Werte für `constraints`, `dataTokens` und `defaults` akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1044">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="76246-1045">Üblicherweise werden diese Parameter so verwendet, dass ein Objekt eines anonymen Typs übergeben wird, in dem die Eigenschaftsnamen des anonymen Typs mit den Routenparameternamen abgeglichen werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1045">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="76246-1046">In den folgenden <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>-Beispielen werden identische Routen erstellt:</span><span class="sxs-lookup"><span data-stu-id="76246-1046">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="76246-1047">Für einfache Routen eignet sich die Inline-Syntax zum Definieren von Einschränkungen und Standardwerten.</span><span class="sxs-lookup"><span data-stu-id="76246-1047">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="76246-1048">Bestimmte Szenarios wie die Verwendung von Datentoken werden von dieser allerdings nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="76246-1048">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="76246-1049">Das folgende Beispiel veranschaulicht einige weitere Szenarios:</span><span class="sxs-lookup"><span data-stu-id="76246-1049">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="76246-1050">Diese Vorlage kann einem URL-Pfad wie `/Blog/All-About-Routing/Introduction` zugeordnet werden. Sie extrahier die `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`-Werte.</span><span class="sxs-lookup"><span data-stu-id="76246-1050">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="76246-1051">Die Standardroutenwerte für `controller` und `action` werden von der Route generiert, obwohl keine entsprechenden Routenparameter in der Vorlage vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="76246-1051">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="76246-1052">Standardwerte können in der Routenvorlage angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1052">Default values can be specified in the route template.</span></span> <span data-ttu-id="76246-1053">Der Routenparameter `article` wird durch zwei Sternchen (`**`) vor dem zugehörigen Namen als *Catch-All-Parameter* definiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1053">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="76246-1054">So wird der verbleibende Teil des URL-Pfads erfasst, und auch leere Zeichenfolgen können gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1054">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="76246-1055">Im folgenden Beispiel werden Routeneinschränkungen und Datentoken hinzugefügt:</span><span class="sxs-lookup"><span data-stu-id="76246-1055">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="76246-1056">Diese Vorlage kann einem URL-Pfad wie `/en-US/Products/5` zugeordnet werden, und die `{ controller = Products, action = Details, id = 5 }`-Werte und `{ locale = en-US }`-Datentoken werden extrahiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1056">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Gebietsschemas, Windows-Tokens](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="76246-1058">Generieren der URL zu einer Routenklasse</span><span class="sxs-lookup"><span data-stu-id="76246-1058">Route class URL generation</span></span>

<span data-ttu-id="76246-1059">Durch die Kombination von mehreren Routenwerten und der zugehörigen Routenvorlage kann die <xref:Microsoft.AspNetCore.Routing.Route>-Klasse auch URLs generieren.</span><span class="sxs-lookup"><span data-stu-id="76246-1059">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="76246-1060">Dieser Prozess verläuft umgekehrt zum Abgleich eines URL-Pfads.</span><span class="sxs-lookup"><span data-stu-id="76246-1060">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="76246-1061">Wenn Sie die URL-Generierung besser nachvollziehen möchten, sollten Sie sich überlegen, welche URL generiert werden soll und wie diese mithilfe der Routenvorlage abgeglichen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1061">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="76246-1062">Dabei sollten Sie auch darüber nachdenken, welche Werte erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1062">What values would be produced?</span></span> <span data-ttu-id="76246-1063">Dieser Vorgang entspricht in etwa der URL-Generierung in der <xref:Microsoft.AspNetCore.Routing.Route>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="76246-1063">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="76246-1064">Im folgenden Beispiel wird eine allgemeine Standardroute für ASP.NET Core-MVC verwendet:</span><span class="sxs-lookup"><span data-stu-id="76246-1064">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="76246-1065">Mithilfe der Routenwerte `{ controller = Products, action = List }` wird die URL `/Products/List` generiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1065">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="76246-1066">Die Routenwerte werden als Ersatz für die entsprechenden Routenparameter verwendet, wodurch ein URL-Pfad erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="76246-1066">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="76246-1067">Da es sich bei `id` um einen optionalen Routenparameter handelt, wird die URL erfolgreich ohne einen Wert für `id` generiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1067">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="76246-1068">Mithilfe der Routenwerte `{ controller = Home, action = Index }` wird die URL `/` generiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1068">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="76246-1069">Die bereitgestellten Routenwerte entsprechen den Standardwerten, sodass die Segmente, die mit diesen Werten übereinstimmen, problemlos ausgelassen werden können.</span><span class="sxs-lookup"><span data-stu-id="76246-1069">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="76246-1070">Mit beiden generierten URLs (`/Home/Index` und `/`) und dieser Routendefinition wird ein Roundtrip ausgeführt, und es werden dieselben Routenwerte erstellt, die auch zur Generierung der URL verwendet wurden.</span><span class="sxs-lookup"><span data-stu-id="76246-1070">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="76246-1071">Eine auf ASP.NET Core MVC basierende App sollte zur Generierung von URLs die Routingfunktion nicht direkt aufrufen, sondern <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> verwenden.</span><span class="sxs-lookup"><span data-stu-id="76246-1071">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="76246-1072">Weitere Informationen zur Generierung von URLs finden Sie im Abschnitt [Referenz zur URL-Generierung](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-1072">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="76246-1073">Verwenden von Routingmiddleware</span><span class="sxs-lookup"><span data-stu-id="76246-1073">Use Routing Middleware</span></span>

<span data-ttu-id="76246-1074">Legen Sie das [Microsoft.AspNetCore.App-Metapaket](xref:fundamentals/metapackage-app) in der Projektdatei der App als Verweis fest.</span><span class="sxs-lookup"><span data-stu-id="76246-1074">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="76246-1075">Fügen Sie anschließend dem Dienstcontainer in `Startup.ConfigureServices` die Routingfunktionalität hinzu:</span><span class="sxs-lookup"><span data-stu-id="76246-1075">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="76246-1076">Routen müssen in der `Startup.Configure`-Methode konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1076">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="76246-1077">In der Beispiel-App werden die folgenden APIs verwendet:</span><span class="sxs-lookup"><span data-stu-id="76246-1077">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="76246-1078"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Ordnet nut HTTP GET-Anforderungen zu.</span><span class="sxs-lookup"><span data-stu-id="76246-1078"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="76246-1079">In der folgenden Tabelle werden die Antworten mit den angegebenen URIs aufgelistet:</span><span class="sxs-lookup"><span data-stu-id="76246-1079">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="76246-1080">URI</span><span class="sxs-lookup"><span data-stu-id="76246-1080">URI</span></span>                    | <span data-ttu-id="76246-1081">Antwort</span><span class="sxs-lookup"><span data-stu-id="76246-1081">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="76246-1082">Hallo!</span><span class="sxs-lookup"><span data-stu-id="76246-1082">Hello!</span></span> <span data-ttu-id="76246-1083">Route values: [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="76246-1083">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="76246-1084">Hallo!</span><span class="sxs-lookup"><span data-stu-id="76246-1084">Hello!</span></span> <span data-ttu-id="76246-1085">Route values: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="76246-1085">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="76246-1086">Hallo!</span><span class="sxs-lookup"><span data-stu-id="76246-1086">Hello!</span></span> <span data-ttu-id="76246-1087">Route values: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="76246-1087">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="76246-1088">The request falls through, no match. (Die Anforderung ist fehlgeschlagen, keine Übereinstimmung.)</span><span class="sxs-lookup"><span data-stu-id="76246-1088">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="76246-1089">Hi, Joe!</span><span class="sxs-lookup"><span data-stu-id="76246-1089">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="76246-1090">The request falls through, matches HTTP GET only (Die Anforderung ist fehlgeschlagen, nur für eine HTTP-GET-Anforderung wird eine Übereinstimmung ermittelt)</span><span class="sxs-lookup"><span data-stu-id="76246-1090">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="76246-1091">The request falls through, no match. (Die Anforderung ist fehlgeschlagen, keine Übereinstimmung.)</span><span class="sxs-lookup"><span data-stu-id="76246-1091">The request falls through, no match.</span></span>              |

<span data-ttu-id="76246-1092">Das Framework stellt mehrere Erweiterungsmethoden zum Erstellen von Routen zur Verfügung (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="76246-1092">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="76246-1093">In den `Map[Verb]`-Methoden werden Einschränkungen verwendet, um die Route auf das HTTP-Verb im Methodennamen zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="76246-1093">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="76246-1094">Beispielsweise unter <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> und <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="76246-1094">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="76246-1095">Referenz für Routenvorlagen</span><span class="sxs-lookup"><span data-stu-id="76246-1095">Route template reference</span></span>

<span data-ttu-id="76246-1096">Token in geschweiften Klammern (`{ ... }`) definieren *Routenparameter*, die beim Abgleich der Route gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1096">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="76246-1097">Sie können in einem Routensegment mehrere Routenparameter definieren, wenn Sie sie durch einen Literalwert trennen.</span><span class="sxs-lookup"><span data-stu-id="76246-1097">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="76246-1098">`{controller=Home}{action=Index}` ist z.B. keine gültige Route, da sich zwischen `{controller}` und `{action}` kein Literalwert befindet.</span><span class="sxs-lookup"><span data-stu-id="76246-1098">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="76246-1099">Diese Routenparameter müssen einen Namen besitzen und können zusätzliche Attribute aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-1099">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="76246-1100">Eine Literalzeichenfolge, die nicht den Routenparametern entspricht (z.B. `{id}`), muss zusammen mit dem Pfadtrennzeichen `/` mit dem URL-Text übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="76246-1100">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="76246-1101">Beim Abgleich von Text wird nicht zwischen Groß-/Kleinbuchstaben unterschieden, und die Übereinstimmung basiert auf der decodierten Repräsentation des URL-Pfads.</span><span class="sxs-lookup"><span data-stu-id="76246-1101">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="76246-1102">Damit das Trennzeichen (`{` oder `}`) der Routenparameterliteralzeichenfolge bei einem Abgleich gefunden wird, muss es doppelt vorhanden sein (`{{` oder `}}`), was einem Escapezeichen entspricht.</span><span class="sxs-lookup"><span data-stu-id="76246-1102">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="76246-1103">Bei einem URL-Muster, durch das ein Dateiname mit einer optionalen Erweiterung erfasst werden soll, sind noch weitere Aspekte zu berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="76246-1103">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="76246-1104">Dies wird z.B. anhand der Vorlage `files/{filename}.{ext?}` deutlich.</span><span class="sxs-lookup"><span data-stu-id="76246-1104">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="76246-1105">Wenn sowohl für `filename` als auch für `ext` Werte vorhanden sind, werden beide Werte angegeben.</span><span class="sxs-lookup"><span data-stu-id="76246-1105">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="76246-1106">Wenn nur für `filename` ein Wert in der URL vorhanden ist, wird für die Route eine Zuordnung ermittelt, da der nachstehende Punkt (`.`) optional ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1106">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="76246-1107">Für die folgenden URLs wird eine Übereinstimmung für die Route ermittelt:</span><span class="sxs-lookup"><span data-stu-id="76246-1107">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="76246-1108">Sie können ein (`*`) oder zwei (`**`) Sternchen als Präfix für einen Routenparameter verwenden, um eine Bindung zum verbleibenden Teil des URI herzustellen.</span><span class="sxs-lookup"><span data-stu-id="76246-1108">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="76246-1109">Hierbei wird von *Catch-All*-Parametern gesprochen.</span><span class="sxs-lookup"><span data-stu-id="76246-1109">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="76246-1110">Durch `blog/{**slug}` wird beispielsweise jeder URI ermittelt, der mit `/blog` beginnt und dahinter einen beliebigen Wert aufweist, der dann dem `slug`-Routenwert zugeordnet wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1110">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="76246-1111">Durch Catch-All-Parameter können auch leere Zeichenfolgen gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1111">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="76246-1112">Der Catch-All-Parameter schützt die entsprechenden Zeichen (Escaping), wenn die Route verwendet wird, um eine URL, einschließlich Pfadtrennzeichen zu generieren (`/`).</span><span class="sxs-lookup"><span data-stu-id="76246-1112">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="76246-1113">Z.B. generiert die Route `foo/{*path}` mit den Routenwerten `{ path = "my/path" }``foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="76246-1113">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="76246-1114">Beachten Sie den umgekehrten Schrägstrich mit Escapezeichen.</span><span class="sxs-lookup"><span data-stu-id="76246-1114">Note the escaped forward slash.</span></span> <span data-ttu-id="76246-1115">Um Trennzeichen für Roundtrips einsetzen zu können, verwenden Sie das Routenparameterpräfix `**`.</span><span class="sxs-lookup"><span data-stu-id="76246-1115">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="76246-1116">Die Route `foo/{**path}` mit `{ path = "my/path" }` generiert `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="76246-1116">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="76246-1117">Routenparameter können über mehrere *Standardwerte* verfügen, die nach dem Parameternamen angegeben werden und durch ein Gleichheitszeichen (`=`) voneinander getrennt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1117">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="76246-1118">Mit `{controller=Home}` wird beispielsweise `Home` als Standardwert für `controller` definiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1118">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="76246-1119">Der Standardwert wird verwendet, wenn kein Wert in der Parameter-URL vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1119">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="76246-1120">Routenparameter sind optional, wenn am Ende des Parameternamens ein Fragezeichen (`?`) angefügt wird, z. B. `id?`.</span><span class="sxs-lookup"><span data-stu-id="76246-1120">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="76246-1121">Der Unterschied zwischen optionalen Parametern und Routenparametern mit einem Standardwert besteht darin, dass mithilfe der letzteren immer ein Wert erzeugt wird. Ein optionaler Parameter verfügt demgegenüber nur dann über einen Wert, wenn ein solcher von der Anforderungs-URL bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1121">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="76246-1122">Routenparameter können Einschränkungen aufweisen, die mit dem gebundenen Routenwert der URL übereinstimmen müssen.</span><span class="sxs-lookup"><span data-stu-id="76246-1122">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="76246-1123">Eine *Inline-Einschränkung* für einen Routenparameter geben Sie an, indem Sie hinter dem Namen des Routenparameters einen Doppelpunkt (`:`) und einen Einschränkungsnamen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="76246-1123">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="76246-1124">Wenn für die Einschränkung Argumente erforderlich sind, werden diese nach dem Einschränkungsnamen in Klammern (`(...)`) eingeschlossen.</span><span class="sxs-lookup"><span data-stu-id="76246-1124">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="76246-1125">Mehrere Inline-Einschränkungen können festgelegt werden, indem ein weiterer Doppelpunkt (`:`) und Einschränkungsname hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1125">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="76246-1126">Der Einschränkungsname und die Argumente werden dem <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver>-Dienst übergeben, wodurch eine Instanz von <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> für die URL-Verarbeitung erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="76246-1126">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="76246-1127">In der Routenvorlage `blog/{article:minlength(10)}` wird beispielsweise die Einschränkung `minlength` mit dem Argument `10` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-1127">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="76246-1128">Weitere Informationen zu Routeneinschränkungen und eine Liste der vom Framework bereitgestellten Einschränkungen finden Sie im Abschnitt [Referenz zu Routeneinschränkungen](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-1128">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="76246-1129">Routenparameter können darüber hinaus über Parametertransformatoren verfügen, die den Wert eines Parameters beim Generieren von Links umwandeln und Aktionen und Seiten an URLs anpassen.</span><span class="sxs-lookup"><span data-stu-id="76246-1129">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="76246-1130">Wie Einschränkungen können auch Parametertransformatoren einem Routenparameter inline hinzugefügt werden, indem ein Doppelpunkt (`:`) und der Name des Transformators hinter dem Namen des Routenparameters hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1130">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="76246-1131">In der Routenvorlage `blog/{article:slugify}` wird beispielsweise der Transformator `slugify` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-1131">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="76246-1132">Weitere Informationen zu Parametertransformatoren finden Sie im Abschnitt [Parametertransformatorreferenz](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-1132">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="76246-1133">Die folgende Tabelle enthält Beispielvorlagen für Routen und deren Verhalten.</span><span class="sxs-lookup"><span data-stu-id="76246-1133">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="76246-1134">Routenvorlage</span><span class="sxs-lookup"><span data-stu-id="76246-1134">Route Template</span></span>                           | <span data-ttu-id="76246-1135">Beispiel-URI für Übereinstimmung</span><span class="sxs-lookup"><span data-stu-id="76246-1135">Example Matching URI</span></span>    | <span data-ttu-id="76246-1136">Der Anforderungs-URI&hellip;</span><span class="sxs-lookup"><span data-stu-id="76246-1136">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="76246-1137">Nur für den Pfad `/hello` wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-1137">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="76246-1138">Eine Übereinstimmung wird ermittelt, und `Page` wird auf `Home` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-1138">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="76246-1139">Eine Übereinstimmung wird ermittelt, und `Page` wird auf `Contact` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-1139">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="76246-1140">Stimmt mit dem `Products`-Controller und der `List`-Aktion überein.</span><span class="sxs-lookup"><span data-stu-id="76246-1140">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="76246-1141">Stimmt mit dem `Products`-Controller und der `Details`-Aktion (`id` auf 123 festgelegt) überein.</span><span class="sxs-lookup"><span data-stu-id="76246-1141">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="76246-1142">Stimmt mit dem `Home`-Controller und der `Index`-Aktion überein (`id` wird ignoriert).</span><span class="sxs-lookup"><span data-stu-id="76246-1142">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="76246-1143">Mit Vorlagen lässt sich Routing besonders leicht durchführen.</span><span class="sxs-lookup"><span data-stu-id="76246-1143">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="76246-1144">Einschränkungen und Standardwerte können auch außerhalb der Routenvorlage angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1144">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="76246-1145">Wenn Sie die [Protokollierung](xref:fundamentals/logging/index) aktivieren, erfahren Sie, wie die integrierten Routingimplementierungen (z.B. <xref:Microsoft.AspNetCore.Routing.Route>) Zuordnungen für Anforderungen ermitteln.</span><span class="sxs-lookup"><span data-stu-id="76246-1145">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="76246-1146">Reservierte Routingnamen</span><span class="sxs-lookup"><span data-stu-id="76246-1146">Reserved routing names</span></span>

<span data-ttu-id="76246-1147">Die folgenden Schlüsselwörter sind reservierte Namen und können nicht als Routennamen oder Parameter verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="76246-1147">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="76246-1148">Referenz für Routeneinschränkungen</span><span class="sxs-lookup"><span data-stu-id="76246-1148">Route constraint reference</span></span>

<span data-ttu-id="76246-1149">Routeneinschränkungen werden angewendet, wenn eine Übereinstimmung mit der eingehenden URL gefunden wurde und der URL-Pfad in Routenwerten mit Token versehen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1149">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="76246-1150">In der Regel wird mit Routeneinschränkungen der Routenwert der zugehörigen Vorlage geprüft. Dabei wird bestimmt, ob der Wert gültig ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1150">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="76246-1151">Für einige Routeneinschränkungen werden anstelle des Routenwerts andere Daten verwendet, um zu ermitteln, ob das Routing einer Anforderung möglich ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1151">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="76246-1152"><xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> kann beispielsweise auf der Grundlage des HTTP-Verbs eine Anforderung entweder annehmen oder ablehnen.</span><span class="sxs-lookup"><span data-stu-id="76246-1152">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="76246-1153">Einschränkungen werden in Routinganforderungen und bei der Linkgenerierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-1153">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="76246-1154">Verwenden Sie keine Einschränkungen für die **Eingabeüberprüfung**.</span><span class="sxs-lookup"><span data-stu-id="76246-1154">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="76246-1155">Wenn bei der **Eingabevalidierung** Einschränkungen verwendet werden, lösen ungültige Eingaben den Fehler *404 - Not Found* (404 – Nicht gefunden) aus. Stattdessen sollte jedoch der Fehler *400 - Bad Request* (400 – Fehlerhafte Anforderung) ausgelöst und mit einer entsprechenden Fehlermeldung angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1155">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="76246-1156">Verwenden Sie Routeneinschränkungen nicht, um Eingaben für eine bestimmte Route zu überprüfen, sondern um ähnlichen Routen zu **unterscheiden**.</span><span class="sxs-lookup"><span data-stu-id="76246-1156">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="76246-1157">In der folgenden Tabelle werden Beispiele für Routeneinschränkungen und deren zu erwartendes Verhalten beschriebe.</span><span class="sxs-lookup"><span data-stu-id="76246-1157">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="76246-1158">Einschränkung</span><span class="sxs-lookup"><span data-stu-id="76246-1158">constraint</span></span> | <span data-ttu-id="76246-1159">Beispiel</span><span class="sxs-lookup"><span data-stu-id="76246-1159">Example</span></span> | <span data-ttu-id="76246-1160">Beispiele für Übereinstimmungen</span><span class="sxs-lookup"><span data-stu-id="76246-1160">Example Matches</span></span> | <span data-ttu-id="76246-1161">Hinweise</span><span class="sxs-lookup"><span data-stu-id="76246-1161">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="76246-1162">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="76246-1162">`123456789`, `-123456789`</span></span> | <span data-ttu-id="76246-1163">Für jeden Integer wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-1163">Matches any integer.</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="76246-1164">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="76246-1164">`true`, `FALSE`</span></span> | <span data-ttu-id="76246-1165">Entspricht `true` oder „FALSE“.</span><span class="sxs-lookup"><span data-stu-id="76246-1165">Matches `true` or \`false.</span></span> <span data-ttu-id="76246-1166">Groß-/Kleinschreibung wird nicht beachtet.</span><span class="sxs-lookup"><span data-stu-id="76246-1166">Case-insensitive.</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="76246-1167">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="76246-1167">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="76246-1168">Entspricht einem gültigen `DateTime`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-1168">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="76246-1169">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-1169">See  preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="76246-1170">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="76246-1170">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="76246-1171">Entspricht einem gültigen `decimal`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-1171">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="76246-1172">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-1172">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="76246-1173">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="76246-1173">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="76246-1174">Entspricht einem gültigen `double`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-1174">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="76246-1175">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-1175">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="76246-1176">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="76246-1176">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="76246-1177">Entspricht einem gültigen `float`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-1177">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="76246-1178">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-1178">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="76246-1179">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="76246-1179">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="76246-1180">Für einen gültigen `Guid`-Wert wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-1180">Matches a valid `Guid` value.</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="76246-1181">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="76246-1181">`123456789`, `-123456789`</span></span> | <span data-ttu-id="76246-1182">Für einen gültigen `long`-Wert wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-1182">Matches a valid `long` value.</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="76246-1183">Die Zeichenfolge muss mindestens eine Länge von 4 Zeichen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-1183">String must be at least 4 characters.</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="76246-1184">Die Zeichenfolge hat maximal 8 Zeichen.</span><span class="sxs-lookup"><span data-stu-id="76246-1184">String has maximum of 8 characters.</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="76246-1185">Die Zeichenfolge muss genau 12 Zeichen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-1185">String must be exactly 12 characters long.</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="76246-1186">Die Zeichenfolge muss mindestens 8 und darf maximal 16 Zeichen lang sein.</span><span class="sxs-lookup"><span data-stu-id="76246-1186">String must be at least 8 and has maximum of 16 characters.</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="76246-1187">Der ganzzahlige Wert muss mindestens 18 sein.</span><span class="sxs-lookup"><span data-stu-id="76246-1187">Integer value must be at least 18.</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="76246-1188">Der ganzzahlige Wert darf höchstens 120 sein.</span><span class="sxs-lookup"><span data-stu-id="76246-1188">Integer value maximum of 120.</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="76246-1189">Der ganzzahlige Wert muss mindestens 18 und darf höchstens 120 sein.</span><span class="sxs-lookup"><span data-stu-id="76246-1189">Integer value must be at least 18 and maximum of 120.</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="76246-1190">Die Zeichenfolge muss aus mindestens einem alphabetische Zeichen bestehen, `a`-`z`.</span><span class="sxs-lookup"><span data-stu-id="76246-1190">String must consist of one or more alphabetical characters `a`-`z`.</span></span>  <span data-ttu-id="76246-1191">Groß-/Kleinschreibung wird nicht beachtet.</span><span class="sxs-lookup"><span data-stu-id="76246-1191">Case-insensitive.</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="76246-1192">Die Zeichenfolge muss mit dem regulären Ausdruck übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="76246-1192">String must match the regular expression.</span></span> <span data-ttu-id="76246-1193">Weitere Informationen finden Sie unter Tipps zum Definieren eines regulären Ausdrucks.</span><span class="sxs-lookup"><span data-stu-id="76246-1193">See tips about defining a regular expression.</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="76246-1194">Hierdurch wird erzwungen, dass ein Wert, der kein Parameter ist, für die URL-Generierung vorhanden sein muss.</span><span class="sxs-lookup"><span data-stu-id="76246-1194">Used to enforce that a non-parameter value is present during URL generation.</span></span> |

<span data-ttu-id="76246-1195">Auf einen einzelnen Parameter können mehrere durch Doppelpunkte getrennte Einschränkungen angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1195">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="76246-1196">Durch die folgende Einschränkung wird ein Parameter beispielsweise auf einen Integerwert größer oder gleich 1 beschränkt:</span><span class="sxs-lookup"><span data-stu-id="76246-1196">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="76246-1197">Für Routeneinschränkungen, mit denen die URL überprüft wird und die in den CLR-Typ umgewandelt werden (beispielsweise `int` oder `DateTime`), wird immer die invariante Kultur verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-1197">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="76246-1198">Diese Einschränkungen setzen voraus, dass die URL nicht lokalisierbar ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1198">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="76246-1199">Die vom Framework bereitgestellten Routeneinschränkungen ändern nicht die Werte, die in Routenwerten gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="76246-1199">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="76246-1200">Alle Routenwerte, die aus der URL analysiert werden, werden als Zeichenfolgen gespeichert.</span><span class="sxs-lookup"><span data-stu-id="76246-1200">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="76246-1201">Durch die `float`-Einschränkung wird beispielsweise versucht, den Routenwert in einen Gleitkommawert zu konvertieren. Mit dem konvertierten Wert wird allerdings nur überprüft, ob eine Umwandlung überhaupt möglich ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1201">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="76246-1202">Reguläre Ausdrücke</span><span class="sxs-lookup"><span data-stu-id="76246-1202">Regular expressions</span></span>

<span data-ttu-id="76246-1203">Im ASP.NET Core-Framework wird dem Konstruktor für reguläre Ausdrücke `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="76246-1203">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="76246-1204">Eine Beschreibung dieser Member finden Sie unter <xref:System.Text.RegularExpressions.RegexOptions>.</span><span class="sxs-lookup"><span data-stu-id="76246-1204">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="76246-1205">In regulären Ausdrücken werden Trennzeichen und Token verwendet, die auch beim Routing und in der Programmiersprache C# in ähnlicher Weise verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1205">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="76246-1206">Token, die reguläre Ausdrücke enthalten, müssen mit einem Escapezeichen versehen werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1206">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="76246-1207">Der zu verwendende reguläre Ausdruck `^\d{3}-\d{2}-\d{4}$` für das Routing:</span><span class="sxs-lookup"><span data-stu-id="76246-1207">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing:</span></span>

* <span data-ttu-id="76246-1208">Der Ausdruck muss den einfachen umgekehrten Schrägstrich `\` enthalten, der im Quellcode in der Zeichenfolge als doppelter umgekehrter Schrägstrich `\\` vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1208">The expression must have the single backslash `\` characters provided in the string as double backslash `\\` characters in the source code.</span></span>
* <span data-ttu-id="76246-1209">Der reguläre Ausdruck muss `\\` verwenden, um die Zeichenfolge `\` mit Escapezeichen zu versehen.</span><span class="sxs-lookup"><span data-stu-id="76246-1209">The regular expression must us `\\` in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="76246-1210">Für den regulären Ausdruck ist `\\` nicht erforderlich, wenn [ausführliche Zeichenfolgenliterale](/dotnet/csharp/language-reference/keywords/string) verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1210">The regular expression doesn't require `\\` when using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="76246-1211">Wenn Sie Trennzeichen für Routenparameter mit Escapezeichen versehen möchten (`{`, `}`, `[`, `]`), geben Sie jedes Zeichen im Ausdruck doppelt ein (`{{`, `}`, `[[`, `]]`).</span><span class="sxs-lookup"><span data-stu-id="76246-1211">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression `{{`, `}`, `[[`, `]]`.</span></span> <span data-ttu-id="76246-1212">In der folgenden Tabelle werden reguläre Ausdrücke und Ausdrücke aufgeführt, die mit Escapezeichen versehen sind:</span><span class="sxs-lookup"><span data-stu-id="76246-1212">The following table shows a regular expression and the escaped version:</span></span>

| <span data-ttu-id="76246-1213">Regulärer Ausdruck</span><span class="sxs-lookup"><span data-stu-id="76246-1213">Regular Expression</span></span>    | <span data-ttu-id="76246-1214">Mit Escapezeichen versehener regulärer Ausdruck</span><span class="sxs-lookup"><span data-stu-id="76246-1214">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="76246-1215">Beim Routing verwendete reguläre Ausdrücke beginnen oft mit einem Caretzeichen (`^`) und stellen die Startposition der Zeichenfolge dar.</span><span class="sxs-lookup"><span data-stu-id="76246-1215">Regular expressions used in routing often start with the caret `^` character and match starting position of the string.</span></span> <span data-ttu-id="76246-1216">Die Ausdrücke enden häufig mit einem Dollarzeichen (`$`) und stellen das Ende der Zeichenfolge dar.</span><span class="sxs-lookup"><span data-stu-id="76246-1216">The expressions often end with the dollar sign `$` character and match end of the string.</span></span> <span data-ttu-id="76246-1217">Mit den Zeichen `^` und `$` wird sichergestellt, dass der reguläre Ausdruck mit dem vollständigen Routenparameterwert übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="76246-1217">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="76246-1218">Ohne die Zeichen `^` und `$` werden mit dem regulären Ausdruck alle Teilzeichenfolgen ermittelt, was häufig nicht gewünscht ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1218">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="76246-1219">In der folgenden Tabelle finden Sie Beispiele für reguläre Ausdrücke. Außerdem wird erklärt, warum ein Abgleich erfolgreich ist oder fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="76246-1219">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="76246-1220">expression</span><span class="sxs-lookup"><span data-stu-id="76246-1220">Expression</span></span>   | <span data-ttu-id="76246-1221">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="76246-1221">String</span></span>    | <span data-ttu-id="76246-1222">Match</span><span class="sxs-lookup"><span data-stu-id="76246-1222">Match</span></span> | <span data-ttu-id="76246-1223">Kommentar</span><span class="sxs-lookup"><span data-stu-id="76246-1223">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="76246-1224">hello</span><span class="sxs-lookup"><span data-stu-id="76246-1224">hello</span></span>     | <span data-ttu-id="76246-1225">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-1225">Yes</span></span>   | <span data-ttu-id="76246-1226">Teilzeichenfolge stimmt überein</span><span class="sxs-lookup"><span data-stu-id="76246-1226">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="76246-1227">123abc456</span><span class="sxs-lookup"><span data-stu-id="76246-1227">123abc456</span></span> | <span data-ttu-id="76246-1228">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-1228">Yes</span></span>   | <span data-ttu-id="76246-1229">Teilzeichenfolge stimmt überein</span><span class="sxs-lookup"><span data-stu-id="76246-1229">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="76246-1230">mz</span><span class="sxs-lookup"><span data-stu-id="76246-1230">mz</span></span>        | <span data-ttu-id="76246-1231">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-1231">Yes</span></span>   | <span data-ttu-id="76246-1232">Ausdruck stimmt überein</span><span class="sxs-lookup"><span data-stu-id="76246-1232">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="76246-1233">MZ</span><span class="sxs-lookup"><span data-stu-id="76246-1233">MZ</span></span>        | <span data-ttu-id="76246-1234">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-1234">Yes</span></span>   | <span data-ttu-id="76246-1235">keine Unterscheidung zwischen Groß-/Kleinbuchstaben</span><span class="sxs-lookup"><span data-stu-id="76246-1235">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="76246-1236">hello</span><span class="sxs-lookup"><span data-stu-id="76246-1236">hello</span></span>     | <span data-ttu-id="76246-1237">Nein</span><span class="sxs-lookup"><span data-stu-id="76246-1237">No</span></span>    | <span data-ttu-id="76246-1238">siehe Erläuterungen zu `^` und `$` oben</span><span class="sxs-lookup"><span data-stu-id="76246-1238">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="76246-1239">123abc456</span><span class="sxs-lookup"><span data-stu-id="76246-1239">123abc456</span></span> | <span data-ttu-id="76246-1240">Nein</span><span class="sxs-lookup"><span data-stu-id="76246-1240">No</span></span>    | <span data-ttu-id="76246-1241">siehe Erläuterungen zu `^` und `$` oben</span><span class="sxs-lookup"><span data-stu-id="76246-1241">See `^` and `$` above</span></span> |

<span data-ttu-id="76246-1242">Weitere Informationen zur Syntax von regulären Ausdrücken finden Sie unter [Sprachelemente für reguläre Ausdrücke – Kurzübersicht](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-1242">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="76246-1243">Einen regulären Ausdruck können Sie verwenden, um einen Parameter auf zulässige Werte einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="76246-1243">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="76246-1244">Mit `{action:regex(^(list|get|create)$)}` werden beispielsweise für den `action`-Routenwert nur die Werte `list`, `get` oder `create` abgeglichen.</span><span class="sxs-lookup"><span data-stu-id="76246-1244">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="76246-1245">Wenn die Zeichenfolge `^(list|get|create)$` dem Einschränkungswörterbuch übergeben wird, führt dies zum gleichen Ergebnis.</span><span class="sxs-lookup"><span data-stu-id="76246-1245">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="76246-1246">Auch Einschränkungen, die dem zugehörigen Wörterbuch hinzugefügt werden und mit keiner vorgegebenen Einschränkung übereinstimmen , werden als reguläre Ausdrücke behandelt. Dies gilt allerdings nicht für Inline-Einschränkungen in einer Vorlage.</span><span class="sxs-lookup"><span data-stu-id="76246-1246">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="76246-1247">Benutzerdefinierte Routeneinschränkungen</span><span class="sxs-lookup"><span data-stu-id="76246-1247">Custom route constraints</span></span>

<span data-ttu-id="76246-1248">Zusätzlich zu den integrierten Routeneinschränkungen können benutzerdefinierte Routeneinschränkungen durch Implementierung der <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>-Schnittstelle erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1248">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="76246-1249">Die <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>-Schnittstelle enthält eine einzelne Methode, `Match`, die `true` zurückgibt, wenn die Einschränkung erfüllt wird, und andernfalls `false`.</span><span class="sxs-lookup"><span data-stu-id="76246-1249">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="76246-1250">Zum Verwenden einer benutzerdefinierten <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> muss der Routeneinschränkungstyp bei der <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> der App im Dienstcontainer der App registriert werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1250">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="76246-1251">Eine <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> ist ein Wörterbuch, das Routeneinschränkungsschlüssel <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>-Implementierungen zuordnet, die diese Einschränkungen überprüfen.</span><span class="sxs-lookup"><span data-stu-id="76246-1251">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="76246-1252">Die <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> einer App kann in `Startup.ConfigureServices` entweder als Teil eines [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*)-Aufrufs oder durch direktes Konfigurieren von <xref:Microsoft.AspNetCore.Routing.RouteOptions> mit `services.Configure<RouteOptions>` aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1252">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="76246-1253">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="76246-1253">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="76246-1254">Die Einschränkung kann dann auf die übliche Weise mit dem bei der Registrierung des Einschränkungstyps angegebenen Namen auf Routen angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1254">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="76246-1255">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="76246-1255">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="76246-1256">Parametertransformatorreferenz</span><span class="sxs-lookup"><span data-stu-id="76246-1256">Parameter transformer reference</span></span>

<span data-ttu-id="76246-1257">Parametertransformatoren:</span><span class="sxs-lookup"><span data-stu-id="76246-1257">Parameter transformers:</span></span>

* <span data-ttu-id="76246-1258">Werden beim Generieren eines Links für eine <xref:Microsoft.AspNetCore.Routing.Route> ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="76246-1258">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="76246-1259">Implementieren Sie `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span><span class="sxs-lookup"><span data-stu-id="76246-1259">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="76246-1260">Werden mithilfe von <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="76246-1260">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="76246-1261">Nehmen den Routenwert des Parameters an und transformieren ihn in einen neuen Zeichenfolgenwert.</span><span class="sxs-lookup"><span data-stu-id="76246-1261">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="76246-1262">Haben die Verwendung des transformierten Wert in einem generierten Link zur Folge.</span><span class="sxs-lookup"><span data-stu-id="76246-1262">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="76246-1263">Beispielsweise generiert ein benutzerdefinierter Parametertransformator `slugify` im Routenmuster `blog\{article:slugify}` mit `Url.Action(new { article = "MyTestArticle" })``blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="76246-1263">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="76246-1264">Um einen Parametertransformator in einem Routenmuster zu verwenden, konfigurieren Sie ihn zuerst mit <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="76246-1264">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="76246-1265">Parametertransformatoren werden auch von Frameworks verwendet, um den URI zu transformieren, zu dem ein Endpunkt aufgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1265">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="76246-1266">Beispielsweise verwendet ASP.NET Core MVC Parametertransformatoren zum Transformieren des Routenwerts, der zum Zuordnen einer `area`, eines `controller`, einer `action` und einer `page` verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1266">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="76246-1267">Mit der vorstehenden Route wird die Aktion `SubscriptionManagementController.GetAll` dem URI `/subscription-management/get-all` zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="76246-1267">With the preceding route, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="76246-1268">Ein Parametertransformator ändert nicht die zum Generieren eines Links verwendeten Routenwerte.</span><span class="sxs-lookup"><span data-stu-id="76246-1268">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="76246-1269">Beispielsweise gibt `Url.Action("GetAll", "SubscriptionManagement")``/subscription-management/get-all` aus.</span><span class="sxs-lookup"><span data-stu-id="76246-1269">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="76246-1270">ASP.NET Core bietet API-Konventionen für die Verwendung von Parametertransformatoren mit generierten Routen:</span><span class="sxs-lookup"><span data-stu-id="76246-1270">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="76246-1271">ASP.NET Core MVC verwendet die `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention`-API-Konvention.</span><span class="sxs-lookup"><span data-stu-id="76246-1271">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="76246-1272">Diese Konvention wendet einen angegebenen Parametertransformator auf alle Attributrouten in der App an.</span><span class="sxs-lookup"><span data-stu-id="76246-1272">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="76246-1273">Der Parametertransformator transformiert Attributroutentoken, wenn diese ersetzt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1273">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="76246-1274">Weitere Informationen finden Sie unter [Verwenden eines Parametertransformators zum Anpassen der Tokenersetzung](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="76246-1274">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="76246-1275">Razor Pages verwendet die `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention`-API-Konvention.</span><span class="sxs-lookup"><span data-stu-id="76246-1275">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="76246-1276">Diese Konvention wendet einen angegebenen Parametertransformator auf alle automatisch erkannten Razor Pages-Seiten an.</span><span class="sxs-lookup"><span data-stu-id="76246-1276">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="76246-1277">Der Parametertransformator transformiert die Ordner- und Dateinamensegmente von Razor Pages-Routen.</span><span class="sxs-lookup"><span data-stu-id="76246-1277">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="76246-1278">Weitere Informationen finden Sie unter [Verwenden eines Parametertransformators zum Anpassen von Seitenrouten](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="76246-1278">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="76246-1279">Referenz für URL-Generierung</span><span class="sxs-lookup"><span data-stu-id="76246-1279">URL generation reference</span></span>

<span data-ttu-id="76246-1280">Im folgenden Beispiel wird gezeigt, wie Sie einen Link zu einer Route unter Berücksichtigung eines vorhandenen Wörterbuchs mit Routenwerten und einer <xref:Microsoft.AspNetCore.Routing.RouteCollection> erstellen.</span><span class="sxs-lookup"><span data-stu-id="76246-1280">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="76246-1281">Die <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath>-Eigenschaft, die am Ende des obigen Beispiels erstellt wird, hat den Wert `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="76246-1281">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="76246-1282">Das Wörterbuch stellt die Routenwerte von `operation` und `id` aus der Vorlage „Track Package Route“ (`package/{operation}/{id}`) bereit.</span><span class="sxs-lookup"><span data-stu-id="76246-1282">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="76246-1283">Weitere Informationen finden Sie im Beispielcode im Abschnitt [Verwenden von Routingmiddleware](#use-routing-middleware) oder in der [Beispiel-App](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="76246-1283">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="76246-1284">Der zweite Parameter für den <xref:Microsoft.AspNetCore.Routing.VirtualPathContext>-Konstruktor ist eine Auflistung von *Umgebungswerten*.</span><span class="sxs-lookup"><span data-stu-id="76246-1284">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="76246-1285">Mit diesen lässt sich leicht die Anzahl der Werte einschränken, die ein Entwickler innerhalb eines Anforderungskontexts angeben muss.</span><span class="sxs-lookup"><span data-stu-id="76246-1285">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="76246-1286">Die aktuellen Routenwerte der aktuellen Anforderung werden bei der Linkgenerierung als Umgebungswerte behandelt.</span><span class="sxs-lookup"><span data-stu-id="76246-1286">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="76246-1287">In einer ASP.NET Core-MVC-App müssen Sie innerhalb der `About`-Aktion von `HomeController` nicht den Controllerroutenwert angeben, um eine Verknüpfung mit der `Index`-Aktion herzustellen, da der Umgebungswert von `Home` verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1287">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="76246-1288">Umgebungswerte, die mit keinem Parameter übereinstimmen, werden ignoriert.</span><span class="sxs-lookup"><span data-stu-id="76246-1288">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="76246-1289">Außerdem werden Umgebungswerte ignoriert, wenn ein explizit angegebener Wert den betreffenden Umgebungswert außer Kraft setzt.</span><span class="sxs-lookup"><span data-stu-id="76246-1289">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="76246-1290">Der Abgleich in der URL wird von links nach rechts ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="76246-1290">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="76246-1291">Explizit bereitgestellte Werte, für die keine Übereinstimmungen mit einem Routensegment ermittelt werden, werden der Abfragezeichenfolge hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="76246-1291">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="76246-1292">In der folgenden Tabelle werden die Ergebnisse dargestellt, die aus der Verwendung der Routenvorlage `{controller}/{action}/{id?}` hervorgehen:</span><span class="sxs-lookup"><span data-stu-id="76246-1292">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="76246-1293">Umgebungswerte</span><span class="sxs-lookup"><span data-stu-id="76246-1293">Ambient Values</span></span>                     | <span data-ttu-id="76246-1294">Explizite Werte</span><span class="sxs-lookup"><span data-stu-id="76246-1294">Explicit Values</span></span>                        | <span data-ttu-id="76246-1295">Ergebnis</span><span class="sxs-lookup"><span data-stu-id="76246-1295">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="76246-1296">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="76246-1296">controller = "Home"</span></span>                | <span data-ttu-id="76246-1297">action = "About"</span><span class="sxs-lookup"><span data-stu-id="76246-1297">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="76246-1298">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="76246-1298">controller = "Home"</span></span>                | <span data-ttu-id="76246-1299">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="76246-1299">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="76246-1300">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="76246-1300">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="76246-1301">action = "About"</span><span class="sxs-lookup"><span data-stu-id="76246-1301">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="76246-1302">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="76246-1302">controller = "Home"</span></span>                | <span data-ttu-id="76246-1303">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="76246-1303">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="76246-1304">Wenn eine Route über einen Standardwert verfügt, der keinem Parameter entspricht, und dieser Wert explizit bereitgestellt wird, muss er dem Standardwert entsprechen:</span><span class="sxs-lookup"><span data-stu-id="76246-1304">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="76246-1305">Für diese Route wird nur dann ein Link generiert, wenn die übereinstimmenden Werte für `controller` und `action` bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1305">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="76246-1306">Komplexe Segmente</span><span class="sxs-lookup"><span data-stu-id="76246-1306">Complex segments</span></span>

<span data-ttu-id="76246-1307">Komplexe Segmente (z.B. `[Route("/x{token}y")]`) werden von rechts nach links auf eine nicht gierige Weise durch entsprechende Literale verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="76246-1307">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="76246-1308">Unter [diesem Code](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) finden Sie eine ausführliche Erklärung für das Abgleichen komplexer Segmente.</span><span class="sxs-lookup"><span data-stu-id="76246-1308">See [this code](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="76246-1309">Das [Codebeispiel](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) wird von ASP.NET Core nicht verwendet, aber es bietet eine gute Erklärung komplexer Segmente.</span><span class="sxs-lookup"><span data-stu-id="76246-1309">The [code sample](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/dotnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="76246-1310">Beim Routing werden Anforderungs-URIs Routenhandlern zugeordnet und Anforderungen weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="76246-1310">Routing is responsible for mapping request URIs to route handlers and dispatching an incoming requests.</span></span> <span data-ttu-id="76246-1311">Routen werden in der App definiert und beim Start der App konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="76246-1311">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="76246-1312">Eine Route kann optional Werte aus der URL extrahieren, die in der Anforderung enthalten ist. Diese Werte können anschließend für die Verarbeitung der Anforderung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1312">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="76246-1313">Unter Verwendung von konfigurierten Routen aus der App können durch das Routing URLs erstellt werden, die Routenhandlern zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1313">Using configured routes from the app, routing is able to generate URLs that map to route handlers.</span></span>

<span data-ttu-id="76246-1314">Wenn Sie die aktuellsten Routingszenarios in ASP.NET Core 2.1 verwenden möchten, geben Sie die [Kompatibilitätsversion](xref:mvc/compatibility-version) zur Registrierung der MVC-Dienste in `Startup.ConfigureServices` an:</span><span class="sxs-lookup"><span data-stu-id="76246-1314">To use the latest routing scenarios in ASP.NET Core 2.1, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
```

> [!IMPORTANT]
> <span data-ttu-id="76246-1315">In diesem Artikel wird das Low-Level-Routing in ASP.NET Core beschrieben.</span><span class="sxs-lookup"><span data-stu-id="76246-1315">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="76246-1316">Weitere Informationen zum Routing mit ASP.NET Core MVC finden Sie unter <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="76246-1316">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="76246-1317">Weitere Informationen zu Routingkonventionen in Razor Pages finden Sie unter <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="76246-1317">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="76246-1318">[Anzeigen oder Herunterladen von Beispielcode](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([Vorgehensweise zum Herunterladen](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="76246-1318">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="76246-1319">Routinggrundlagen</span><span class="sxs-lookup"><span data-stu-id="76246-1319">Routing basics</span></span>

<span data-ttu-id="76246-1320">Für die meisten Apps sollte eine grundlegendes und beschreibendes Routingschema ausgewählt werden, um lesbare und aussagekräftige URLs zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="76246-1320">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="76246-1321">Für die konventionelle Standardroute `{controller=Home}/{action=Index}/{id?}` gilt:</span><span class="sxs-lookup"><span data-stu-id="76246-1321">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="76246-1322">Sie unterstützt ein grundlegendes und beschreibendes Routingschema.</span><span class="sxs-lookup"><span data-stu-id="76246-1322">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="76246-1323">Sie stellt einen nützlichen Startpunkt für benutzeroberflächenbasierte Apps dar.</span><span class="sxs-lookup"><span data-stu-id="76246-1323">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="76246-1324">Entwickler fügen in der Regel in speziellen Situationen (z. B. bei Blog- und E-Commerce-Endpunkten) durch [Attributrouting](xref:mvc/controllers/routing#attribute-routing) oder dedizierte konventionelle Routen zusätzliche kurze Routen zu stark frequentierten Bereichen der App hinzu.</span><span class="sxs-lookup"><span data-stu-id="76246-1324">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="76246-1325">Web-APIs sollten das Attributrouting verwenden, um die Funktionalität der App als einen Satz von Ressourcen zu modellieren, bei denen Vorgänge durch HTTP-Verben dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1325">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="76246-1326">Dies bedeutet, dass viele Vorgänge (z.B. GET, POST) für dieselbe logische Ressource dieselbe URL verwenden.</span><span class="sxs-lookup"><span data-stu-id="76246-1326">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="76246-1327">Das Attributrouting bietet eine Ebene der Steuerung, die für einen sorgfältigen Entwurf des öffentlichen Endpunktlayouts einer API erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1327">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="76246-1328">Razor Pages-Apps verwenden konventionelles Standardrouting, um benannte Ressourcen im *Razor*-Ordner einer App bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="76246-1328">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="76246-1329">Außerdem gibt es weitere Konventionen zum Anpassen des Routingverhaltens für Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="76246-1329">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="76246-1330">Weitere Informationen finden Sie unter <xref:razor-pages/index> und <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="76246-1330">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="76246-1331">Die Unterstützung zum Generieren von URLs ermöglicht es, die App ohne Hartcodierung der URLs zum Verlinken der App zu entwickeln.</span><span class="sxs-lookup"><span data-stu-id="76246-1331">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="76246-1332">Auf diese Weise kann mit einer grundlegenden Routingkonfiguration begonnen werden, und die Routen können geändert werden, wenn das Ressourcenlayout der App festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="76246-1332">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="76246-1333">Beim Routing werden Routenimplementierungen von <xref:Microsoft.AspNetCore.Routing.IRouter> für Folgendes verwendet:</span><span class="sxs-lookup"><span data-stu-id="76246-1333">Routing uses routes implementations of <xref:Microsoft.AspNetCore.Routing.IRouter> to:</span></span>

* <span data-ttu-id="76246-1334">Zuordnen von eingehenden Anforderungen zu *Routenhandlern*</span><span class="sxs-lookup"><span data-stu-id="76246-1334">Map incoming requests to *route handlers*.</span></span>
* <span data-ttu-id="76246-1335">Generieren von URLs für Antworten</span><span class="sxs-lookup"><span data-stu-id="76246-1335">Generate the URLs used in responses.</span></span>

<span data-ttu-id="76246-1336">Eine App verfügt standardmäßig über genau eine Routensammlung.</span><span class="sxs-lookup"><span data-stu-id="76246-1336">By default, an app has a single collection of routes.</span></span> <span data-ttu-id="76246-1337">Wenn eine Anforderung eingeht, werden die Routen in der Sammlung in der Reihenfolge verarbeitet, in der sie in der Sammlung aufgelistet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1337">When a request arrives, the routes in the collection are processed in the order that they exist in the collection.</span></span> <span data-ttu-id="76246-1338">Dann versucht das Framework, eine eingehende Anforderungs-URL einer Route in der Sammlung zuzuordnen, indem es die <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*>-Methode für jede Route in der Sammlung aufruft.</span><span class="sxs-lookup"><span data-stu-id="76246-1338">The framework attempts to match an incoming request URL to a route in the collection by calling the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in the collection.</span></span> <span data-ttu-id="76246-1339">Bei einer Antwort kann Routing verwendet werden, um URLs zu generieren (z.B. für Umleitungen oder Links), die auf Routeninformationen basieren. Dadurch wird die Erstellung von hartcodierten URLs verhindert, was wiederrum die Wartbarkeit verbessert.</span><span class="sxs-lookup"><span data-stu-id="76246-1339">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>

<span data-ttu-id="76246-1340">Das Routingsystem weist die folgenden Eigenschaften auf:</span><span class="sxs-lookup"><span data-stu-id="76246-1340">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="76246-1341">Die Syntax der Routenvorlage wird zum Definieren von Routen mit Routenparametern verwendet, die mit Token versehen sind.</span><span class="sxs-lookup"><span data-stu-id="76246-1341">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="76246-1342">Sowohl die konventionelle Endpunktkonfiguration als auch die Endpunktkonfiguration mit Attributen ist zulässig.</span><span class="sxs-lookup"><span data-stu-id="76246-1342">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="76246-1343"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> wird verwendet, um zu bestimmen, ob ein URL-Parameter einen gültigen Wert für eine bestimmte Endpunkteinschränkung enthält.</span><span class="sxs-lookup"><span data-stu-id="76246-1343"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="76246-1344">App-Modelle wie MVC bzw Razor Pages registrieren sämtliche ihrer Routen, für die die Implementierung von Routingszenarios vorhersagbar ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1344">App models, such as MVC/Razor Pages, register all of their routes, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="76246-1345">Bei einer Antwort kann Routing verwendet werden, um URLs zu generieren (z.B. für Umleitungen oder Links), die auf Routeninformationen basieren. Dadurch wird die Erstellung von hartcodierten URLs verhindert, was wiederrum die Wartbarkeit verbessert.</span><span class="sxs-lookup"><span data-stu-id="76246-1345">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="76246-1346">Die URL-Generierung basiert auf Routen, die beliebige Erweiterbarkeit unterstützen.</span><span class="sxs-lookup"><span data-stu-id="76246-1346">URL generation is based on routes, which support arbitrary extensibility.</span></span> <span data-ttu-id="76246-1347"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> bietet Methoden zum Erstellen von URLs.</span><span class="sxs-lookup"><span data-stu-id="76246-1347"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>
<!-- fix [middleware](xref:fundamentals/middleware/index) -->
<span data-ttu-id="76246-1348">Die Routingfunktionalität wird über die <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>-Klasse mit der `[middleware](xref:fundamentals/middleware/index)`-Pipeline verbunden.</span><span class="sxs-lookup"><span data-stu-id="76246-1348">Routing is connected to the `[middleware](xref:fundamentals/middleware/index)` pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="76246-1349">[ASP.NET Core-MVC](xref:mvc/overview) fügt im Rahmen der Konfiguration die Routingfunktionalität der Middlewarepipeline hinzu und verarbeitet das Routing in MVC- und Razor Pages-Apps.</span><span class="sxs-lookup"><span data-stu-id="76246-1349">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="76246-1350">Informationen darüber, wie Sie Routing als eigenständige Komponente verwenden, finden Sie im Abschnitt [Verwenden von Routingmiddleware](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="76246-1350">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="76246-1351">URL-Zuordnung</span><span class="sxs-lookup"><span data-stu-id="76246-1351">URL matching</span></span>

<span data-ttu-id="76246-1352">Bei einer URL-Zuordnung werden eingehende Anforderungen durch Routing an einen *Handler* gesendet.</span><span class="sxs-lookup"><span data-stu-id="76246-1352">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="76246-1353">Für diesen Prozess werden die Daten des URL-Pfads verwendet. Es können jedoch auch alle Daten der Anforderung genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1353">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="76246-1354">Für die Skalierung der Größe und Komplexität einer App ist das Versenden von Anforderungen an unterschiedliche Handler entscheidend.</span><span class="sxs-lookup"><span data-stu-id="76246-1354">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="76246-1355">Eingehende Anforderungen werden vom <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>-Objekt bearbeitet, das die Methode <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> für alle Routen nacheinander aufruft.</span><span class="sxs-lookup"><span data-stu-id="76246-1355">Incoming requests enter the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, which calls the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in sequence.</span></span> <span data-ttu-id="76246-1356">In der <xref:Microsoft.AspNetCore.Routing.IRouter>-Instanz wird entschieden, ob die Anforderung *verarbeitet* wird, indem für den [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) ein <xref:Microsoft.AspNetCore.Http.RequestDelegate>-Delegat festgelegt wird, der nicht NULL ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1356">The <xref:Microsoft.AspNetCore.Routing.IRouter> instance chooses whether to *handle* the request by setting the [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) to a non-null <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="76246-1357">Wenn von einer Route ein Handler für die Anforderung festgelegt wird, endet die Routenverarbeitung, und der Handler wird zur Verarbeitung der Anforderung aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="76246-1357">If a route sets a handler for the request, route processing stops, and the handler is invoked to process the request.</span></span> <span data-ttu-id="76246-1358">Wenn kein Routenhandler gefunden wird, um die Anforderung zu verarbeiten, leitet die Middleware die Anforderung an die nächste Middleware in der Anforderungspipeline weiter.</span><span class="sxs-lookup"><span data-stu-id="76246-1358">If no route handler is found to process the request, the middleware hands the request off to the next middleware in the request pipeline.</span></span>

<span data-ttu-id="76246-1359">Die Haupteingabe für <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> ist der [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*), der der aktuellen Anforderung zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1359">The primary input to <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is the [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associated with the current request.</span></span> <span data-ttu-id="76246-1360">[RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) und [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) sind Ausgaben, die festgelegt werden, nachdem eine Route zugeordnet wurde.</span><span class="sxs-lookup"><span data-stu-id="76246-1360">The [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) and [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) are outputs set after a route is matched.</span></span>

<span data-ttu-id="76246-1361">Eine Zuordnung, die <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> aufruft, legt außerdem die Eigenschaften von [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) auf Grundlage der bisher verarbeiteten Anforderungen auf entsprechende Werte fest.</span><span class="sxs-lookup"><span data-stu-id="76246-1361">A match that calls <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> also sets the properties of the [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="76246-1362">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) ist ein Wörterbuch mit *Routenwerten*, das aus der Route erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1362">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="76246-1363">Die Werte werden in der Regel durch die Tokenisierung der URL ermittelt und können so verwendet werden, dass Benutzereingaben akzeptiert oder weitere Entscheidungen in der App zum Versenden von Anforderungen getroffen werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1363">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="76246-1364">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) ist eine Eigenschaftensammlung mit zusätzlichen Daten zur zugeordneten Route.</span><span class="sxs-lookup"><span data-stu-id="76246-1364">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="76246-1365"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> werden bereitgestellt, damit sich jeder Route Zustandsdaten zuordnen lassen, sodass in der App später Entscheidungen auf Grundlage der zugeordneten Route getroffen werden können.</span><span class="sxs-lookup"><span data-stu-id="76246-1365"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="76246-1366">Diese Werte werden vom Entwickler vorgegeben und beeinflussen das Routingverhalten **in keiner Weise**.</span><span class="sxs-lookup"><span data-stu-id="76246-1366">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="76246-1367">Außerdem können im Gegensatz zu [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), die sich in bzw. aus Zeichenfolgen konvertieren lassen müssen, Werte in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) einem beliebigen Typ entsprechen.</span><span class="sxs-lookup"><span data-stu-id="76246-1367">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="76246-1368">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) ist eine Liste der Routen, die an der Zuordnung der Anforderung beteiligt waren.</span><span class="sxs-lookup"><span data-stu-id="76246-1368">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="76246-1369">Routen können in anderen Routen geschachtelt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1369">Routes can be nested inside of one another.</span></span> <span data-ttu-id="76246-1370">Die <xref:Microsoft.AspNetCore.Routing.RouteData.Routers>-Eigenschaft stellt den Pfad mithilfe der logischen Routenstruktur dar, die zu der Zuordnung geführt hat.</span><span class="sxs-lookup"><span data-stu-id="76246-1370">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="76246-1371">Üblicherweise ist das erste Element in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> die Routensammlung. Dieses sollte zur URL-Generierung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1371">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="76246-1372">Das letzte Element in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> ist der Routenhandler, für den eine Zuordnung vorgenommen wurde.</span><span class="sxs-lookup"><span data-stu-id="76246-1372">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation"></a><span data-ttu-id="76246-1373">URL-Generierung</span><span class="sxs-lookup"><span data-stu-id="76246-1373">URL generation</span></span>

<span data-ttu-id="76246-1374">Bei der URL-Generierung wird durch Routing ein URL-Pfad basierend auf mehreren Routenwerten erstellt.</span><span class="sxs-lookup"><span data-stu-id="76246-1374">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="76246-1375">Dies ermöglicht eine logische Trennung zwischen den Routenhandlern und den URLs, die auf diese zugreifen.</span><span class="sxs-lookup"><span data-stu-id="76246-1375">This allows for a logical separation between route handlers and the URLs that access them.</span></span>

<span data-ttu-id="76246-1376">Auch für die URL-Generierung wird ein iterativer Prozess verwendet, bei dem allerdings zuerst vom Benutzer- oder Frameworkcode die <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*>-Methode der Routensammlung aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1376">URL generation follows a similar iterative process, but it starts with user or framework code calling into the <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method of the route collection.</span></span> <span data-ttu-id="76246-1377">Nacheinander wird für jede *Route* die zugehörige <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*>-Methode aufgerufen, bis ein <xref:Microsoft.AspNetCore.Routing.VirtualPathData>-Objekt zurückgegeben wird, dessen Wert nicht NULL ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1377">Each *route* has its <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method called in sequence until a non-null <xref:Microsoft.AspNetCore.Routing.VirtualPathData> is returned.</span></span>

<span data-ttu-id="76246-1378">Die primären Eingaben für <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> sind:</span><span class="sxs-lookup"><span data-stu-id="76246-1378">The primary inputs to <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> are:</span></span>

* [<span data-ttu-id="76246-1379">VirtualPathContext.HttpContext</span><span class="sxs-lookup"><span data-stu-id="76246-1379">VirtualPathContext.HttpContext</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext)
* [<span data-ttu-id="76246-1380">VirtualPathContext.Values</span><span class="sxs-lookup"><span data-stu-id="76246-1380">VirtualPathContext.Values</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values)
* [<span data-ttu-id="76246-1381">VirtualPathContext.AmbientValues</span><span class="sxs-lookup"><span data-stu-id="76246-1381">VirtualPathContext.AmbientValues</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues)

<span data-ttu-id="76246-1382">Für Routen werden überwiegend die Routenwerte verwendet, die von <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> und <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> bereitgestellt werden. Dadurch wird ermittelt, ob eine URL generiert werden kann und welche Werte diese enthalten soll.</span><span class="sxs-lookup"><span data-stu-id="76246-1382">Routes primarily use the route values provided by <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> and <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> to decide whether it's possible to generate a URL and what values to include.</span></span> <span data-ttu-id="76246-1383"><xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> sind Routenwerte, die durch die Zuordnung zur aktuellen Anforderung erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="76246-1383">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> are the set of route values that were produced from matching the current request.</span></span> <span data-ttu-id="76246-1384">Im Gegensatz dazu sind <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> die Routenwerte, die angeben, wie die gewünschte URL für den aktuellen Vorgang generiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="76246-1384">In contrast, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="76246-1385"><xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> wird bereitgestellt, falls für eine Route Dienste oder zusätzliche Daten, die mit dem aktuellen Kontext verknüpft sind, abgerufen werden müssen.</span><span class="sxs-lookup"><span data-stu-id="76246-1385">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> is provided in case a route should obtain services or additional data associated with the current context.</span></span>

> [!TIP]
> <span data-ttu-id="76246-1386">[VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) kann als Menge von überschriebenen Eigenschaften für [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*) betrachtet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1386">Think of [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) as a set of overrides for the [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span></span> <span data-ttu-id="76246-1387">Bei der URL-Generierung wird versucht, Routenwerte der aktuellen Anforderung wiederzuverwenden, um so URLs für Links generieren zu können, die dieselbe Route oder dieselben Routenwerte verwenden.</span><span class="sxs-lookup"><span data-stu-id="76246-1387">URL generation attempts to reuse route values from the current request to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="76246-1388">Die Ausgabe von <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> ist ein <xref:Microsoft.AspNetCore.Routing.VirtualPathData>-Objekt.</span><span class="sxs-lookup"><span data-stu-id="76246-1388">The output of <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is a <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span></span> <span data-ttu-id="76246-1389"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> verhält sich analog zu <xref:Microsoft.AspNetCore.Routing.RouteData>.</span><span class="sxs-lookup"><span data-stu-id="76246-1389"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> is a parallel of <xref:Microsoft.AspNetCore.Routing.RouteData>.</span></span> <span data-ttu-id="76246-1390"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> enthält das <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath>-Objekt für die Ausgabe-URL und einige zusätzlichen Eigenschaften, die von der Route festgelegt werden sollten.</span><span class="sxs-lookup"><span data-stu-id="76246-1390"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contains the <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> for the output URL and some additional properties that should be set by the route.</span></span>

<span data-ttu-id="76246-1391">Die [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*)-Eigenschaft enthält den *virtuellen Pfad*, der von der Route erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1391">The [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="76246-1392">Je nach Anforderungen muss der Pfad eventuell noch weiter verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1392">Depending on your needs, you may need to process the path further.</span></span> <span data-ttu-id="76246-1393">Wenn die generierte URL in HTML gerendert werden soll, müssen Sie den App-Basispfad voranstellen.</span><span class="sxs-lookup"><span data-stu-id="76246-1393">If you want to render the generated URL in HTML, prepend the base path of the app.</span></span>

<span data-ttu-id="76246-1394">[VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) ist ein Verweis auf die Route, mit der die URL generiert wurde.</span><span class="sxs-lookup"><span data-stu-id="76246-1394">The [VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="76246-1395">Die [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*)-Eigenschaften stellen ein Wörterbuch mit zusätzlichen Daten zur Route dar, mit der die URL generiert wurde.</span><span class="sxs-lookup"><span data-stu-id="76246-1395">The [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="76246-1396">Diese Eigenschaften verhalten sich analog zu [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span><span class="sxs-lookup"><span data-stu-id="76246-1396">This is the parallel of [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span></span>

### <a name="create-routes"></a><span data-ttu-id="76246-1397">Erstellen von Routen</span><span class="sxs-lookup"><span data-stu-id="76246-1397">Create routes</span></span>

<span data-ttu-id="76246-1398">Für die Routingfunktionalität wird die <xref:Microsoft.AspNetCore.Routing.Route>-Klasse als Standardimplementierung von <xref:Microsoft.AspNetCore.Routing.IRouter> zur Verfügung gestellt.</span><span class="sxs-lookup"><span data-stu-id="76246-1398">Routing provides the <xref:Microsoft.AspNetCore.Routing.Route> class as the standard implementation of <xref:Microsoft.AspNetCore.Routing.IRouter>.</span></span> <span data-ttu-id="76246-1399"><xref:Microsoft.AspNetCore.Routing.Route> verwendet die Syntax für *Routenvorlagen*, um Muster zu definieren, die dem URL-Pfad zugeordnet werden können, wenn <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1399"><xref:Microsoft.AspNetCore.Routing.Route> uses the *route template* syntax to define patterns to match against the URL path when <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is called.</span></span> <span data-ttu-id="76246-1400"><xref:Microsoft.AspNetCore.Routing.Route> nutzt dieselbe Routenvorlage zum Generieren einer URL, wenn <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1400"><xref:Microsoft.AspNetCore.Routing.Route> uses the same route template to generate a URL when <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is called.</span></span>

<span data-ttu-id="76246-1401">Die meisten Apps erstellen Routen, indem sie <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> oder eine ähnliche Erweiterungsmethode aufrufen, die in <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> definiert ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1401">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="76246-1402">All diese <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>-Erweiterungsmethoden erstellen eine Instanz von <xref:Microsoft.AspNetCore.Routing.Route> und fügen diese der Routensammlung hinzu.</span><span class="sxs-lookup"><span data-stu-id="76246-1402">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="76246-1403"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> akzeptiert keine Routenhandlerparameter.</span><span class="sxs-lookup"><span data-stu-id="76246-1403"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="76246-1404">Durch <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> werden nur Routen hinzugefügt, die vom <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*> verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1404"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="76246-1405">Der Standardhandler ist ein `IRouter`. Möglicherweise verarbeitet der Handler die Anforderung nicht.</span><span class="sxs-lookup"><span data-stu-id="76246-1405">The default handler is an `IRouter`, and the handler might not handle the request.</span></span> <span data-ttu-id="76246-1406">Beispielsweise ist ASP.NET Core MVC üblicherweise als Standardhandler konfiguriert, der nur Anforderungen verarbeitet, die mit einem verfügbaren Controller und einer Aktion übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="76246-1406">For example, ASP.NET Core MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="76246-1407">Weitere Informationen zum Routing in MVC finden Sie unter <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="76246-1407">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="76246-1408">Im folgenden Codebeispiel wird ein <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>-Aufruf dargestellt, der von einer typischen ASP.NET Core MVC-Routendefinition verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="76246-1408">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="76246-1409">Diese Vorlage ordnet einen URL-Pfad zu und extrahiert die Routenwerte.</span><span class="sxs-lookup"><span data-stu-id="76246-1409">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="76246-1410">Beispielsweise generiert der Pfad `/Products/Details/17` die folgenden Routenwerte: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="76246-1410">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="76246-1411">Routenwerte werden ermittelt, indem der URL-Pfad in Segmente aufgeteilt wird und jedes Segment mit dem Namen des *Routenparameters* in der Routenvorlage abgeglichen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1411">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="76246-1412">Jeder Routenparameter hat einen Namen.</span><span class="sxs-lookup"><span data-stu-id="76246-1412">Route parameters are named.</span></span> <span data-ttu-id="76246-1413">Die Parameter werden von Klammern `{ ... }` eingeschlossen und dadurch definiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1413">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="76246-1414">Die obige Vorlage kann auch dem URL-Pfad `/` zugeordnet werden und daraus die Werte `{ controller = Home, action = Index }` generieren.</span><span class="sxs-lookup"><span data-stu-id="76246-1414">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="76246-1415">Dies liegt daran, dass die Routenparameter `{controller}` und `{action}` über Standardwerte verfügen und der Routenparameter `id` optional ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1415">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="76246-1416">Hinter dem Namen des Routenparameters steht das Gleichheitszeichen (`=`), auf das der Wert folgt, der als Standardwert für den Parameter definiert wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1416">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="76246-1417">Durch ein Fragezeichen (`?`) nach dem Namen des Routenparameters wird ein optionaler Parameter definiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1417">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="76246-1418">Durch Routenparameter mit einem Standardwert wird *immer* ein Routenwert erzeugt, wenn eine Übereinstimmung für die Route ermittelt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1418">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="76246-1419">Bei optionalen Parametern wird kein Routenwert generiert, wenn kein entsprechendes URL-Pfadsegment vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1419">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="76246-1420">Eine ausführliche Beschreibung zu den Szenarios und zur Syntax der Routenvorlage finden Sie unter [Referenz zu Routenvorlagen](#route-template-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-1420">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="76246-1421">Im folgenden Beispiel definiert die Routenparameterdefinition `{id:int}` eine [Routeneinschränkung](#route-constraint-reference) für den Routenparameter `id`:</span><span class="sxs-lookup"><span data-stu-id="76246-1421">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="76246-1422">Durch diese Vorlage wird bei einem Abgleich beispielsweise der URL-Pfad `/Products/Details/17`, aber nicht `/Products/Details/Apples` gefunden.</span><span class="sxs-lookup"><span data-stu-id="76246-1422">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="76246-1423">In derartigen Einschränkungen wird <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementiert, und die Routenwerte werden auf Gültigkeit geprüft.</span><span class="sxs-lookup"><span data-stu-id="76246-1423">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="76246-1424">Im obigen Beispiel muss sich der Routenwert `id` in einen Integer konvertieren lassen.</span><span class="sxs-lookup"><span data-stu-id="76246-1424">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="76246-1425">Weitere Informationen zu Routeneinschränkungen, die vom Framework bereitgestellt werden, finden Sie in der [Referenz zu Routeneinschränkungen](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-1425">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="76246-1426">Bei zusätzlichen Überladungen von <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> werden Werte für `constraints`, `dataTokens` und `defaults` akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1426">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="76246-1427">Üblicherweise werden diese Parameter so verwendet, dass ein Objekt eines anonymen Typs übergeben wird, in dem die Eigenschaftsnamen des anonymen Typs mit den Routenparameternamen abgeglichen werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1427">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="76246-1428">In den folgenden <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>-Beispielen werden identische Routen erstellt:</span><span class="sxs-lookup"><span data-stu-id="76246-1428">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="76246-1429">Für einfache Routen eignet sich die Inline-Syntax zum Definieren von Einschränkungen und Standardwerten.</span><span class="sxs-lookup"><span data-stu-id="76246-1429">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="76246-1430">Bestimmte Szenarios wie die Verwendung von Datentoken werden von dieser allerdings nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="76246-1430">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="76246-1431">Das folgende Beispiel veranschaulicht einige weitere Szenarios:</span><span class="sxs-lookup"><span data-stu-id="76246-1431">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{*article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="76246-1432">Diese Vorlage kann einem URL-Pfad wie `/Blog/All-About-Routing/Introduction` zugeordnet werden. Sie extrahier die `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`-Werte.</span><span class="sxs-lookup"><span data-stu-id="76246-1432">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="76246-1433">Die Standardroutenwerte für `controller` und `action` werden von der Route generiert, obwohl keine entsprechenden Routenparameter in der Vorlage vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="76246-1433">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="76246-1434">Standardwerte können in der Routenvorlage angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1434">Default values can be specified in the route template.</span></span> <span data-ttu-id="76246-1435">Der Routenparameter `article` wird durch ein Sternchen (`*`) vor dem zugehörigen Namen als *Catch-All-Parameter* definiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1435">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk (`*`) before the route parameter name.</span></span> <span data-ttu-id="76246-1436">So wird der verbleibende Teil des URL-Pfads erfasst, und auch leere Zeichenfolgen können gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1436">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="76246-1437">Im folgenden Beispiel werden Routeneinschränkungen und Datentoken hinzugefügt:</span><span class="sxs-lookup"><span data-stu-id="76246-1437">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="76246-1438">Diese Vorlage kann einem URL-Pfad wie `/en-US/Products/5` zugeordnet werden, und die `{ controller = Products, action = Details, id = 5 }`-Werte und `{ locale = en-US }`-Datentoken werden extrahiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1438">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Gebietsschemas, Windows-Tokens](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="76246-1440">Generieren der URL zu einer Routenklasse</span><span class="sxs-lookup"><span data-stu-id="76246-1440">Route class URL generation</span></span>

<span data-ttu-id="76246-1441">Durch die Kombination von mehreren Routenwerten und der zugehörigen Routenvorlage kann die <xref:Microsoft.AspNetCore.Routing.Route>-Klasse auch URLs generieren.</span><span class="sxs-lookup"><span data-stu-id="76246-1441">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="76246-1442">Dieser Prozess verläuft umgekehrt zum Abgleich eines URL-Pfads.</span><span class="sxs-lookup"><span data-stu-id="76246-1442">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="76246-1443">Wenn Sie die URL-Generierung besser nachvollziehen möchten, sollten Sie sich überlegen, welche URL generiert werden soll und wie diese mithilfe der Routenvorlage abgeglichen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1443">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="76246-1444">Dabei sollten Sie auch darüber nachdenken, welche Werte erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1444">What values would be produced?</span></span> <span data-ttu-id="76246-1445">Dieser Vorgang entspricht in etwa der URL-Generierung in der <xref:Microsoft.AspNetCore.Routing.Route>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="76246-1445">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="76246-1446">Im folgenden Beispiel wird eine allgemeine Standardroute für ASP.NET Core-MVC verwendet:</span><span class="sxs-lookup"><span data-stu-id="76246-1446">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="76246-1447">Mithilfe der Routenwerte `{ controller = Products, action = List }` wird die URL `/Products/List` generiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1447">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="76246-1448">Die Routenwerte werden als Ersatz für die entsprechenden Routenparameter verwendet, wodurch ein URL-Pfad erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="76246-1448">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="76246-1449">Da es sich bei `id` um einen optionalen Routenparameter handelt, wird die URL erfolgreich ohne einen Wert für `id` generiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1449">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="76246-1450">Mithilfe der Routenwerte `{ controller = Home, action = Index }` wird die URL `/` generiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1450">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="76246-1451">Die bereitgestellten Routenwerte entsprechen den Standardwerten, sodass die Segmente, die mit diesen Werten übereinstimmen, problemlos ausgelassen werden können.</span><span class="sxs-lookup"><span data-stu-id="76246-1451">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="76246-1452">Mit beiden generierten URLs (`/Home/Index` und `/`) und dieser Routendefinition wird ein Roundtrip ausgeführt, und es werden dieselben Routenwerte erstellt, die auch zur Generierung der URL verwendet wurden.</span><span class="sxs-lookup"><span data-stu-id="76246-1452">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="76246-1453">Eine auf ASP.NET Core MVC basierende App sollte zur Generierung von URLs die Routingfunktion nicht direkt aufrufen, sondern <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> verwenden.</span><span class="sxs-lookup"><span data-stu-id="76246-1453">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="76246-1454">Weitere Informationen zur Generierung von URLs finden Sie im Abschnitt [Referenz zur URL-Generierung](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-1454">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="76246-1455">Verwenden von Routingmiddleware</span><span class="sxs-lookup"><span data-stu-id="76246-1455">Use routing middleware</span></span>

<span data-ttu-id="76246-1456">Legen Sie das [Microsoft.AspNetCore.App-Metapaket](xref:fundamentals/metapackage-app) in der Projektdatei der App als Verweis fest.</span><span class="sxs-lookup"><span data-stu-id="76246-1456">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="76246-1457">Fügen Sie anschließend dem Dienstcontainer in `Startup.ConfigureServices` die Routingfunktionalität hinzu:</span><span class="sxs-lookup"><span data-stu-id="76246-1457">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="76246-1458">Routen müssen in der `Startup.Configure`-Methode konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1458">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="76246-1459">In der Beispiel-App werden die folgenden APIs verwendet:</span><span class="sxs-lookup"><span data-stu-id="76246-1459">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="76246-1460"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Ordnet nut HTTP GET-Anforderungen zu.</span><span class="sxs-lookup"><span data-stu-id="76246-1460"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="76246-1461">In der folgenden Tabelle werden die Antworten mit den angegebenen URIs aufgelistet:</span><span class="sxs-lookup"><span data-stu-id="76246-1461">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="76246-1462">URI</span><span class="sxs-lookup"><span data-stu-id="76246-1462">URI</span></span>                    | <span data-ttu-id="76246-1463">Antwort</span><span class="sxs-lookup"><span data-stu-id="76246-1463">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="76246-1464">Hallo!</span><span class="sxs-lookup"><span data-stu-id="76246-1464">Hello!</span></span> <span data-ttu-id="76246-1465">Route values: [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="76246-1465">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="76246-1466">Hallo!</span><span class="sxs-lookup"><span data-stu-id="76246-1466">Hello!</span></span> <span data-ttu-id="76246-1467">Route values: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="76246-1467">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="76246-1468">Hallo!</span><span class="sxs-lookup"><span data-stu-id="76246-1468">Hello!</span></span> <span data-ttu-id="76246-1469">Route values: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="76246-1469">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="76246-1470">The request falls through, no match. (Die Anforderung ist fehlgeschlagen, keine Übereinstimmung.)</span><span class="sxs-lookup"><span data-stu-id="76246-1470">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="76246-1471">Hi, Joe!</span><span class="sxs-lookup"><span data-stu-id="76246-1471">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="76246-1472">The request falls through, matches HTTP GET only (Die Anforderung ist fehlgeschlagen, nur für eine HTTP-GET-Anforderung wird eine Übereinstimmung ermittelt)</span><span class="sxs-lookup"><span data-stu-id="76246-1472">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="76246-1473">The request falls through, no match. (Die Anforderung ist fehlgeschlagen, keine Übereinstimmung.)</span><span class="sxs-lookup"><span data-stu-id="76246-1473">The request falls through, no match.</span></span>              |

<span data-ttu-id="76246-1474">Wenn Sie eine einzelne Route konfigurieren, müssen Sie <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> aufrufen und eine `IRouter`-Instanz übergeben.</span><span class="sxs-lookup"><span data-stu-id="76246-1474">If you're configuring a single route, call <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> passing in an `IRouter` instance.</span></span> <span data-ttu-id="76246-1475"><xref:Microsoft.AspNetCore.Routing.RouteBuilder> muss nicht verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1475">You won't need to use <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span></span>

<span data-ttu-id="76246-1476">Das Framework stellt mehrere Erweiterungsmethoden zum Erstellen von Routen zur Verfügung (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="76246-1476">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="76246-1477">Einige der aufgeführten Methoden (z. B. <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>) erfordern einen <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="76246-1477">Some of listed methods, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, require a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="76246-1478"><xref:Microsoft.AspNetCore.Http.RequestDelegate> wird als *Routenhandler* verwendet, wenn der Abgleich für die Route erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1478">The <xref:Microsoft.AspNetCore.Http.RequestDelegate> is used as the *route handler* when the route matches.</span></span> <span data-ttu-id="76246-1479">Für andere Erweiterungsmethoden kann eine Middlewarepipeline konfiguriert werden, die als Routenhandler verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1479">Other methods in this family allow configuring a middleware pipeline for use as the route handler.</span></span> <span data-ttu-id="76246-1480">Wenn die `Map*`-Methode einen Handler wie <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*> nicht akzeptiert, verwendet sie <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="76246-1480">If the `Map*` method doesn't accept a handler, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, it uses the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span>

<span data-ttu-id="76246-1481">In den `Map[Verb]`-Methoden werden Einschränkungen verwendet, um die Route auf das HTTP-Verb im Methodennamen zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="76246-1481">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="76246-1482">Beispielsweise unter <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> und <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="76246-1482">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="76246-1483">Referenz für Routenvorlagen</span><span class="sxs-lookup"><span data-stu-id="76246-1483">Route template reference</span></span>

<span data-ttu-id="76246-1484">Token in geschweiften Klammern (`{ ... }`) definieren *Routenparameter*, die beim Abgleich der Route gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1484">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="76246-1485">Sie können in einem Routensegment mehrere Routenparameter definieren, wenn Sie sie durch einen Literalwert trennen.</span><span class="sxs-lookup"><span data-stu-id="76246-1485">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="76246-1486">`{controller=Home}{action=Index}` ist z.B. keine gültige Route, da sich zwischen `{controller}` und `{action}` kein Literalwert befindet.</span><span class="sxs-lookup"><span data-stu-id="76246-1486">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="76246-1487">Diese Routenparameter müssen einen Namen besitzen und können zusätzliche Attribute aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-1487">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="76246-1488">Eine Literalzeichenfolge, die nicht den Routenparametern entspricht (z.B. `{id}`), muss zusammen mit dem Pfadtrennzeichen `/` mit dem URL-Text übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="76246-1488">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="76246-1489">Beim Abgleich von Text wird nicht zwischen Groß-/Kleinbuchstaben unterschieden, und die Übereinstimmung basiert auf der decodierten Repräsentation des URL-Pfads.</span><span class="sxs-lookup"><span data-stu-id="76246-1489">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="76246-1490">Damit das Trennzeichen (`{` oder `}`) der Routenparameterliteralzeichenfolge bei einem Abgleich gefunden wird, muss es doppelt vorhanden sein (`{{` oder `}}`), was einem Escapezeichen entspricht.</span><span class="sxs-lookup"><span data-stu-id="76246-1490">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="76246-1491">Bei einem URL-Muster, durch das ein Dateiname mit einer optionalen Erweiterung erfasst werden soll, sind noch weitere Aspekte zu berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="76246-1491">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="76246-1492">Dies wird z.B. anhand der Vorlage `files/{filename}.{ext?}` deutlich.</span><span class="sxs-lookup"><span data-stu-id="76246-1492">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="76246-1493">Wenn sowohl für `filename` als auch für `ext` Werte vorhanden sind, werden beide Werte angegeben.</span><span class="sxs-lookup"><span data-stu-id="76246-1493">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="76246-1494">Wenn nur für `filename` ein Wert in der URL vorhanden ist, wird für die Route eine Zuordnung ermittelt, da der nachstehende Punkt (`.`) optional ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1494">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="76246-1495">Für die folgenden URLs wird eine Übereinstimmung für die Route ermittelt:</span><span class="sxs-lookup"><span data-stu-id="76246-1495">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="76246-1496">Sie können das Sternchen (`*`) als Präfix für einen Routenparameter verwenden, um eine Bindung zum verbleibenden Teil des URI herzustellen.</span><span class="sxs-lookup"><span data-stu-id="76246-1496">You can use the asterisk (`*`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="76246-1497">Hierbei wird von einem *Catch-All*-Parameter gesprochen.</span><span class="sxs-lookup"><span data-stu-id="76246-1497">This is called a *catch-all* parameter.</span></span> <span data-ttu-id="76246-1498">Durch `blog/{*slug}` wird beispielsweise jeder URI ermittelt, der mit `/blog` beginnt und dahinter einen beliebigen Wert aufweist, der dann dem `slug`-Routenwert zugeordnet wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1498">For example, `blog/{*slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="76246-1499">Durch Catch-All-Parameter können auch leere Zeichenfolgen gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1499">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="76246-1500">Der Catch-All-Parameter schützt die entsprechenden Zeichen (Escaping), wenn die Route verwendet wird, um eine URL, einschließlich Pfadtrennzeichen zu generieren (`/`).</span><span class="sxs-lookup"><span data-stu-id="76246-1500">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="76246-1501">Z.B. generiert die Route `foo/{*path}` mit den Routenwerten `{ path = "my/path" }``foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="76246-1501">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="76246-1502">Beachten Sie den umgekehrten Schrägstrich mit Escapezeichen.</span><span class="sxs-lookup"><span data-stu-id="76246-1502">Note the escaped forward slash.</span></span>

<span data-ttu-id="76246-1503">Routenparameter können über mehrere *Standardwerte* verfügen, die nach dem Parameternamen angegeben werden und durch ein Gleichheitszeichen (`=`) voneinander getrennt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1503">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="76246-1504">Mit `{controller=Home}` wird beispielsweise `Home` als Standardwert für `controller` definiert.</span><span class="sxs-lookup"><span data-stu-id="76246-1504">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="76246-1505">Der Standardwert wird verwendet, wenn kein Wert in der Parameter-URL vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1505">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="76246-1506">Routenparameter sind optional, wenn am Ende des Parameternamens ein Fragezeichen (`?`) angefügt wird, z. B. `id?`.</span><span class="sxs-lookup"><span data-stu-id="76246-1506">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="76246-1507">Der Unterschied zwischen optionalen Parametern und Routenparametern mit einem Standardwert besteht darin, dass mithilfe der letzteren immer ein Wert erzeugt wird. Ein optionaler Parameter verfügt demgegenüber nur dann über einen Wert, wenn ein solcher von der Anforderungs-URL bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1507">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="76246-1508">Routenparameter können Einschränkungen aufweisen, die mit dem gebundenen Routenwert der URL übereinstimmen müssen.</span><span class="sxs-lookup"><span data-stu-id="76246-1508">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="76246-1509">Eine *Inline-Einschränkung* für einen Routenparameter geben Sie an, indem Sie hinter dem Namen des Routenparameters einen Doppelpunkt (`:`) und einen Einschränkungsnamen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="76246-1509">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="76246-1510">Wenn für die Einschränkung Argumente erforderlich sind, werden diese nach dem Einschränkungsnamen in Klammern (`(...)`) eingeschlossen.</span><span class="sxs-lookup"><span data-stu-id="76246-1510">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="76246-1511">Mehrere Inline-Einschränkungen können festgelegt werden, indem ein weiterer Doppelpunkt (`:`) und Einschränkungsname hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1511">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="76246-1512">Der Einschränkungsname und die Argumente werden dem <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver>-Dienst übergeben, wodurch eine Instanz von <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> für die URL-Verarbeitung erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="76246-1512">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="76246-1513">In der Routenvorlage `blog/{article:minlength(10)}` wird beispielsweise die Einschränkung `minlength` mit dem Argument `10` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-1513">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="76246-1514">Weitere Informationen zu Routeneinschränkungen und eine Liste der vom Framework bereitgestellten Einschränkungen finden Sie im Abschnitt [Referenz zu Routeneinschränkungen](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-1514">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="76246-1515">Die folgende Tabelle enthält Beispielvorlagen für Routen und deren Verhalten.</span><span class="sxs-lookup"><span data-stu-id="76246-1515">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="76246-1516">Routenvorlage</span><span class="sxs-lookup"><span data-stu-id="76246-1516">Route Template</span></span>                           | <span data-ttu-id="76246-1517">Beispiel-URI für Übereinstimmung</span><span class="sxs-lookup"><span data-stu-id="76246-1517">Example Matching URI</span></span>    | <span data-ttu-id="76246-1518">Der Anforderungs-URI&hellip;</span><span class="sxs-lookup"><span data-stu-id="76246-1518">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="76246-1519">Nur für den Pfad `/hello` wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-1519">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="76246-1520">Eine Übereinstimmung wird ermittelt, und `Page` wird auf `Home` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-1520">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="76246-1521">Eine Übereinstimmung wird ermittelt, und `Page` wird auf `Contact` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="76246-1521">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="76246-1522">Stimmt mit dem `Products`-Controller und der `List`-Aktion überein.</span><span class="sxs-lookup"><span data-stu-id="76246-1522">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="76246-1523">Stimmt mit dem `Products`-Controller und der `Details`-Aktion (`id` auf 123 festgelegt) überein.</span><span class="sxs-lookup"><span data-stu-id="76246-1523">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="76246-1524">Stimmt mit dem `Home`-Controller und der `Index`-Aktion überein (`id` wird ignoriert).</span><span class="sxs-lookup"><span data-stu-id="76246-1524">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="76246-1525">Mit Vorlagen lässt sich Routing besonders leicht durchführen.</span><span class="sxs-lookup"><span data-stu-id="76246-1525">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="76246-1526">Einschränkungen und Standardwerte können auch außerhalb der Routenvorlage angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1526">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="76246-1527">Wenn Sie die [Protokollierung](xref:fundamentals/logging/index) aktivieren, erfahren Sie, wie die integrierten Routingimplementierungen (z.B. <xref:Microsoft.AspNetCore.Routing.Route>) Zuordnungen für Anforderungen ermitteln.</span><span class="sxs-lookup"><span data-stu-id="76246-1527">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="76246-1528">Referenz für Routeneinschränkungen</span><span class="sxs-lookup"><span data-stu-id="76246-1528">Route constraint reference</span></span>

<span data-ttu-id="76246-1529">Routeneinschränkungen werden angewendet, wenn eine Übereinstimmung mit der eingehenden URL gefunden wurde und der URL-Pfad in Routenwerten mit Token versehen wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1529">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="76246-1530">In der Regel wird mit Routeneinschränkungen der Routenwert der zugehörigen Vorlage geprüft. Dabei wird bestimmt, ob der Wert gültig ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1530">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="76246-1531">Für einige Routeneinschränkungen werden anstelle des Routenwerts andere Daten verwendet, um zu ermitteln, ob das Routing einer Anforderung möglich ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1531">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="76246-1532"><xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> kann beispielsweise auf der Grundlage des HTTP-Verbs eine Anforderung entweder annehmen oder ablehnen.</span><span class="sxs-lookup"><span data-stu-id="76246-1532">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="76246-1533">Einschränkungen werden in Routinganforderungen und bei der Linkgenerierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-1533">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="76246-1534">Verwenden Sie keine Einschränkungen für die **Eingabeüberprüfung**.</span><span class="sxs-lookup"><span data-stu-id="76246-1534">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="76246-1535">Wenn bei der **Eingabevalidierung** Einschränkungen verwendet werden, lösen ungültige Eingaben den Fehler *404 - Not Found* (404 – Nicht gefunden) aus. Stattdessen sollte jedoch der Fehler *400 - Bad Request* (400 – Fehlerhafte Anforderung) ausgelöst und mit einer entsprechenden Fehlermeldung angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1535">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="76246-1536">Verwenden Sie Routeneinschränkungen nicht, um Eingaben für eine bestimmte Route zu überprüfen, sondern um ähnlichen Routen zu **unterscheiden**.</span><span class="sxs-lookup"><span data-stu-id="76246-1536">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="76246-1537">In der folgenden Tabelle werden Beispiele für Routeneinschränkungen und deren zu erwartendes Verhalten beschriebe.</span><span class="sxs-lookup"><span data-stu-id="76246-1537">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="76246-1538">Einschränkung</span><span class="sxs-lookup"><span data-stu-id="76246-1538">constraint</span></span> | <span data-ttu-id="76246-1539">Beispiel</span><span class="sxs-lookup"><span data-stu-id="76246-1539">Example</span></span> | <span data-ttu-id="76246-1540">Beispiele für Übereinstimmungen</span><span class="sxs-lookup"><span data-stu-id="76246-1540">Example Matches</span></span> | <span data-ttu-id="76246-1541">Hinweise</span><span class="sxs-lookup"><span data-stu-id="76246-1541">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="76246-1542">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="76246-1542">`123456789`, `-123456789`</span></span> | <span data-ttu-id="76246-1543">Für jeden Integer wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-1543">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="76246-1544">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="76246-1544">`true`, `FALSE`</span></span> | <span data-ttu-id="76246-1545">Für `true` oder `false` wird eine Übereinstimmung ermittelt (keine Unterscheidung zwischen Groß-/Kleinbuchstaben).</span><span class="sxs-lookup"><span data-stu-id="76246-1545">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="76246-1546">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="76246-1546">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="76246-1547">Entspricht einem gültigen `DateTime`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-1547">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="76246-1548">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-1548">See  preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="76246-1549">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="76246-1549">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="76246-1550">Entspricht einem gültigen `decimal`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-1550">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="76246-1551">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-1551">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="76246-1552">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="76246-1552">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="76246-1553">Entspricht einem gültigen `double`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-1553">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="76246-1554">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-1554">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="76246-1555">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="76246-1555">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="76246-1556">Entspricht einem gültigen `float`-Wert in der invarianten Kultur.</span><span class="sxs-lookup"><span data-stu-id="76246-1556">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="76246-1557">Siehe vorherige Warnung.</span><span class="sxs-lookup"><span data-stu-id="76246-1557">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="76246-1558">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="76246-1558">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="76246-1559">Für einen gültigen `Guid`-Wert wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-1559">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="76246-1560">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="76246-1560">`123456789`, `-123456789`</span></span> | <span data-ttu-id="76246-1561">Für einen gültigen `long`-Wert wird eine Übereinstimmung ermittelt.</span><span class="sxs-lookup"><span data-stu-id="76246-1561">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="76246-1562">Die Zeichenfolge muss mindestens eine Länge von 4 Zeichen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-1562">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="76246-1563">Die Zeichenfolge darf maximal eine Länge von 8 Zeichen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-1563">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="76246-1564">Die Zeichenfolge muss genau 12 Zeichen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-1564">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="76246-1565">Die Zeichenfolge muss mindestens eine Länge von 8 und darf maximal eine Länge von 16 Zeichen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="76246-1565">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="76246-1566">Der Integerwert muss mindestens 18 sein.</span><span class="sxs-lookup"><span data-stu-id="76246-1566">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="76246-1567">Der Integerwert darf nicht größer als 120 sein.</span><span class="sxs-lookup"><span data-stu-id="76246-1567">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="76246-1568">Der Integerwert muss zwischen 18 und 120 liegen.</span><span class="sxs-lookup"><span data-stu-id="76246-1568">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="76246-1569">Die Zeichenfolge muss aus mindestens einem alphabetische Zeichen bestehen (`a`-`z`, keine Unterscheidung zwischen Groß-/Kleinbuchstaben).</span><span class="sxs-lookup"><span data-stu-id="76246-1569">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="76246-1570">Die Zeichenfolge muss dem regulären Ausdruck entsprechen (siehe Tipp zum Definieren eines regulären Ausdrucks)</span><span class="sxs-lookup"><span data-stu-id="76246-1570">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="76246-1571">Hierdurch wird erzwungen, dass ein Wert, der kein Parameter ist, für die URL-Generierung vorhanden sein muss.</span><span class="sxs-lookup"><span data-stu-id="76246-1571">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="76246-1572">Auf einen einzelnen Parameter können mehrere durch Doppelpunkte getrennte Einschränkungen angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1572">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="76246-1573">Durch die folgende Einschränkung wird ein Parameter beispielsweise auf einen Integerwert größer oder gleich 1 beschränkt:</span><span class="sxs-lookup"><span data-stu-id="76246-1573">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="76246-1574">Für Routeneinschränkungen, mit denen die URL überprüft wird und die in den CLR-Typ umgewandelt werden (beispielsweise `int` oder `DateTime`), wird immer die invariante Kultur verwendet.</span><span class="sxs-lookup"><span data-stu-id="76246-1574">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="76246-1575">Diese Einschränkungen setzen voraus, dass die URL nicht lokalisierbar ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1575">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="76246-1576">Die vom Framework bereitgestellten Routeneinschränkungen ändern nicht die Werte, die in Routenwerten gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="76246-1576">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="76246-1577">Alle Routenwerte, die aus der URL analysiert werden, werden als Zeichenfolgen gespeichert.</span><span class="sxs-lookup"><span data-stu-id="76246-1577">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="76246-1578">Durch die `float`-Einschränkung wird beispielsweise versucht, den Routenwert in einen Gleitkommawert zu konvertieren. Mit dem konvertierten Wert wird allerdings nur überprüft, ob eine Umwandlung überhaupt möglich ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1578">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="76246-1579">Reguläre Ausdrücke</span><span class="sxs-lookup"><span data-stu-id="76246-1579">Regular expressions</span></span>

<span data-ttu-id="76246-1580">Im ASP.NET Core-Framework wird dem Konstruktor für reguläre Ausdrücke `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="76246-1580">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="76246-1581">Eine Beschreibung dieser Member finden Sie unter <xref:System.Text.RegularExpressions.RegexOptions>.</span><span class="sxs-lookup"><span data-stu-id="76246-1581">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="76246-1582">In regulären Ausdrücken werden Trennzeichen und Token verwendet, die auch beim Routing und in der Programmiersprache C# in ähnlicher Weise verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1582">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="76246-1583">Token, die reguläre Ausdrücke enthalten, müssen mit einem Escapezeichen versehen werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1583">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="76246-1584">Wenn Sie den regulären Ausdruck `^\d{3}-\d{2}-\d{4}$` für das Routing verwenden möchten, muss der Ausdruck `\`-Zeichen (einzelner Schrägstrich) enthalten, die in der C#-Quelldatei in der Zeichenfolge als `\\`-Zeichen (doppelter Schrägstrich) angegeben sind, damit die `\`-Zeichenfolge mit einem Escapezeichen versehen wird. Dies ist nicht erforderlich, wenn [ausführliche Zeichenfolgenliterale](/dotnet/csharp/language-reference/keywords/string) verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1584">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="76246-1585">Wenn Sie Trennzeichen für Routenparameter mit Escapezeichen versehen möchten (`{`, `}`, `[`, `]`), geben Sie jedes Zeichen im Ausdruck doppelt ein (`{{`, `}`, `[[`, `]]`).</span><span class="sxs-lookup"><span data-stu-id="76246-1585">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="76246-1586">In der folgenden Tabelle werden reguläre Ausdrücke und Ausdrücke aufgeführt, die mit Escapezeichen versehen sind.</span><span class="sxs-lookup"><span data-stu-id="76246-1586">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="76246-1587">Regulärer Ausdruck</span><span class="sxs-lookup"><span data-stu-id="76246-1587">Regular Expression</span></span>    | <span data-ttu-id="76246-1588">Mit Escapezeichen versehener regulärer Ausdruck</span><span class="sxs-lookup"><span data-stu-id="76246-1588">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="76246-1589">Beim Routing verwendete reguläre Ausdrücke beginnen oft mit einem Caretzeichen (`^`) und stellen die Startposition der Zeichenfolge dar.</span><span class="sxs-lookup"><span data-stu-id="76246-1589">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="76246-1590">Die Ausdrücke enden häufig mit einem Dollarzeichen (`$`) und stellen das Ende der Zeichenfolge dar.</span><span class="sxs-lookup"><span data-stu-id="76246-1590">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="76246-1591">Mit den Zeichen `^` und `$` wird sichergestellt, dass der reguläre Ausdruck mit dem vollständigen Routenparameterwert übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="76246-1591">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="76246-1592">Ohne die Zeichen `^` und `$` werden mit dem regulären Ausdruck alle Teilzeichenfolgen ermittelt, was häufig nicht gewünscht ist.</span><span class="sxs-lookup"><span data-stu-id="76246-1592">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="76246-1593">In der folgenden Tabelle finden Sie Beispiele für reguläre Ausdrücke. Außerdem wird erklärt, warum ein Abgleich erfolgreich ist oder fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="76246-1593">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="76246-1594">expression</span><span class="sxs-lookup"><span data-stu-id="76246-1594">Expression</span></span>   | <span data-ttu-id="76246-1595">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="76246-1595">String</span></span>    | <span data-ttu-id="76246-1596">Match</span><span class="sxs-lookup"><span data-stu-id="76246-1596">Match</span></span> | <span data-ttu-id="76246-1597">Kommentar</span><span class="sxs-lookup"><span data-stu-id="76246-1597">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="76246-1598">hello</span><span class="sxs-lookup"><span data-stu-id="76246-1598">hello</span></span>     | <span data-ttu-id="76246-1599">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-1599">Yes</span></span>   | <span data-ttu-id="76246-1600">Teilzeichenfolge stimmt überein</span><span class="sxs-lookup"><span data-stu-id="76246-1600">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="76246-1601">123abc456</span><span class="sxs-lookup"><span data-stu-id="76246-1601">123abc456</span></span> | <span data-ttu-id="76246-1602">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-1602">Yes</span></span>   | <span data-ttu-id="76246-1603">Teilzeichenfolge stimmt überein</span><span class="sxs-lookup"><span data-stu-id="76246-1603">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="76246-1604">mz</span><span class="sxs-lookup"><span data-stu-id="76246-1604">mz</span></span>        | <span data-ttu-id="76246-1605">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-1605">Yes</span></span>   | <span data-ttu-id="76246-1606">Ausdruck stimmt überein</span><span class="sxs-lookup"><span data-stu-id="76246-1606">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="76246-1607">MZ</span><span class="sxs-lookup"><span data-stu-id="76246-1607">MZ</span></span>        | <span data-ttu-id="76246-1608">Ja</span><span class="sxs-lookup"><span data-stu-id="76246-1608">Yes</span></span>   | <span data-ttu-id="76246-1609">keine Unterscheidung zwischen Groß-/Kleinbuchstaben</span><span class="sxs-lookup"><span data-stu-id="76246-1609">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="76246-1610">hello</span><span class="sxs-lookup"><span data-stu-id="76246-1610">hello</span></span>     | <span data-ttu-id="76246-1611">Nein</span><span class="sxs-lookup"><span data-stu-id="76246-1611">No</span></span>    | <span data-ttu-id="76246-1612">siehe Erläuterungen zu `^` und `$` oben</span><span class="sxs-lookup"><span data-stu-id="76246-1612">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="76246-1613">123abc456</span><span class="sxs-lookup"><span data-stu-id="76246-1613">123abc456</span></span> | <span data-ttu-id="76246-1614">Nein</span><span class="sxs-lookup"><span data-stu-id="76246-1614">No</span></span>    | <span data-ttu-id="76246-1615">siehe Erläuterungen zu `^` und `$` oben</span><span class="sxs-lookup"><span data-stu-id="76246-1615">See `^` and `$` above</span></span> |

<span data-ttu-id="76246-1616">Weitere Informationen zur Syntax von regulären Ausdrücken finden Sie unter [Sprachelemente für reguläre Ausdrücke – Kurzübersicht](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="76246-1616">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="76246-1617">Einen regulären Ausdruck können Sie verwenden, um einen Parameter auf zulässige Werte einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="76246-1617">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="76246-1618">Mit `{action:regex(^(list|get|create)$)}` werden beispielsweise für den `action`-Routenwert nur die Werte `list`, `get` oder `create` abgeglichen.</span><span class="sxs-lookup"><span data-stu-id="76246-1618">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="76246-1619">Wenn die Zeichenfolge `^(list|get|create)$` dem Einschränkungswörterbuch übergeben wird, führt dies zum gleichen Ergebnis.</span><span class="sxs-lookup"><span data-stu-id="76246-1619">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="76246-1620">Auch Einschränkungen, die dem zugehörigen Wörterbuch hinzugefügt werden und mit keiner vorgegebenen Einschränkung übereinstimmen , werden als reguläre Ausdrücke behandelt. Dies gilt allerdings nicht für Inline-Einschränkungen in einer Vorlage.</span><span class="sxs-lookup"><span data-stu-id="76246-1620">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="76246-1621">Benutzerdefinierte Routeneinschränkungen</span><span class="sxs-lookup"><span data-stu-id="76246-1621">Custom Route Constraints</span></span>

<span data-ttu-id="76246-1622">Zusätzlich zu den integrierten Routeneinschränkungen können benutzerdefinierte Routeneinschränkungen durch Implementierung der <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>-Schnittstelle erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1622">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="76246-1623">Die <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>-Schnittstelle enthält eine einzelne Methode, `Match`, die `true` zurückgibt, wenn die Einschränkung erfüllt wird, und andernfalls `false`.</span><span class="sxs-lookup"><span data-stu-id="76246-1623">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="76246-1624">Zum Verwenden einer benutzerdefinierten <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> muss der Routeneinschränkungstyp bei der <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> der App im Dienstcontainer der App registriert werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1624">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="76246-1625">Eine <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> ist ein Wörterbuch, das Routeneinschränkungsschlüssel <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>-Implementierungen zuordnet, die diese Einschränkungen überprüfen.</span><span class="sxs-lookup"><span data-stu-id="76246-1625">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="76246-1626">Die <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> einer App kann in `Startup.ConfigureServices` entweder als Teil eines [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*)-Aufrufs oder durch direktes Konfigurieren von <xref:Microsoft.AspNetCore.Routing.RouteOptions> mit `services.Configure<RouteOptions>` aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1626">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="76246-1627">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="76246-1627">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="76246-1628">Die Einschränkung kann dann auf die übliche Weise mit dem bei der Registrierung des Einschränkungstyps angegebenen Namen auf Routen angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1628">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="76246-1629">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="76246-1629">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="url-generation-reference"></a><span data-ttu-id="76246-1630">Referenz für URL-Generierung</span><span class="sxs-lookup"><span data-stu-id="76246-1630">URL generation reference</span></span>

<span data-ttu-id="76246-1631">Im folgenden Beispiel wird gezeigt, wie Sie einen Link zu einer Route unter Berücksichtigung eines vorhandenen Wörterbuchs mit Routenwerten und einer <xref:Microsoft.AspNetCore.Routing.RouteCollection> erstellen.</span><span class="sxs-lookup"><span data-stu-id="76246-1631">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="76246-1632">Die <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath>-Eigenschaft, die am Ende des obigen Beispiels erstellt wird, hat den Wert `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="76246-1632">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="76246-1633">Das Wörterbuch stellt die Routenwerte von `operation` und `id` aus der Vorlage „Track Package Route“ (`package/{operation}/{id}`) bereit.</span><span class="sxs-lookup"><span data-stu-id="76246-1633">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="76246-1634">Weitere Informationen finden Sie im Beispielcode im Abschnitt [Verwenden von Routingmiddleware](#use-routing-middleware) oder in der [Beispiel-App](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="76246-1634">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="76246-1635">Der zweite Parameter für den <xref:Microsoft.AspNetCore.Routing.VirtualPathContext>-Konstruktor ist eine Auflistung von *Umgebungswerten*.</span><span class="sxs-lookup"><span data-stu-id="76246-1635">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="76246-1636">Mit diesen lässt sich leicht die Anzahl der Werte einschränken, die ein Entwickler innerhalb eines Anforderungskontexts angeben muss.</span><span class="sxs-lookup"><span data-stu-id="76246-1636">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="76246-1637">Die aktuellen Routenwerte der aktuellen Anforderung werden bei der Linkgenerierung als Umgebungswerte behandelt.</span><span class="sxs-lookup"><span data-stu-id="76246-1637">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="76246-1638">In einer ASP.NET Core-MVC-App müssen Sie innerhalb der `About`-Aktion von `HomeController` nicht den Controllerroutenwert angeben, um eine Verknüpfung mit der `Index`-Aktion herzustellen, da der Umgebungswert von `Home` verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="76246-1638">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="76246-1639">Umgebungswerte, die mit keinem Parameter übereinstimmen, werden ignoriert.</span><span class="sxs-lookup"><span data-stu-id="76246-1639">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="76246-1640">Außerdem werden Umgebungswerte ignoriert, wenn ein explizit angegebener Wert den betreffenden Umgebungswert außer Kraft setzt.</span><span class="sxs-lookup"><span data-stu-id="76246-1640">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="76246-1641">Der Abgleich in der URL wird von links nach rechts ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="76246-1641">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="76246-1642">Explizit bereitgestellte Werte, für die keine Übereinstimmungen mit einem Routensegment ermittelt werden, werden der Abfragezeichenfolge hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="76246-1642">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="76246-1643">In der folgenden Tabelle werden die Ergebnisse dargestellt, die aus der Verwendung der Routenvorlage `{controller}/{action}/{id?}` hervorgehen:</span><span class="sxs-lookup"><span data-stu-id="76246-1643">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="76246-1644">Umgebungswerte</span><span class="sxs-lookup"><span data-stu-id="76246-1644">Ambient Values</span></span>                     | <span data-ttu-id="76246-1645">Explizite Werte</span><span class="sxs-lookup"><span data-stu-id="76246-1645">Explicit Values</span></span>                        | <span data-ttu-id="76246-1646">Ergebnis</span><span class="sxs-lookup"><span data-stu-id="76246-1646">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="76246-1647">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="76246-1647">controller = "Home"</span></span>                | <span data-ttu-id="76246-1648">action = "About"</span><span class="sxs-lookup"><span data-stu-id="76246-1648">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="76246-1649">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="76246-1649">controller = "Home"</span></span>                | <span data-ttu-id="76246-1650">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="76246-1650">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="76246-1651">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="76246-1651">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="76246-1652">action = "About"</span><span class="sxs-lookup"><span data-stu-id="76246-1652">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="76246-1653">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="76246-1653">controller = "Home"</span></span>                | <span data-ttu-id="76246-1654">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="76246-1654">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="76246-1655">Wenn eine Route über einen Standardwert verfügt, der keinem Parameter entspricht, und dieser Wert explizit bereitgestellt wird, muss er dem Standardwert entsprechen:</span><span class="sxs-lookup"><span data-stu-id="76246-1655">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="76246-1656">Für diese Route wird nur dann ein Link generiert, wenn die übereinstimmenden Werte für `controller` und `action` bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="76246-1656">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="76246-1657">Komplexe Segmente</span><span class="sxs-lookup"><span data-stu-id="76246-1657">Complex segments</span></span>

<span data-ttu-id="76246-1658">Komplexe Segmente (z.B. `[Route("/x{token}y")]`) werden von rechts nach links auf eine nicht gierige Weise durch entsprechende Literale verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="76246-1658">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="76246-1659">Unter [diesem Code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) finden Sie eine ausführliche Erklärung für das Abgleichen komplexer Segmente.</span><span class="sxs-lookup"><span data-stu-id="76246-1659">See [this code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="76246-1660">Das [Codebeispiel](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) wird von ASP.NET Core nicht verwendet, aber es bietet eine gute Erklärung komplexer Segmente.</span><span class="sxs-lookup"><span data-stu-id="76246-1660">The [code sample](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>


::: moniker-end
